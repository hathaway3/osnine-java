         nam   Dynacalc
         ttl   Dynacalc version 4.8:5

         ifp1
         use   defsfile
         endc
tylg     set   Prgrm+Objct
atrv     set   ReEnt+rev
rev      set   $00
         mod   eom,name,tylg,atrv,start,size
u0000    rmb   1
u0001    rmb   1
u0002    rmb   1
u0003    rmb   1
u0004    rmb   1
u0005    rmb   1
u0006    rmb   1
u0007    rmb   1
u0008    rmb   1
u0009    rmb   1
u000A    rmb   1
u000B    rmb   1
u000C    rmb   1
u000D    rmb   1
u000E    rmb   1
u000F    rmb   1
u0010    rmb   1
u0011    rmb   1
u0012    rmb   1
u0013    rmb   1
u0014    rmb   1
u0015    rmb   1
u0016    rmb   1
u0017    rmb   1
u0018    rmb   1
u0019    rmb   1
MEMPTR   rmb   2
u001C    rmb   1
u001D    rmb   1
u001E    rmb   2
u0020    rmb   1
u0021    rmb   1
u0022    rmb   1
u0023    rmb   1
u0024    rmb   1
u0025    rmb   1
u0026    rmb   1
u0027    rmb   1
u0028    rmb   1
u0029    rmb   1
u002A    rmb   1
u002B    rmb   1
u002C    rmb   1
u002D    rmb   2
u002F    rmb   1
u0030    rmb   1
u0031    rmb   2
u0033    rmb   1
u0034    rmb   1
u0035    rmb   1
u0036    rmb   1
u0037    rmb   2
u0039    rmb   1
u003A    rmb   1
u003B    rmb   1
u003C    rmb   1
u003D    rmb   1
u003E    rmb   1
u003F    rmb   1
u0040    rmb   1
PARAMS   rmb   2
u0043    rmb   1
u0044    rmb   1
u0045    rmb   1
u0046    rmb   1
u0047    rmb   2
u0049    rmb   1
u004A    rmb   1
u004B    rmb   1
u004C    rmb   1
u004D    rmb   1
u004E    rmb   1
u004F    rmb   1
u0050    rmb   1
u0051    rmb   1
u0052    rmb   1
u0053    rmb   1
u0054    rmb   1
u0055    rmb   1
u0056    rmb   1
u0057    rmb   2
u0059    rmb   1
u005A    rmb   1
u005B    rmb   1
u005C    rmb   1
u005D    rmb   1
u005E    rmb   1
u005F    rmb   1
u0060    rmb   1
u0061    rmb   1
u0062    rmb   1
u0063    rmb   1
u0064    rmb   1
u0065    rmb   1
u0066    rmb   1
u0067    rmb   1
u0068    rmb   1
u0069    rmb   1
u006A    rmb   1
u006B    rmb   1
u006C    rmb   1
u006D    rmb   1
u006E    rmb   2
u0070    rmb   1
u0071    rmb   1
u0072    rmb   1
u0073    rmb   1
u0074    rmb   1
u0075    rmb   1
u0076    rmb   1
u0077    rmb   1
u0078    rmb   1
u0079    rmb   1
u007A    rmb   2
u007C    rmb   1
u007D    rmb   1
u007E    rmb   2
u0080    rmb   1
u0081    rmb   1
u0082    rmb   1
u0083    rmb   1
u0084    rmb   1
u0085    rmb   1
u0086    rmb   1
u0087    rmb   1
u0088    rmb   1
u0089    rmb   1
u008A    rmb   1
u008B    rmb   1
u008C    rmb   1
u008D    rmb   1
u008E    rmb   1
u008F    rmb   1
u0090    rmb   1
u0091    rmb   1
u0092    rmb   1
u0093    rmb   1
u0094    rmb   1
u0095    rmb   1
u0096    rmb   1
u0097    rmb   1
u0098    rmb   1
u0099    rmb   1
u009A    rmb   1
u009B    rmb   2
u009D    rmb   1
u009E    rmb   3
u00A1    rmb   1
u00A2    rmb   1
u00A3    rmb   1
u00A4    rmb   1
u00A5    rmb   2
u00A7    rmb   1
u00A8    rmb   3
u00AB    rmb   1
u00AC    rmb   1
u00AD    rmb   1
u00AE    rmb   1
u00AF    rmb   1
u00B0    rmb   1
u00B1    rmb   1
u00B2    rmb   1
u00B3    rmb   1
u00B4    rmb   1
u00B5    rmb   1
u00B6    rmb   1
u00B7    rmb   1
u00B8    rmb   2
u00BA    rmb   1
u00BB    rmb   1
u00BC    rmb   1
u00BD    rmb   1
u00BE    rmb   1
u00BF    rmb   1
u00C0    rmb   1
u00C1    rmb   1
u00C2    rmb   1
u00C3    rmb   1
u00C4    rmb   1
u00C5    rmb   2
u00C7    rmb   1
u00C8    rmb   1
u00C9    rmb   1
u00CA    rmb   1
u00CB    rmb   1
u00CC    rmb   1
u00CD    rmb   1
u00CE    rmb   2
u00D0    rmb   1
u00D1    rmb   1
u00D2    rmb   1
u00D3    rmb   2
u00D5    rmb   1
u00D6    rmb   1
u00D7    rmb   2
u00D9    rmb   1
u00DA    rmb   1
u00DB    rmb   1
u00DC    rmb   2
u00DE    rmb   1
u00DF    rmb   1
u00E0    rmb   1
u00E1    rmb   1
u00E2    rmb   1
u00E3    rmb   1
u00E4    rmb   1
u00E5    rmb   3
u00E8    rmb   1
u00E9    rmb   2
u00EB    rmb   1
u00EC    rmb   1
u00ED    rmb   1
u00EE    rmb   1
u00EF    rmb   1
u00F0    rmb   1
u00F1    rmb   1
u00F2    rmb   1
u00F3    rmb   1
u00F4    rmb   1
u00F5    rmb   1
u00F6    rmb   1
u00F7    rmb   1
u00F8    rmb   1
u00F9    rmb   1
u00FA    rmb   1
u00FB    rmb   1
u00FC    rmb   1
u00FD    rmb   1
u00FE    rmb   1
u00FF    rmb   20
u0113    rmb   75
u015E    rmb   34
u0180    rmb   63
u01BF    rmb   211
u0292    rmb   14
u02A0    rmb   88
u02F8    rmb   7
u02FF    rmb   33
u0320    rmb   122
u039A    rmb   1
u039B    rmb   25
u03B4    rmb   7
u03BB    rmb   69
u0400    rmb   1
u0401    rmb   126
u047F    rmb   10
u0489    rmb   135
u0510    rmb   16
u0520    rmb   16
u0530    rmb   32
u0550    rmb   18
u0562    rmb   21  * New in 4.8.5
u0577    rmb   4   * New in 4.8.5
u057B    rmb   325
u06C0    rmb   64
u0700    rmb   811
u0A2B    rmb   10965
size     equ   .
name     equ   *
         fcs   /Dynacalc/

DPOFFSET equ   $100

PGBEGIN  lbra  L1C8E
         lbra  L1C8E
L001B    lbra  L04DC
L001E    lbra  L0657
L0021    lbra  L0619
L0024    lbra  L007F
L0027    lbra  L05EC
L002A    lbra  L0304
         lbra  L0981
L0030    lbra  L003C
L0033    lbra  L0372
L0036    lbra  L098F
L0039    lbra  L0991

L003C    lda   #$14
         sta   <u0061
         lbsr  L0AD2
         lbsr  L0AB4
         dec   <u006A
         ldd   <u006A
         rts

L004B    ldb   #$0A
         cmpb  ,x
         bne   L006E
         lda   $01,x
         anda  #$F7
         sta   $01,x
         rts

L0058    ldb   #$80
         lbsr  L03DC
         lda   <u00C9
         lbeq  L05B8
         cmpa  #$82
         lbcc  L03D3
         adda  #$99
         lbra  L056A

L006E    stx   <u00AF
         lbsr  L0339
         subb  #$89
         stb   <u00B4
         leay  >u0489,u
         lda   >u0401,u
L007F    lbsr  L50CD
         ldb   #$80
         sta   b,y
         ldu   <MEMPTR
         leau  >u02F8,u
         sts   <u00CE
         lbsr  L2CEB
         leau  u0008,u
         lbsr  L2CEB
         ldu   <MEMPTR
L0099    lbsr  L0662
         clr   <u0076
         clr   <u00D9
         clr   <u00FD
         clr   <u00CB
         clr   <u00C9
         lda   <u00D0
         beq   L0058
         cmpa  #$08
         beq   L00F4
         sta   <u0076
         sta   <u00FE
         cmpa  #$16
         bcc   L00D9
L00B6    suba  #$10
L00B8    lsla
         pshs  a
         leax  >L0A76,pcr
         ldd   a,x
         leax  d,x
         puls  a
         stx   <u00D3
         cmpa  #$0E
         bcc   L00F6
         cmpa  #$06
         bcs   L00D4
         lbsr  L0528
         sta   <u00F1
L00D4    lbsr  L0523
         bra   L00F6
L00D9    cmpa  #$27
         beq   L00F4
         suba  #$22
         bcs   L00F4
         com   <u00FE
         clr   <u00FB
         cmpa  #$07
         bls   L00F6
         cmpa  #$0B
         bcc   L00F2
         deca
         sta   <u00FE
         bra   L00B8
L00F2    bra   L00F4
L00F4    clr   <u00FE
L00F6    ldb   <u00D1
         lbsr  L03DC
         sta   <u0036
         lda   <u0076
         beq   L011D
         cmpa  #$15
         bls   L013E
         cmpa  #$1B
         bhi   L012D
         lbeq  L077A
         tst   <u00FE
         bne   L013E
         cmpa  #$18
         bls   L0118
         lbsr  L07E1
L0118    suba  #$12
         lbsr  L0540
L011D    lda   <u0076
         cmpa  #$29
         bcc   L0127
         tst   <u00C9
         bne   L0161
L0127    lbsr  L069F
         lbra  L0099
L012D    suba  #$1C
         lsla
         pshs  b,a
         leax  >L0A4E,pcr
         ldd   a,x
         leax  d,x
         puls  b,a
         jmp   ,x
L013E    stb   <u00FF
         ldx   <u00D3
         jsr   ,x
         ldb   <u00FF
L0146    cmpb  <u00D2
         beq   L014F
         lbsr  L03DC
         bra   L013E
L014F    lda   <u0076
         cmpa  #$2A
         bcs   L0164
         ldb   <u00CB
         cmpa  #$2C
         bne   L015D
         eorb  #$01
L015D    stb   <u00C9
L015F    bne   L011D
L0161    lbra  L043C
L0164    suba  #$12
         bls   L011D
         ldb   <u00F1
         leax  b,u
         deca
         beq   L0191
         deca
         bne   L0198
         stb   <u00EF
L0174    lbsr  L2CDF  Copy floating point value from X to buffer in U
         lda   <u00FD
         leax  a,u
         lbsr  L2CB5
         beq   L0184
         lda   #$03
         bsr   L01E6
L0184    lbsr  L0214
         lda   <u00F1
         lbsr  L038F
         tst   <u00EF
         bne   L015F
         rts
L0191    lbsr  L2CB5
         bsr   L0214
         bra   L011D
L0198    deca
         lbeq  L0598
         clr   <u00EF
         bsr   L0174
         stx   <u00F2
         bsr   L01FE
         ldx   <u00F2
         lbsr  L07AB
         leax  u0008,u
         lbsr  L2CDF  Copy floating point value from X to buffer in U
         ldx   <u00F8
         lda   #$01
         lbsr  L07BB
         lbsr  L2CFD
         ldx   <u00F2
         tst   <u00B3
         bne   L01CA
         lbsr  L2CB5
         lbsr  L0281
         lbsr  L07A7
         leax  u0008,u
L01CA    lbsr  L2CDF  Copy floating point value from X to buffer in U
         lbsr  L2D00
         lda   #$03
         bsr   L01E6
         lda   #$04
         bsr   L01E6
         ldb   <u00DC
         stb   <u00D1
         lda   <u00DE
         lbsr  L038F
         bsr   L0214
         lbra  L011D
L01E6    lbra  L0540
L01E9    lda   <u00FD
         leax  a,u
         lbra  L2CDF  Copy floating point value from X to buffer in U
         tst   <u00D9
         beq   L0210
         lda   <u00FD
         leax  a,u
         lbsr  L0308
         bhi   L0210
L01FD    rts
L01FE    leax  u0008,u
         lbra  L07AB
         tst   <u00D9
         beq   L0210
         lda   <u00FD
         leax  a,u
         lbsr  L0308
         bcc   L01FD
L0210    lda   #$FF
         sta   <u00D9
L0214    lda   <u00FD
         leax  a,u
         lbra  L2CBB
L021B    bsr   L01E9
         clra
         bsr   L01E6
         bra   L0214
L0222    bsr   L021B
L0224    bsr   L0281
         lbsr  L2CDF  Copy floating point value from X to buffer in U
         ldb   <u00F1
         leax  b,u
         pshs  x
         clra
         lbsr  L07BB
         puls  x
         lbra  L2CBB
         lbsr  L2CFD
         bsr   L0222
         lbsr  L2D00
         bsr   L01FE
         ldx   <u00F8
         lbsr  L07A4
         ldx   <u00F8
         lbra  L2CBB
         lda   <u0036
         cmpa  #$0B
         bne   L0298
         com   <u00FE
         lda   <u00D1
         sta   <u00DC
         stb   <u00D1
         lda   u0008,u
         bmi   L025F
         clra
L025F    sta   <u00B3
         lbsr  L0528
         sta   <u00DE
         stx   <u00F8
         lda   #$16
         sta   <u0076
         lbsr  L00B6
L026F    leax  >L2CBE,pcr
         bra   L0285
L0275    leax  >L2CFA,pcr
         bra   L0285
L027B    leax  >L2CF1,pcr
         bra   L0285
L0281    leax  >L2CF4,pcr
L0285    pshs  b,a
         ldd   ,x
         leax  d,x
         puls  pc,b,a
L028D    lda   #$09
         lbra  L056A
         pshs  b
         lda   <u0036
         cmpa  #$0B
L0298    lbne  L0568
         tst   u0008,u
         bmi   L028D
         tst   u000F,u
         beq   L028D
         lda   #$09
         sta   <u0036
         bsr   L0281
         lda   #$06
         bsr   L030A
         beq   L02CE
         bhi   L02BE
L02B2    leax  $08,x
         bsr   L030C
         bcc   L02CC
         dec   <u0036
         bne   L02B2
         bra   L02CE
L02BE    bsr   L0275
L02C0    leax  $08,x
         bsr   L030C
         bls   L02CC
         dec   <u0036
         bne   L02C0
         bra   L02CE
L02CC    bne   L028D
L02CE    lbsr  L2CB5
         lbsr  L06B8
         stx   <u00F8
         puls  b
         clr   <u00FE
         lbsr  L03DC
         lda   u0008,u
         pshs  a
         anda  #$7F
         sta   u0008,u
         ldx   <u00F8
         lbsr  L07AF
         bsr   L0275
         lbsr  L07A4
         lbsr  L0717
         ldx   <u00F8
         lbsr  L2CDF  Copy floating point value from X to buffer in U
         puls  a
         anda  #$80
         ora   u0008,u
         sta   u0008,u
         lda   #$02
         lbra  L0795
L0304    pshs  u
         bra   L0312
L0308    lda   #$06
L030A    sta   <u0025
L030C    pshs  u
         ldu   <MEMPTR
         leau  u0008,u
L0312    lda   ,u
         anda  #$80
         pshs  a
         lda   ,x
         anda  #$80
         cmpa  ,s+
         bne   L0337
         tsta
         bpl   L0325
         exg   x,u
L0325    lda   u0007,u
         cmpa  $07,x
         bne   L0337
         clrb
L032C    lda   b,u
         cmpa  b,x
         bne   L0337
         incb
         cmpb  <u0025
         bne   L032C
L0337    puls  pc,u
L0339    ldu   <MEMPTR
         ldb   ,x
         pshs  u,x,b
         leau  >u0400,u
         clr   <u007D
         lsrb
         rol   <u007D
         clra
         std   <u006C
         lbsr  L1CB8
         puls  pc,u,x,b
L0350    leax  b,y
         addb  #$08
         cmpa  #$C0
         bcs   L0367
         subb  #$08
         lda   b,y
         incb
         ldb   b,y
         tsta
         bpl   L0365
         sta   <u00C9
         rts
L0365    bsr   L038F
L0367    pshs  b
         lbsr  L2CDF  Copy floating point value from X to buffer in U
         lda   <u00C9
         puls  pc,b
L0370    clr   <u0033
L0372    clr   <u00C9
         lbsr  L1CBB
         beq   L038C
         lda   $01,x
L037B    leax  $02,x
         bita  #$10
         bne   L038C
         bita  #$08
         beq   L03A4
         tst   <u0033
         lbeq  L058A
         coma
L038C    lbra  L026F
L038F    pshs  a
         suba  #$20
         lsra
         lsra
         lsra
         ldx   <MEMPTR
         leax  >$02FF,x
         clr   a,x
         puls  a
         ldx   <MEMPTR
         leax  a,x
L03A4    rts
L03A5    leau  u0008,u
L03A7    lda   b,y
         clr   <u00C9
         incb
         tsta
         bmi   L0350
         pshs  u,b
         bita  #$40
         beq   L03BF
         ldu   b,y
         bsr   L0370
         puls  u,b
         addb  #$02
         bra   L0367
L03BF    lda   b,y
         ldb   <u0076
         cmpb  #$29
         beq   L03CB
         cmpa  #$33
         bcc   L03D3
L03CB    adda  #$4F
         sta   <u00C9
         inc   ,s
         puls  pc,u,b
L03D3    lbeq  L0598
         lda   #$33
         lbra  L056A
L03DC    clr   <u0089
L03DE    stb   <u00F6
         bsr   L03A5
         leau  -u0008,u
         bra   L03EC
L03E6    lbsr  L0533
         nop
         nop
         nop
L03EC    clra
         cmpb  <u00D2
         bge   L03A4
         lda   b,y
         anda  #$3F
         cmpa  #$04
         bcs   L03E6
         bne   L0422
         tst   u000F,u
         bne   L0404
         lbsr  L0687
         bra   L03EC
L0404    lda   #$06
         lbsr  L0540
         lda   #$02
         lbsr  L0533
         lda   #$05
         lbsr  L0540
         bra   L03EC
L0415    tfr   b,a
         suba  <u00F6
         cmpa  #$03
         bne   L0420
         lda   <u00F6
         rts
L0420    clra
         rts
L0422    cmpa  #$07
         lbhi  L04C3
         tst   <u00C9
         bne   L043C
         tst   <u0089
         lbne  L0568
         sta   <u0089
         lda   <u0076
         beq   L0441
         cmpa  #$29
         bcc   L0441
L043C    lda   #$0A
         lbra  L056A
L0441    bsr   L0415
         sta   <u00F7
         lda   <u0089
         cmpa  b,y
         bne   L0450
         incb
         lda   b,y
         anda  #$3F
L0450    suba  #$05
         pshs  b,a
         lda   <u0089
         suba  #$05
         ldb   #$03
         mul
         addb  ,s+
         leax  >L0A8A,pcr
         lda   b,x
         sta   >u057B,u
         lbsr  L06B8
         puls  b
         pshs  a
         lbsr  L03DE
         lda   <u00C9
         bne   L043C
         puls  a
         pshs  b
         lbsr  L038F
         clr   ,-s
         bsr   L0415
         beq   L04AC
         lda   <u00F7
         beq   L04AC
         pshs  u,y,x
         inca
         ldu   a,y
         pshs  u
         lbsr  L41F0
         beq   L04AA
         lda   <u00F6
         inca
         ldu   a,y
         lbsr  L41F0
         beq   L04AA
         sta   <u00FC
         lbsr  L50D9
         puls  u
         lbsr  L41ED
         puls  u,y,x
         bra   L04AF
L04AA    puls  u,y,x,b,a
L04AC    lbsr  L0308
L04AF    jsr   >u057B,u
         stu   <u00FA
         lda   #$81
         adda  ,s+
         sta   <u00C9
         lbsr  L069F
         puls  b
         lbra  L03EC
L04C3    tst   <u00FE
         lbeq  L0568
         cmpa  #$0A
         bne   L04F2
         tst   <u00FE
         lbmi  L0568
         pshs  u,b
         incb
         ldx   b,y
         subb  #$03
         ldd   b,y
L04DC    stx   <u006C
         stx   <u00F2
         cmpa  <u00F2
         bls   L04E8
         sta   <u00F2
         lda   <u006C
L04E8    cmpb  <u00F3
         bls   L04F0
         stb   <u00F3
         ldb   <u006D
L04F0    tst   <u00E0
L04F2    bne   L0527
         stb   <u00FC
L04F6    std   <u00F4
         ldu   <u00F4
         lbsr  L0370
         bne   L0508
         ldu   <MEMPTR
         lbsr  L2CB5
         ldx   <u00D3
         jsr   ,x
L0508    ldd   <u00F4
         incb
         beq   L0511
         cmpb  <u00F3
         bls   L04F6
L0511    ldb   <u00FC
         inca
         beq   L051A
         cmpa  <u00F2
         bls   L04F6
L051A    puls  u,b
         addb  #$03
         leas  $02,s
         lbra  L0146
L0523    bsr   L0528
         sta   <u00FD
L0527    rts
L0528    clr   <u00C9
         lbsr  L026F
         lbsr  L2CB5
         lbra  L06B8
L0533    tst   <u00C9
L0535    lbne  L043C
         sta   <u0036
         lbsr  L03A7
         lda   <u0036
L0540    tst   <u00C9
         bne   L0535
         pshs  u,x,b
         anda  #$0F
         lsla
         clr   <u0033
         leax  >L2CC1,pcr
         ldd   a,x
         pshs  y
         ldy   <MEMPTR
         leay  >$0550,y
         jsr   d,x
         puls  y
         lda   <u0033
         beq   L0588
         bra   L056A
L0564    lda   #$03
         bra   L056A
L0568    lda   #$02
L056A    sta   <u0033
         ldb   <u00C3
         bne   L0586
         bsr   L05B2
         ldb   $01,x
         bitb  #$08
         beq   L057C
         cmpa  $02,x
         beq   L0586
L057C    sta   $02,x
         lda   $01,x
         anda  #$DF
         ora   #$08
         sta   $01,x
L0586    bra   L05E7
L0588    puls  pc,u,x,b
L058A    ldb   <u0076
         lda   ,x
         lbmi  L038C
         bne   L059B
         cmpb  #$2E
         beq   L05AF
L0598    clra
         bra   L056A
L059B    cmpa  #$19
         bcs   L05A9
         cmpa  #$1A
         bhi   L05A9
         adda  #$67
         sta   <u00C9
         clrb
         rts
L05A9    lda   #$08
         cmpb  #$2F
         bne   L056A
L05AF    inc   <u00C9
         rts
L05B2    lbsr  L50D0
         ldx   <u00AF
         rts
L05B8    tst   <u00C3
         bne   L05E5
         bsr   L05B2
         ldb   #$04
         ldu   <MEMPTR
         leau  u0008,u
         lda   #$FF
         leay  $02,x
L05C8    ldx   ,u++
         cmpx  ,y++
         beq   L05D2
         lda   #$DF
         stx   -$02,y
L05D2    decb
         bne   L05C8
         bsr   L05B2
         ldb   $01,x
         bitb  #$08
         beq   L05DF
         lda   #$DF
L05DF    anda  $01,x
         anda  #$F7
         sta   $01,x
L05E5    clr   <u00C3
L05E7    lds   <u00CE
         bra   L05B2
L05EC    lbsr  L1CA3
         leau  >L09C7,pcr
         lbsr  L1CA9
         ldu   <u001E
         tst   <u00B5
         bne   L0626
         ldb   <u00BF
         incb
         stb   <u0086
L0601    ldb   <u00C0
         incb
         stb   <u0087
L0606    ldx   ,--u
         beq   L060C
         bsr   L0616
L060C    dec   <u0087
         bne   L0606
         dec   <u0086
         bne   L0601
         bra   L0654
L0616    lbsr  L50B8
L0619    pshs  u
         lda   $01,x
         bita  #$10
         bne   L0624
         lbsr  L004B
L0624    puls  pc,u
L0626    ldb   <u00C0
         clra
         addd  #$0001
         stb   <u0087
         lslb
         rola
         comb
         coma
         addd  #$0001
         std   <u00BA
L0637    leau  -u0002,u
         stu   <u00B1
         lda   <u00BF
         inca
         sta   <u0086
L0640    ldx   ,u
         beq   L0646
         bsr   L0616
L0646    ldd   <u00BA
         leau  d,u
         dec   <u0086
         bne   L0640
         ldu   <u00B1
         dec   <u0087
         bne   L0637
L0654    lbra  L50D3
L0657    bsr   L05EC
         lbsr  L0AE1
         lbsr  L1CC1
         lbra  L1C8E
L0662    ldb   #$80
         clr   <u00D0
L0666    bsr   L0687
         cmpb  <u00B4
         bge   L0674
         lda   b,y
         anda  #$3F
         cmpa  #$09
         bne   L0677
L0674    stb   <u00D2
         rts
L0677    cmpa  #$08
         beq   L0683
         cmpa  #$10
         bcs   L0666
         cmpa  #$31
         bcc   L0666
L0683    std   <u00D0
         bra   L0666
L0687    lda   b,y
         incb
         cmpa  #$3F
         bls   L069E
         addb  #$02
         cmpa  #$7F
         bls   L069E
         addb  #$06
         cmpa  #$BF
         bls   L069E
         subb  #$07
         ldb   b,y
L069E    rts
L069F    ldb   <u00D1
         decb
         lda   b,y
         ora   #$C0
         sta   b,y
         lda   <u00FD
         bne   L06AE
         bsr   L06B8
L06AE    incb
         sta   b,y
         incb
         lda   <u00D2
         inca
         sta   b,y
L06B7    rts
L06B8    leax  >u02FF,u
         lda   <u00C9
         bne   L06B7
L06C0    inca
         cmpa  #$0B
         lbeq  L056A
         tst   a,x
         bne   L06C0
         sta   a,x
         lsla
         lsla
         lsla
         adda  #$20
         leax  a,u
         lbra  L2CBB

         lbsr  L2CFD
         lbsr  L0281
         lbsr  L2CB5
         leax  >u0577,u
         ldb   #$08
L06E6    lda   $03,x
         lsla
         lsla
         lsla
         eora  $03,x
         lsla
         lsla
         rol   ,x
         rol   $01,x
         rol   $02,x
         rol   $03,x
         decb
         bne   L06E6
         ldd   ,x
         lsra
         rorb
         ror   u000A,u
         std   u0008,u
         lbsr  L0281
         lbsr  L07A7
         leax  <u0018,u
         lda   $07,x
         beq   L0714
         lbsr  L07AB
         bsr   L0717
L0714    lbra  L011D
L0717    lda   u000F,u
         suba  #$80
         lbls  L2CEB
         suba  #$38
         bcc   L0740
         ldb   #$0E
L0725    adda  #$08
         bgt   L072E
         clr   b,u
         decb
         bra   L0725
L072E    suba  #$08
         beq   L0740
         sta   <u0036
L0734    lsr   b,u
         inca
         bne   L0734
         lda   <u0036
L073B    lsl   b,u
         inca
         bne   L073B
L0740    rts

L0741    fcb   $65,$2E,$E0

         addd  <u001E
         clr   <u00C4
         lda   #$03
         adcb  <u0017
         stu   >$6A97
         cmpb  >$3048
         bsr   L07A1
         bsr   L079A
         lda   #$02
         bsr   L07B8
         lbsr  L0281
         bsr   L07A4
         lda   #$04
         bsr   L07B8
         leax  u0008,u
         bsr   L07A1
         lda   <u00F1
         lbsr  L038F
         tst   u0007,u
         bne   L0776
         tst   <u00D9
         bne   L0789
         bra   L0784
L0776    lda   #$03
         bsr   L07BB
L077A    lda   #$09
         bsr   L07B8
         tst   <u00D9
         beq   L0789
         bsr   L079A
L0784    lbsr  L027B
         bsr   L07A4
L0789    tst   <u005D
         bne   L0797
         leax  >L0741,pcr
         bsr   L07A1
         lda   #$02
L0795    bsr   L07B8
L0797    lbra  L011D
L079A    lda   u0008,u
         eora  #$80
         sta   u0008,u
         rts
L07A1    lbra  L2CDF  Copy floating point value from X to buffer in U
L07A4    clra
         bra   L07B1
L07A7    lda   #$01
         bra   L07B1
L07AB    lda   #$02
         bra   L07B1
L07AF    lda   #$03
L07B1    pshs  b,a
         lbsr  L2CDF  Copy floating point value from X to buffer in U
         puls  b,a
L07B8    lbra  L0540
L07BB    lbsr  L2CB5
         bra   L07B8
         bsr   L07E1
         lbsr  L06B8
         lda   #$08
         bsr   L07B8
         bsr   L07A1
         lbsr  L2CBB
         stx   <u006C
         leax  ,u
         lbsr  L2CB5
         ldx   <u006C
         lda   #$07
         bsr   L07B8
         bsr   L07A1
         lda   #$03
         bra   L0795
L07E1    pshs  a
         tst   <u005D
         bne   L07ED
         leax  >L0741,pcr
         bsr   L07AF
L07ED    puls  pc,a
         lda   #$06
         bsr   L07B8
         leax  >L07FD,pcr
         bsr   L07A1
         lda   #$03
         bra   L0795

* ln(10) = 2.302585, also ln(x) / log(x)
L07FD    fcb   $13,$5D,$8D,$DD,$AA,$A8,$AE,$82  Value=2.302585

         lda   $08,u
         anda  #$7F
         sta   u0008,u
         bra   L0797
         inc   <u00D9
         bra   L082A
         lbsr  L0281
         pshs  b
         bsr   L07A1
         clra
         bsr   L07B8
         lbsr  L06B8
         stx   <u00FA
         lbsr  L06B8
         stx   <u00F8
         lbsr  L0523
         puls  b
L082A    lda   <u0036
         cmpa  #$0B
         bne   L0852
         lda   b,y
         sta   <u00FC
         anda  #$C0
         cmpa  #$40
         bne   L0852
         incb
         ldu   b,y
         addb  #$02
         lda   b,y
         cmpa  #$4A
         bne   L0852
         incb
         ldx   b,y
         addb  #$02
         stb   <u00B3
         tst   <u00FB
         beq   L0856
         cmpb  <u00D2
L0852    lbne  L0568
L0856    stx   <u00F6
         cmpu  <u00F6
         bcs   L0869
         bne   L0865
         tst   <u00FB
         lbeq  L0564
L0865    stu   <u00F6
         exg   u,x
L0869    tfr   u,d
         ldx   #$0001
         cmpa  <u00F6
         beq   L087B
         cmpb  <u00F7
         lbne  L0564
         ldx   #$0100
L087B    stx   <u00F2
L087D    lbsr  L0370
         tst   <u00D9
         beq   L088D
         lda   #$06
         lbsr  L0308
         bne   L089C
         bra   L08B5
L088D    tst   <u00FB
         lbne  L0946
         lbsr  L0308
         bcs   L08AD
         beq   L08B5
L089A    clr   <u00FC
L089C    stu   <u00F4
         ldd   <u00F2
         leau  d,u
         cmpu  <u00F6
         bls   L087D
         ldu   <MEMPTR
         tst   <u00FB
         bne   L0914
L08AD    tst   <u00FC
         lbne  L0598
         ldu   <u00F4
L08B5    ldd   <u00F2
         exg   a,b
         stu   <u00C1
         leau  d,u
         ldb   <u00B3
         cmpb  <u00D2
         beq   L08E0
         lda   b,y
         cmpa  #$4B
L08C7    bne   L0852
         incb
         ldx   b,y
         addb  #$02
         cmpb  <u00D2
         bne   L08C7
         tfr   x,d
         tst   <u00F2
         bne   L08DC
         ldb   <u00C2
         bra   L08DE
L08DC    lda   <u00C1
L08DE    tfr   d,u
L08E0    lbsr  L1CBB
         beq   L091A
         lda   $01,x
         bita  #$10
         bne   L08F5
         bita  #$08
         beq   L091F
         tst   $02,x
         bpl   L091F
         bsr   L093A
L08F5    tst   <u00C3
         bne   L0917
         lbsr  L05B2
         stu   $03,x
         ldu   <MEMPTR
         lda   #$FF
         lbra  L057C
L0905    lbsr  L0214
         lbsr  L0224
         ldx   <u00F8
         lbsr  L0308
         bls   L0980
         leas  $02,s
L0914    lbra  L011D
L0917    lbra  L05E7
L091A    lbsr  L026F
         bra   L0924
L091F    clr   <u0033
         lbsr  L037B
L0924    ldu   <MEMPTR
         lbsr  L2CB5
         lbra  L0127
L092C    ldd   ,x
         bitb  #$10
         bne   L0980
         bitb  #$08
         beq   L0941
         ldb   $02,x
         bpl   L0941
L093A    ldu   $03,x
         lbsr  L1CBB
         bne   L092C
L0941    lda   #$08
         lbra  L056A
L0946    pshs  u
         ldu   <MEMPTR
         lbsr  L2CB5
         ldx   <u00F8
         lbsr  L07AF
         lbsr  L021B
         ldx   <u00FA
         lbsr  L2CDF  Copy floating point value from X to buffer in U
         ldx   <u00F8
         lda   #$02
         lbsr  L07BB
         lbsr  L2CBB
         puls  u
         lbra  L089A
         tst   <u00D9
         bne   L0905
         lbsr  L06B8
         stx   <u00F8
         sta   <u00D9
         lbsr  L0224
         ldx   <u00F8
         lbsr  L0308
         lbhi  L0598
L0980    rts
L0981    com   <u005D
         lbsr  L05EC
         com   <u005D
         ldx   #$015D
         leau  >L09BA,pcr   String 'Radian mode
L098F    ldb   #$FF
L0991    stb   <u0025
         pshs  u,x
         lbsr  L1CA3
         ldx   <MEMPTR
         puls  u,b,a
         leax  d,x
         lbsr  L1CA9  output string pointed to in U
         clrb
         leau  >L09B3,pcr
         lda   ,x
         bne   L09AE
         ldb   <u0025
         leau  u0004,u
L09AE    stb   ,x
         lbra  L1CDC

L09B3    fcc   "Off"
         fcb   0
         fcc   "On"
         fcb   0
L09BA    fcc   "Radian mode "
         fcb   $00

L09C7    fcc   "Recalc ..."
         fcb   $00

* FIXME
L09D2    fcb  $96,$36,$10,$27,$FB,$90,$96,$C9,$27,$3C,$81,$80,$27,$0F
L09E0    fcb  $17,$FC,$A4,$D1
         sbcb  <u0027
         std   a,y
         bita  ,x
         clr   <u0081
         fcb   $0B
         bne   L09E0
         pshs  b
         lda   b,y
         bmi   L0A0F
         addb  #$03
         cmpb  <u00D2
         beq   L0A05
         bgt   L0A0F
L09FD    lda   b,y
L09FF    anda  #$3F
         cmpa  #$0B
         bne   L0A0F
L0A05    puls  b
         incb
         ldu   b,y
         clr   <u00C9
         lbra  L08E0
L0A0F    puls  b
         lbsr  L03DC
         bra   L0A20
         lda   <u00C9
         lbeq  L043C
         eora  #$01
L0A1E    sta   <u00C9
L0A20    lbra  L011D
         lda   #$81
         ldb   <u00C9
         bmi   L0A1E
         suba  <u00C9
         bra   L0A1E
         lda   <u00C9
         beq   L0A37
         ora   <u00CB
L0A33    ora   #$80
         sta   <u00CB
L0A37    rts
         lda   <u00C9
         beq   L0A37
         tst   <u00CB
         bne   L0A42
         sta   <u00CB
L0A42    anda  <u00CB
         bra   L0A33
         lda   <u00C9
         beq   L0A37
         eora  <u00CB
         bra   L0A33
L0A4E    ldd   >$FDFC
         addb  >$FD72
         std   >$A1FC
         andb  #$FD
         sta   >$FDBF
         std   >$DCFD
         addd  #$F844
         stb   >$FEFC
         adca  #$12
         nega
         stu   >$84F6
         subb  >$F6F0
         ldb   >$F0FF
         eorb  #$FF
         bitb  <u00FF
         fcb   $D5
* Table
L0A76    fcb   $F7,$A5
         fcb   $F7,$8D
         fcb   $F7,$7A
         fcb   $F7,$AE
         fcb   $F7,$AC
         fcb   $FE,$F3
         fcb   $F7,$C2
         fcb   $FF,$B7
         fcb   $FF,$C2
         fcb   $FF,$D0
L0A8A    fcb   '$
         fcb   $27,$22
         fcb   $27,'#
         fcb   '%,'"
         fcb   '%,'&
         
         fcb   $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00

L0AA5    lbra  L0B7D  Initialise data and terminal
L0AA8    lbra  L0BD1
L0AAB    lbra  L16D5
L0AAE    lbra  L0FF4
L0AB1    lbra  L18B2
L0AB4    lbra  L11E9
L0AB7    lbra  L1791
         lbra  L11E6
         lbra  L116C
L0AC0    lbra  L19A9
L0AC3    lbra  L179F
L0AC6    lbra  L1A0C
L0AC9    lbra  L0FF6
L0ACC    lbra  L17CA
L0ACF    lbra  L0EF6
L0AD2    lbra  L1030
L0AD5    lbra  L14D9
L0AD8    lbra  L1139
L0ADB    lbra  L1B2B
L0ADE    lbra  L1984
L0AE1    lbra  L0C6A
L0AE4    lbra  L10C1
L0AE7    lbra  L10F0
L0AEA    lbra  L19D7
L0AED    lbra  L1A68
         lbra  L1478
L0AF3    lbra  L1991
L0AF6    lbra  L112F
L0AF9    lbra  L110A
L0AFC    lbra  L107C
         lbra  L106C
L0B02    lbra  L0FDB
L0B05    lbra  L0C73
L0B08    lbra  L0C78
L0B0B    lbra  L1291
L0B0E    lbra  L1825
         lbra  L0FD0
L0B14    lbra  L10AB
L0B17    lbra  L10B6
L0B1A    lbra  L1081
L0B1D    lbra  L105D
L0B20    lbra  L10E5

start    pshs  u,y,x,b,a
         lda   #$09
L0B27    suba  #$04
         sta   <u00B3
         leax  >L0B70,pcr
         os9   I$Open
         bcc   L0B4C
         lda   <u00B3
         dec   <u00B3
         bne   L0B27
L0B3A    pshs  b
         lda   #$02
         leax  >L0B65,pcr   "Can't load"
         tfr   x,y
         os9   I$WritLn
         puls  b
         os9   F$Exit
L0B4C    tfr   u,x       Load the Dynacalc.trm file into the memory area
         ldy   #$3200
         os9   I$Read
         bcs   L0B3A
         tfr   pc,x
PCSAVEPT os9   I$Close
         bcs   L0B3A
         ldd   #$0485    Version number
         jmp   >$0A2B,u  Jump into the Dynacalc.trm code

L0B65    fcc   "Can't load "
L0B70    fcc   "Dynacalc.trm"
         fcb   $0D

* Initialise data and terminal
L0B7D    ldy   <MEMPTR
         ldb   #$91
         leax  >$0157,y
L0B86    clr   ,x+
         decb
         bne   L0B86
         clr   <u0011
         ldb   #$3E
         leax  >$0500,y
         ldu   <u00DA
L0B95    stu   b,x
         subb  #$02
         bpl   L0B95
         ldx   <u001E
         stu   ,--x
         stx   <u00C5
         clr   <u001C
         stu   >$0580,y
         ldd   <MEMPTR
         adda  #$02
         sta   <u008C
         leau  >$0090,y   Terminal setup
         lbsr  L106C
         leax  >$0510,y
         stx   <u00A2
         lda   <u0006
         sta   <u0093
         ldd   #$2309
         sta   <u002D
         stb   <u0092
         stb   $08,x
         lbsr  L50BB
         tst   <u00ED
         beq   L0BD1
         lbra  L3C58

L0BD1    lds   <u0017
         lda   #$FF
         sta   <u00D5
         clr   <u00ED
         ldx   #$0700
         stx   <u0044
         clr   <u0091
         lbsr  L0FDB
         clr   <u009B
         clr   <u00CC
         clr   <u00AC
         lbsr  L1CC1
         lbsr  L1CAC
         pshs  pc
         sts   <u0034
         clr   <u00BC
         tst   <u00EE
         beq   L0C00
         clr   <u00EF
         lbra  L3C6A

L0C00    ldu   <u006E
         lbsr  L1CCD
         lda   <u0091
         bne   L0BD1
         inca
         sta   <u0054
         lbsr  L1CF4
         tst   <u0092
         beq   L0C20
         clr   <u0092
         bsr   L0C6A
         ldu   <MEMPTR
         leau  >u03BB,u
         lbsr  L1CA9  output string pointed to in U
L0C20    tst   <u00C8
         beq   L0C27
         lbsr  L0EC8
L0C27    tst   <u00CC
         bne   L0C2E
         lbsr  L1CCA
L0C2E    bsr   L0C73
         ldu   <MEMPTR
         leau  >u039B,u
         stu   <u0057
         clrb
         clra
         std   <u00C3
         std   <u009A
         stb   <u00E2
         stb   <u0033
         stb   <u0075
         std   <u00E0
         stb   <u0078
         stb   <u0061
         incb
         bsr   L0C78
         tst   <u0019
         lbne  L493A
         ldu   <u00A2
         ldx   -u0004,u
         lbsr  L1A50
         lbsr  L1D00
         bsr   L0C9F
         ldy   <u00E9
         lbsr  L10C1
         clr   <u0060
         lbra  L1205

L0C6A    ldx   #$010B  line 1 column 11?
L0C6D    lbsr  L0FF4
         lbra  L1C78

L0C73    ldx   #$0200
         bra   L0C6D

L0C78    clra
         sta   <u0068
         sta   <u008B
         sta   <u00A5
         deca
         sta   <u00CC
         sta   <u005A
         sta   <u0060
         sta   <u0059
         sta   <u005B
         sta   <u00AD
         sta   <u00BB
         ldy   <MEMPTR
         sta   >$027F,y
         deca
         sta   <u005C
         ldy   <u00E9
         lbsr  L0E40
L0C9E    rts

L0C9F    fcb   $86
L0CA0    fcb   $4F
         ldb   <u00F0
         pshs  b,a
L0CA5    ldb   #$67
         subb  ,s
L0CA9    pshs  b
         lbsr  L10F0
         beq   L0CB5
         leas  $03,s
L0CB2    lbra  L1D00
L0CB5    tst   $01,s
         beq   L0CBB
         bsr   L0CDA
L0CBB    ldx   #$0001
         os9   F$Sleep
         puls  b
         decb
         bne   L0CA9
         tst   $01,s
         beq   L0CA5
         tst   <u00F0
         beq   L0CD6
         lbsr  L1D03
         lbsr  L3C73
         bra   L0CA5
L0CD6    bsr   L0CB2
         bra   L0CA5
L0CDA    bsr   L0D32
         ldb   <u0011
         beq   L0C9E
         ldy   <u00A2
         bsr   L0D09
         sta   <u0094
         addb  $01,y
         lda   ,y
         deca
         std   <u006C
         adda  -$02,y
         sta   $0D,y
L0CF2    inc   <u006C
         lda   <u006C
         cmpa  $0D,y
         beq   L0CFF
         lbsr  L1CE5
         bcc   L0CF2
L0CFF    ldu   <u006C
         cmpu  <u006E
         beq   L0C9E
         lbra  L1CFD
L0D09    pshs  y
         bsr   L0D24
         tfr   y,d
         subb  #$3F
         negb
         lslb
         lslb
         puls  y
         lda   -$01,y
         mul
         pshs  a
         tfr   x,d
         lslb
         lslb
         lda   $0F,y
         mul
         puls  pc,b
L0D24    pshs  b
         decb
         clra
         tfr   d,x
         ldb   #SS.Joy
         os9   I$GetStt
         tsta
         puls  pc,b

L0D32    ldb   #$01
         bsr   L0D38
         ldb   #$02
L0D38    bsr   L0D24
         beq   L0D52
L0D3C    deca
         bne   L0D3C
         bsr   L0D24
         beq   L0D52
L0D43    bsr   L0D24
         bne   L0D43
         tst   <u0011
         beq   L0D50
         cmpb  <u0011
         bne   L0D50
         clrb
L0D50    stb   <u0011
L0D52    rts
L0D53    pshs  b,a
         tst   <u0075
         bne   L0D5F
         ldx   #$03C1
         lbsr  L0FE0
L0D5F    lbsr  L0E40
         lda   #$0A
         sta   >$023F,y
         ldy   <u00E9
         sta   <u0061
         puls  b,a
         sta   <u009A
         cmpa  #$28
         lbeq  L15C6
         cmpa  #$40
         lbeq  L169C
         cmpa  #$23
         lbeq  L0E60
         cmpa  #$2D
         beq   L0D89
         cmpa  #$2B
L0D89    lbeq  L11E6
         cmpa  #$41
         lbge  L1507
         lbra  L131D
         ldx   #$03C7
         lbsr  L0FE0
         ldy   <u00E9
         lda   <u0064
         sta   <u008B
         cmpa  #$27
         lbeq  L11E9
         lbra  L119C
         tst   <u0091
         bne   L0DC8
         tst   <u00A5
         bne   L0E31
         lbsr  L1030
         cmpa  #$2E
         beq   L0DCB
         ldb   #$0A
         cmpa  #$2C
         bne   L0DE8
         tst   <u0068
         bne   L0DE8
L0DC5    lbsr  L0FC2
L0DC8    lbra  L0E94
L0DCB    tst   <u004C
         beq   L0DC5
         ldb   <u0059
         incb
         ldb   b,y
         cmpa  b,y
         beq   L0DC5
         tst   <u0068
         beq   L0DC5
L0DDC    lbsr  L0EF6
         lbsr  L0EF6
         tst   <u00BB
         beq   L0DF0
         ldb   #$14
L0DE8    stb   <u0061
L0DEA    tst   <u0075
         beq   L0DF0
         bsr   L0E32
L0DF0    lbsr  L0EF6
L0DF3    tst   <u0054
         beq   L0DFA
         lbsr  L1747
L0DFA    bsr   L0E40
         lbsr  L16BE
         lbsr  L1030
         tst   <u00BB
         lbne  L11E9
         lbra  L1186
         bsr   L0E27
         bne   L0DC8
         ldb   <u005B
         tst   <u0075
         beq   L0E16
         decb
L0E16    lda   b,y
         bsr   L0E27
         bne   L0DC8
         decb
         lda   b,y
         bsr   L0E27
         beq   L0DC8
         lda   <u0064
         bra   L0DEA
L0E27    cmpa  #$3C
         bcs   L0E31
         cmpa  #$3E
         bhi   L0E31
         orcc  #$04
L0E31    rts
L0E32    ldb   #$FF
         leax  >L0E53,pcr
L0E38    incb
         cmpa  b,x
         bne   L0E38
         lbra  L159C
L0E40    ldx   <MEMPTR
         leax  >$014B,x
         ldb   #$0B
         clra
L0E49    sta   b,x
         decb
         bge   L0E49
         sta   <u003A
         sta   <u002F
L0E52    rts

* Operators here
L0E53    fcb   '+,'-,'*,'/
         fcb   '^,'>,'<,'=,'(,'),'.,$2C,'?

* out of sync
L0E60    fcb   $0A
         rolb
         ldu   <u006E
         bra   L0E83
         cmpa  #$23
         bne   L0E94
         tst   <u004C
         beq   L0E94
         dec   <u006A
         ldu   <u006A
         bra   L0E83

L0E74    cmpa  #$23
         bne   L0E94
         tst   <u0054
         beq   L0E94
         lbsr  L1747
         clr   <u0054
         ldu   <u0070
L0E83    lda   #$02
         sta   <u00BD
         sta   <u0033
         sta   <u0055
L0E8B    clr   <u0064
         lbsr  L0033
         lbcc  L14B1
L0E94    lda   <u0093
         lbsr  L107C
         tst   <u0061
         lbeq  L1BA4
         tst   <u0075
         lbeq  L11E9
L0EA5    ldb   <u005B
         pshs  b
         ldb   <u0072
         stb   <u005B
         lbsr  L19CB
         tst   <u0091
         beq   L0EC1
         ldb   #$FF
         bsr   L0F24
         tst   <u0077
         bmi   L0EC1
         beq   L0EC1
         lbsr  L1C78
L0EC1    puls  b
         lbra  L1A68

L0EC6    fcb   $02,$fd

L0EC8    ldy   <u00A2
         ldx   -$0A,y
         stx   -$04,y
         lbsr   L0FF4
         ldx   <u007E
         bne   L0EDA
         leax  >L0EC6,pcr
L0EDA    leax  $01,x
         lda   ,x
         anda  #$07
         bne   L0EE4
         ora   $09,y
L0EE4    sta   <u0022
         lda   -$08,y
         sta   <u0020
         sta   <u0021
         com   <u00C7
         lbsr  L1CA6
         clr   <u00C7
         clr   <u00C8
         rts
L0EF6    tst   <u0075
         lbne  L0E52
         pshs  x,b,a
         cmpa  <u0009
         beq   L0F61
L0F02    clr   <u00CD
         ldb   <u005C
         cmpb  #$FE
         lbne  L0F9E
         ldb   <u005B
         incb
         lbmi  L1029
         sta   b,y
         stb   <u005B
         subb  <u000E
         blt   L0F1F
L0F1B    bsr   L0F24
         bra   L0F59
L0F1F    lbsr  L107C
         bra   L0F59
L0F24    lda   #$0D
         lbsr  L1081
L0F29    lda   <u000E
L0F2B    sta   <u0077
         lbsr  L1D03
L0F30    incb
         lda   b,y
         lbsr  L1081
         cmpb  <u005B
         bcc   L0F3E
         dec   <u0077
         bpl   L0F30
L0F3E    lbra  L3C73
L0F41    ldb   <u005B
         subb  <u000E
         bpl   L0F1B
L0F47    tst   <u005B
         ble   L0F51
         ldb   #$FF
         bsr   L0F24
         bra   L0F56
L0F51    lda   #$0D
         lbsr  L107C
L0F56    lbsr  L1C78
L0F59    lda   #$FE
         sta   <u005C
         bsr   L0F3E
         puls  pc,x,b,a
L0F61    lda   <u005B
         ldb   <u0059
         cmpa  b,y
         ble   L0F78
         dec   <u005B
         cmpa  <u000E
         bge   L0F41
         lda   #$D4   Destructive backspace
         lbsr  L105D
         bra   L0F59
L0F76    leas  -$04,s
L0F78    sta   <u005C
         lda   b,y
         lda   a,y
         cmpa  #$28
         bne   L0F84
         dec   <u0068
L0F84    cmpa  #$29
         bne   L0F8A
         inc   <u0068
L0F8A    bsr   L0FC2
         sta   <u005B
         subb  #$40
         lda   b,y
         sta   <u0061
         lbsr  L0E40
         tst   <u005B
         bmi   L0F47
         lbra  L0F02
L0F9E    cmpb  <u005B
         bne   L0FA6
         tst   <u0055
         beq   L0F59
L0FA6    subb  <u000E
         bpl   L0F41
         ldb   <u005B
         cmpb  <u000E
         bpl   L0F41
         lda   <u005A
         inca
         sta   <u00BE
         bsr   L0FF6
         cmpb  <u005A
         beq   L0FC0
         ldb   <u005A
         lbsr  L0F29
L0FC0    bra   L0F56
L0FC2    ldb   <u0059
         incb
         lbpl  L1BA4
         stb   <u0059
         lda   b,y
         sta   <u005A
         rts
L0FD0    ldx   #$0200
L0FD3    bsr   L0FF4
         lbsr  L1C73
         lbra  L3C73
L0FDB    ldx   #$0000
         bra   L0FD3
L0FE0    stx   <u006C
         lbsr  L1CA3
         sta   <u00C4
         ldd   <u006C
         ldy   <MEMPTR
         leau  d,y
         lbsr  L1CA9
         ldx   #$0200
L0FF4    stx   <u00BD
L0FF6    pshs  u,x,b
         tst   <u00E0
         bne   L1025
         ldd   <u00BD
         cmpa  #$02
         bhi   L1009
         tst   <u00C4
         bne   L1009
         lbsr  L1D03
L1009    stb   <u00E5
         addd  <u000A
         ldu   <MEMPTR
         leau  >u00B0,u
         tst   ,u
         pshs  b
         ldb   <u0010
         sta   b,u
         puls  a
         ldb   <u000C
         sta   b,u
         bsr   L106C
         clr   <u00E4
L1025    lda   #$04
         puls  pc,u,x,b
L1029    lda   <u0093
         bsr   L107C
         lbra  L0F59
L1030    pshs  b,a
         lda   <u0059
         ldb   <u005B
         cmpb  <u005A
         beq   L105B
         deca
         tst   <u0075
         beq   L1045
         cmpa  #$81
         blt   L1047
         bra   L1053
L1045    cmpa  #$C1
L1047    lblt  L13E2
         suba  #$40
         ldb   <u0061
         stb   a,y
         adda  #$40
L1053    sta   <u0059
         ldb   <u005B
         stb   a,y
         stb   <u005A
L105B    puls  pc,b,a
L105D    pshs  b
         tfr   a,b
         clra
         ldu   <MEMPTR
         leau  d,u
         puls  b
         bra   L106C
L106A    bsr   L109A
L106C    lda   ,u+
         bpl   L106A
         clra
         exg   d,u
         cmpb  #$D4
         exg   d,u
         bls   L107B
         dec   <u00E4
L107B    rts
L107C    bsr   L1081
         lbra  L3C73
L1081    tst   <u00E0
         bne   L109A
         pshs  x,b,a
         cmpa  #$0A
         bne   L108D
         inc   <u00BD
L108D    ldx   <MEMPTR
         tst   >$00FA,x
         puls  x,b,a
         beq   L109A
         lbsr  L10E5
L109A    tst   <u00E0
         beq   L10A2
         cmpa  #$20
         bcs   L10A9
L10A2    anda  #$7F
         pshs  x
         lbsr  L3C67
L10A9    puls  pc,x

* Read the 32 byte status from path #0
L10AB    pshs  b,a
         clra
         clrb
         ldx   <u0030
         os9   I$GetStt
         puls  pc,b,a

* Restore the status to path #0
L10B6    pshs  x,b,a
         clra
         clrb
         ldx   <u0030
         os9   I$SetStt
         puls  pc,x,b,a

L10C1    lbsr  L1D00
         lbsr  L0CA0
         bsr   L1103
         ldb   -$01,x
         incb
         bpl   L10CF
         clrb
L10CF    stb   -$01,x
         lda   b,x
         cmpa  >-$0509,x
L10D7    lbeq  L4943
         cmpa  #$1B    Escape entered?
         lbeq  L1BA4
         tst   <u009A
         beq   L10EF
L10E5    cmpa  #$61    Lower than 'a'?
         bcs   L10EF
         cmpa  #$7A
         bhi   L10EF
         anda  #$5F
L10EF    rts
L10F0    bsr   L1139
         bsr   L1103
         ldb   -$01,x
         cmpb  -$02,x
         rts
L10F9    pshs  b,a
         clra
         ldb   #$01
         os9   I$GetStt
         puls  pc,b,a
L1103    ldx   <MEMPTR
         leax  >$0600,x
         rts
L110A    pshs  u,y,b
         clra
         ldy   #$0001
         ldu   <MEMPTR
         leax  >u015E,u
         os9   I$Read
         bcc   L1120
         cmpb  #$D3
         beq   L10D7
L1120    lda   <u005E
         anda  #$7F
         tst   >u00FA,u
         beq   L112D
         lbsr  L10E5
L112D    puls  pc,u,y,b
L112F    lbsr  L0CA0
         incb
         bpl   L1136
         clrb
L1136    lda   b,x
         rts
L1139    bsr   L10F9
         bcs   L116B
         bsr   L110A
         lbsr  L4946
         bsr   L1103
         ldb   -$01,x
         cmpa  <u0008
         bne   L1152
         clr   -$04,x
         coma
         sta   -$05,x
         coma
         bra   L1167
L1152    ldb   -$02,x
         incb
         bpl   L1158
         clrb
L1158    cmpb  -$01,x
         bne   L1161
         lda   <u0093
         lbra  L107C
L1161    cmpb  -$05,x
         bne   L1167
         com   -$05,x
L1167    stb   -$02,x
         sta   b,x
L116B    rts
L116C    tst   <u0091
         bne   L1173
         lbsr  L3C73
L1173    lbsr  L10C1
         pshs  a
         tst   <u008B
         bne   L1184
         com   <u0060
         beq   L1184
         bsr   L1186
         clr   <u0060
L1184    puls  pc,a
L1186    bsr   L118B
L1188    lbra  L0FF4
L118B    lda   #$02
         ldb   <u005B
         incb
         cmpb  <u000E
         bcs   L1196
         ldb   <u000E
L1196    tfr   d,x
         ldu   #$0003
         rts
L119C    tst   <u008B
         bmi   L11E6
         sta   <u00C8
         ldu   <u00A2
         ldb   <u005B
         incb
         ldx   -u0004,u
         cmpa  <u0009
         bne   L11B0
         decb
         leax  -$01,x
L11B0    cmpb  -u0008,u
         bcc   L11E2
         bsr   L1188
         lda   <u0064
         leax  $01,x
         cmpa  <u0009
         bne   L11C2
         leax  -$01,x
         lda   #$20
L11C2    stx   -u0004,u
         lbsr  L107C
         incb
         cmpb  -u0008,u
         bne   L11DD
         tst   <u00E8
         beq   L11E2
         lda   <u0064
         ldb   <u005B
         incb
         sta   b,y
         stb   <u005B
         lda   <u0003
         bra   L1205
L11DD    lda   #$20
         lbsr  L107C
L11E2    bsr   L1186
         lda   <u0064
L11E6    lbsr  L0EF6
L11E9    tst   <u0075
         beq   L11FF
         ldb   <u005B
         incb
         lda   b,y
L11F2    stb   <u005B
         cmpa  #$2E
         bne   L1205
         incb
         cmpa  b,y
         beq   L11F2
         bra   L1205
L11FF    lbsr  L3C73
         lbsr  L116C
L1205    ldu   <u0057
         sta   <u0064
         clrb
         cmpa  #$45
         beq   L1233
         cmpa  #$65
         beq   L1233
         incb
         cmpa  #$41
         blt   L121B
         cmpa  #$5B
         blt   L1233
L121B    incb
         cmpa  #$39
         bgt   L1224
         cmpa  #$2F
         bgt   L1233
L1224    incb
         leau  u0001,u
         tst   ,u
         bmi   L1257
L122B    tst   ,u
         bmi   L1224
         cmpa  ,u+
         bne   L122B
L1233    pshs  pc,b,a,cc
         tst   <u008B
         bne   L1284
         leax  >L12A5,pcr
         addb  <u0061
         ldb   b,x
         leax  >L12EB,pcr
         ldd   b,x
         pshs  pc
         addd  ,s++
         std   $03,s
         ldx   <MEMPTR
         leax  >$037F,x
         stx   <u0057
         puls  pc,b,a,cc
L1257    tst   <u0061
         bne   L125F
         tst   <u008B
         beq   L1265
L125F    cmpa  #$06
         lbeq  L1A19
L1265    cmpa  <u0009
         bne   L1270
         tst   <u008B
         bne   L1276
         lbra  L11E6
L1270    cmpa  #$20
         bcs   L127C
         tst   <u008B
L1276    lbne  L119C
         tst   <u0061
L127C    lbne  L11E9
         ldb   #$01
         bra   L1233
L1284    leas  $05,s
         cmpb  #$03
         bne   L1276
L128A    tst   <u00AD
         bne   L1291
         lbra  L3C64
L1291    sta   <u0088
         sty   <u0089
         ldb   <u005B
         incb
         stb   <u0074
         clrb
         lda   <u001C
         ora   #$10
         sta   <u00AE
         lbra  L1C9A

L12A5    fcb   $26,$26,$28,$26,$28,$2A,$30,$2E,$2C,$26
         fcb   $0C,$0C,$0A,$08,$0A,$10,$1E,$14,$00,$00
         fcb   $0C,$0C,$18,$18,$18,$18,$18,$04,$18,$00
         fcb   $0A,$00,$0A,$0E,$0A,$0E,$0E,$00,$0E,$00
         fcb   $1C,$1C,$1A,$1A,$1A,$1A,$1A,$1A,$00,$00
         fcb   $00,$00,$00,$08,$12,$12,$20,$02,$16,$00
         fcb   $24,$24,$18,$22,$22,$00,$00,$00,$00,$00

L12EB    fdb   $FC4B
         fdb   $FC2B
         fdb   $FC1D
         fcb   $05,$D3,$04,$64,$00,$D4,$02,$BE
         fcb   $01,$19,$FB,$C2,$FB,$63,$04,$53
         fcb   $05,$C1,$02,$F2,$03,$A5,$FF,$9D
         fcb   $03,$7D,$03,$85,$08,$F4,$02,$C2
         fcb   $FB,$4D,$FB,$0A,$0A,$4E,$0A,$57,$09,$65,$09,$45

L131D    ldb   #$1E
         stb   <u0061
         cmpa  #$30
         blt   L132E
         cmpa  #$39
         bgt   L132E
         sta   <u0053
L132B    lbra  L11E6
L132E    cmpa  #$45
         beq   L134A
         cmpa  #$65
         beq   L134A
         cmpa  #$2E
         bne   L1344
         tst   <u004E
         bne   L135F
         sta   <u0053
         sta   <u004F
         bra   L132B
L1344    tst   <u0053
         beq   L132B
         bra   L1362
L134A    tst   <u004E
         bne   L135F
         lda   #$65
         lbsr  L0EF6
         lbsr  L1030
         clr   <u0053
         sta   <u004E
         sta   <u004F
         lbra  L11E9
L135F    lbra  L0E94
L1362    cmpa  #$2C
         bne   L136A
         tst   <u0068
         beq   L135F
L136A    cmpa  #$28
         beq   L135F
         ldu   <MEMPTR
         leau  >u0320,u
         leax  <u0010,u
         stx   <u00FD
         tfr   u,x
         lda   <u005A
         cmpa  <u005B
         beq   L135F
         tst   <u004E
         beq   L1388
         lbsr  L0FC2
L1388    tst   <u0075
         beq   L138E
         dec   <u005B
L138E    bsr   L13D0
         ldb   <u0050
         stb   <u003C
         cmpa  <u005B
         bhi   L135F
         deca
L1399    inca
         cmpa  <u005B
         bhi   L1411
         ldb   a,y
         cmpb  #$2E
         bne   L13A8
         stb   <u0051
         bra   L1399
L13A8    cmpb  #$65
         beq   L13FC
         cmpb  #$45
         beq   L13FC
         cmpb  #$30
         bne   L13C0
         tst   <u004D
         bne   L13C0
         tst   <u0051
         beq   L1399
         dec   <u0052
         bra   L1399
L13C0    tst   <u0051
         bne   L13C6
         inc   <u0056
L13C6    inc   <u004D
         cmpx  <u00FD
         beq   L1399
         stb   ,x+
         bra   L1399
L13D0    inca
         bmi   L13E2
         ldb   a,y
         cmpb  #$2B
         beq   L13D0
         cmpb  #$2D
         beq   L13DE
         rts
L13DE    com   <u0050
         bra   L13D0
L13E2    leas  $02,s
L13E4    lda   <u0093
         lbsr  L107C
         ldb   <u0059
         lda   <u005B
         decb
         stb   <u0059
         tst   <u0075
         lbne  L0EA5
         lbsr  L0F76
         lbra  L11E9
L13FC    clr   <u0050
         bsr   L13D0
         deca
         cmpa  <u005B
         beq   L1411
         lbsr  L14DB
         blt   L13E4
         tst   <u0050
         beq   L1412
         negb
         bra   L1412
L1411    clrb
L1412    clr   ,x
         addb  <u0056
         addb  <u0052
         decb
         tfr   u,x
         stb   <u0027
         bpl   L1432
         negb
         cmpb  #$17
         blt   L1432
         subb  #$28
         negb
         cmpb  <u004D
         bcc   L142F
         stb   <u004D
         clr   b,x
L142F    ldb   <u0027
         negb
L1432    cmpb  #$26
         bge   L13E4
         lda   <u004D
         cmpa  #$10
         ble   L143E
         lda   #$10
L143E    sta   <u004D
         cmpb  #$13
         blt   L1446
         sta   <u004B
L1446    ldb   <u0027
         subb  <u004D
         incb
         stb   <u0039
         pshs  y
         ldu   <MEMPTR
         leay  >u0550,u
         lbsr  L2CE2
         lbsr  L2CE5
         puls  y
L145D    tst   <u0075
         beq   L1485
         ldx   <u0073
         lbsr  L2CBB
         lda   #$80
         lbsr  L15B5
         leax  $08,x
         lbsr  L15A2
         inc   <u005B
         bra   L14A0
L1474    ldb   #$20
L1476    lda   #$03
L1478    sta   <u0022
         sta   <u004A
         lda   <u0020
         sta   <u0065
         stb   <u0020
         ldu   <MEMPTR
         rts
L1485    bsr   L1474
         ldb   <u005A
         incb
         leax  b,y
         stx   <u00F8
         leay  >$02D0,y
         lbsr  L2CB8
         ldy   <u00F8
         clr   <u004B
         bsr   L14C0
         ldb   <u0065
         stb   <u0020
L14A0    ldb   #$32
         stb   <u0061
         lda   <u0064
         lbra  L1205
L14A9    leax  >L2CEE,pcr
         ldd   ,x
         leax  d,x
L14B1    ldy   <u00E9
         lbsr  L0FC2
         ldu   <MEMPTR
         leau  u0008,u
         lbsr  L2CDF  Copy floating point value from X to buffer in U
         bra   L145D
L14C0    ldb   <u005B
         stb   <u005C
         tfr   y,d
         ldy   <u00E9
         subd  <u00E9
         tsta
L14CC    lbne  L13E2
         tstb
         bmi   L14CC
         decb
         stb   <u005B
         lbra  L0EF6
L14D9    lda   <u005A
L14DB    clr   ,-s
         pshs  a
L14DF    inc   ,s
         lda   ,s
         ldb   a,y
         subb  #$30
         bcs   L14ED
         cmpb  #$09
         bls   L14F0
L14ED    clrb
         bra   L14F6
L14F0    addb  $01,s
         stb   <u006B
         bcs   L1502
L14F6    cmpa  <u005B
         bcc   L1504
         lda   #$0A
         mul
         stb   $01,s
         tsta
         beq   L14DF
L1502    lda   #$F0
L1504    leas  $02,s
L1506    rts
L1507    ldb   #$14
         stb   <u0061
         tst   <u0054
         lbne  L158C
         suba  #$40
         sta   <u006A
         ldb   <u004C
         beq   L152F
         sta   <u004C
         lda   #$1A
         mul
         addb  <u004C
         beq   L1524
         bcs   L158C
L1524    stb   <u004C
         tsta
         bne   L158C
         inc   <u0059
         stb   <u006A
         lda   <u0064
L152F    sta   <u004C
         lda   <u0064
         lbsr  L0EF6
         lbsr  L1030
         bra   L1589
         bne   L1564
         tst   <u00A5
         beq   L1543
         lda   #$FF
L1543    ldb   <u005A
         cmpb  <u005B
         bne   L1550
L1549    tst   <u004C
         bne   L158C
         lbra  L16CB
L1550    tsta
         bmi   L1506
         cmpa  #$2E
         beq   L1559
         clr   <u004C
L1559    inc   <u0059
         tst   <u0075
         beq   L1561
         bsr   L158F
L1561    lbra  L14A0
L1564    tst   <u004C
         beq   L158C
         tst   <u0053
         bne   L1576
         cmpa  #$30
         beq   L1589
         sta   <u0053
         sta   <u004C
         lsl   <u004C
L1576    lbsr  L0EF6
         lbsr  L14D9
         bge   L1587
         tstb
         beq   L1587
         lbsr  L0FC2
         lbra  L13E4
L1587    dec   <u006B
L1589    lbra  L11E9
L158C    lbra  L0E94
L158F    ldb   <u006A
         decb
         ldx   <u0073
         lda   #$40
         bsr   L15B5
         bsr   L159E
         ldb   <u006B
L159C    ldx   <u0073
L159E    stb   ,x+
         clr   <u00AE
L15A2    pshs  x
         ldx   <MEMPTR
         leax  >$04F3,x
         cmpx  ,s
         puls  x
         lbcs  L13E2
         stx   <u0073
         rts
L15B5    exg   d,x
         tstb
         exg   x,d
         beq   L15C1
         ora   -$01,x
         sta   -$01,x
         rts
L15C1    ora   <u001C
         sta   <u001C
         rts
L15C6    cmpa  #$28
         bne   L158C
         inc   <u0068
         bra   L15E1
         cmpa  #$29
         bne   L158C
         tst   <u0068
         beq   L158C
         dec   <u0068
         ldb   #$32
         stb   <u0061
         lbsr  L0E40
         lda   <u0064
L15E1    lbsr  L1030
         tst   <u0075
         beq   L15EB
         lbsr  L0E32
L15EB    lbra  L0DF0
         cmpa  #$23
         beq   L158C
         leax  >L1BB3,pcr
         clr   <u0076
         lda   <u005A
         inca
         leay  a,y
         suba  <u005B
         nega
         tst   <u0075
         beq   L1605
         deca
L1605    sta   <u0069
         ldb   ,x+
         tfr   d,u
         clrb
L160C    lda   b,x
         cmpa  b,y
         bne   L1687
         incb
         dec   <u0069
         bge   L160C
         lda   <u0076
         cmpa  #$25
         lbcc  L14A9
         tst   <u0075
         bne   L162C
L1623    lda   b,x
         sta   b,y
         incb
         bita  #$F0
         bne   L1623
L162C    decb
         leay  b,y
         lda   #$32
         ldb   <u0076
         cmpb  #$21
         bge   L1643
         tst   <u0075
         bne   L163F
         lda   #$28
         sta   ,y+
L163F    inc   <u0068
         lda   #$0A
L1643    sta   <u0061
         tst   <u0075
         bne   L1675
         lbsr  L14C0
L164C    lbsr  L1030
         tst   <u0075
         beq   L1655
         inc   <u005B
L1655    lda   <u0064
         lbsr  L1030
         cmpa  #$28
         beq   L16AA
         cmpa  #$29
         beq   L166A
         tst   <u0075
         bne   L1670
         cmpa  #$0D
         bne   L1672
L166A    ldb   <u0076
         cmpb  #$21
         blt   L16AA
L1670    dec   <u005A
L1672    lbra  L1205
L1675    ldy   <u00E9
         ldb   <u0076
         addb  #$10
         stx   <u006C
         lbsr  L159C
         ldx   <u006C
         dec   <u005B
         bra   L164C
L1687    inc   <u0076
         ldb   <u0076
         cmpb  #$25
         tfr   u,d
         abx
         lbls  L1605
         inc   <u0059
         ldy   <u00E9
         lbra  L13E4
L169C    cmpa  #$40
         bne   L16F2
         lbsr  L0EF6
         ldb   #$28
         stb   <u0061
         lbsr  L1030
L16AA    lbra  L11E9
         ldb   #$0A
         cmpb  <u0061
         beq   L16C9
         tst   <u0054
         bne   L16CF
         cmpa  <u0007
         beq   L16F2
         lbra  L181C
L16BE    ldx   <u006E
         stx   <u0070
         ldx   <u00A2
         ldx   ,x
         stx   <u00B8
         rts
L16C9    bsr   L16BE
L16CB    cmpa  #$0D
         beq   L16F2
L16CF    cmpa  #$0D
         lbeq  L181C
L16D5    ldx   <MEMPTR
         leau  >$0100,x
         leax  >$0171,x
         ldb   #$FE
         stb   <u0040
L16E3    cmpa  ,u+
         beq   L16F5
         comb
         bpl   L16E3
         leax  -$01,x
         inc   <u0040
         bne   L16E3
         bra   L1711
L16F2    lbra  L0E94
L16F5    tfr   b,a
         orb   #$01
         addb  ,x
         anda  #$01
         pshs  cc
         eora  ,s+
         tfr   a,cc
         bcc   L173B
         lda   <u00A3
         leau  a,x
         cmpb  >u039A,u
         bcs   L173B
         stb   ,x
L1711    tst   <u0061
         beq   L1744
         tst   <u0054
         beq   L171C
         lbsr  L0FC2
L171C    sta   <u005C
         lda   <u005A
         sta   <u005B
         bsr   L179D
         lbsr  L0EF6
         ldb   #$32
         tst   <u00BB
         beq   L1731
         stb   <u0061
         stb   <u004C
L1731    lbsr  L1030
         ldu   <u0070
         bsr   L1779
         lbra  L11E9
L173B    tst   <u0061
         bne   L16F2
         lda   <u0093
         lbsr  L107C
L1744    lbra  L1C88
L1747    tst   <u0054
         bne   L174C
         rts
L174C    pshs  y,a
         ldu   <u006E
         ldd   <u00B8
         ldy   <u00A2
         stu   $02,y
         cmpd  ,y
         beq   L177E
         cmpb  $01,y
         beq   L1762
         clr   -$05,y
L1762    cmpa  ,y
         beq   L1768
         clr   -$06,y
L1768    pshs  b,a
         lbsr  L1CD0
         puls  b,a
         std   ,y
         lbsr  L1CC1
         lbsr  L1186
         bra   L178D
L1779    pshs  y,a
         ldy   <u00A2
L177E    ldx   $02,y
         ldd   <u0070
         pshs  y,x,b,a
         lbsr  L1CC4
         puls  y,x,b,a
         stx   $02,y
         std   <u0070
L178D    clr   <u0075
         puls  pc,y,a
L1791    ldx   #$0000
         lbsr  L0FF4
         ldx   <u006E
         stx   <u0070
         sta   <u0075
L179D    bsr   L17CA
L179F    lda   <u0071
         inca
         beq   L17BF
         lbsr  L2CE8
         tstb
         beq   L17BD
         cmpb  #$0A
         blt   L17B9
         sta   <u0036
         tfr   b,a
         lbsr  L2CE8
         bsr   L17DF
         lda   <u0036
L17B9    bsr   L17DF
         tfr   b,a
L17BD    bra   L17E1
L17BF    ldd   #$0502
         bsr   L17DF
         bsr   L17DF
         lda   #$06
         bra   L17E1
L17CA    ldb   <u0070
         lda   #$3F
L17CE    inca
         subb  #$1A
         bcc   L17CE
         cmpa  #$40
         beq   L17D9
         bsr   L17E3
L17D9    addb  #$5B
         tfr   b,a
         bra   L17E3
L17DF    exg   a,b
L17E1    adda  #$30
L17E3    tst   <u0075
         beq   L17F0
         tst   <u0078
         lbne  L1991
         lbra  L1081
L17F0    sta   <u0054
         sta   <u0055
         pshs  b
         ldb   <u005B
         incb
         bmi   L1801
         sta   b,y
         stb   <u005B
         puls  pc,b
L1801    ldb   #$FE
         stb   <u005C
         leas  $05,s
         lbra  L13E4
         sta   <u00C3
         bra   L181C
L180E    dec   <u005B
         lbmi  L1BA4
         tst   <u008B
         lbne  L128A
         clr   <u0075
L181C    tst   <u00A5
         beq   L1821
         rts
L1821    tst   <u0075
         bne   L1856
L1825    lda   <u001C
         anda  #$3F
         sta   <u001C
         lda   #$0D
         sta   <u0075
         sta   <u00AE
         ldb   <u005B
L1833    stb   <u0072
         incb
         bpl   L183E
         subb  #$02
         stb   <u005B
         bra   L1833
L183E    sta   b,y
         ldx   <MEMPTR
         leax  >$0400,x
         stx   <u0073
         lbsr  L0C78
         inc   <u005B
         lda   <u0064
         sta   <u0088
         lda   ,y
         lbra  L0D53
L1856    tst   <u00C3
         lbeq  L1C85
         clr   <u0064
         tst   <u00AE
         bne   L1878
         lbsr  L3C73
         ldu   <MEMPTR
         leay  >u047F,u
         ldb   <u0074
         subb  #$7F
         stb   <u00B4
         lda   <u001C
         lbsr  L0024
         bra   L187A
L1878    clr   <u00C3
L187A    lbsr  L0C78
         clr   <u0075
         tst   <u00C3
         lbeq  L145D
         clr   <u00C3
         lda   #$40
         lbsr  L0EF6
         leay  $01,y
         clrb
         lda   #$21
         sta   <u0076
         leax  >L1C5A,pcr
         lda   <u0033
         beq   L18AF
         leax  >-$000B,x
         cmpa  #$19
         beq   L18AF
         leax  >$0005,x
         cmpa  #$1A
         beq   L18AF
         leax  >$0009,x
L18AF    lbra  L1623
L18B2    tfr   y,d
         addb  ,y
         adca  #$00
         std   <u007A
         ldb   #$80
         stb   <u00CD
         stb   <u008D
         ldd   <u00E9
         std   <u005B
         ldu   <MEMPTR
         leau  >u03B4,u
         ldb   $01,y
         stb   <u001C
         bitb  #$10
         lbne  L19B3
         lda   #$FF
         sta   <u00B7
         ldb   #$0A
         leay  $02,y
         lda   #$56
         cmpb  -$02,y
         beq   L18E6
         leay  $08,y
         lda   #$45
L18E6    tst   <u00E1
         bne   L18ED
         lbsr  L19A9
L18ED    ldb   <u001C
L18EF    cmpb  #$40
         bcs   L191B
         cmpb  #$80
         bcs   L196B
         ldb   #$14
         clr   <u004B
         lbsr  L1476
         tfr   y,x
         lbsr  L2CB5
         leay  $08,y
         com   <u004A
         pshs  y
         ldy   <MEMPTR
         leay  >$0550,y
         lbsr  L2CB8
         puls  y
         ldb   <u0065
         stb   <u0020
         bra   L197D
L191B    ldb   ,y+
         leax  >L0E53,pcr
         andb  #$3F
         cmpb  #$3F
         bne   L1929
         ldb   #$0C
L1929    lda   b,x
         cmpb  #$10
         blt   L193F
         subb  #$10
         clra
         leax  >L1BB3,pcr
L1936    leax  a,x
         lda   ,x+
         decb
         bpl   L1936
         lda   #$40
L193F    bsr   L1991
         cmpa  #$2E
         bne   L1949
         bsr   L1991
         bsr   L1991
L1949    lda   ,x+
         cmpa  #$40
         bgt   L193F
         cmpa  #$0F
         lbgt  L1961
         lda   -$01,y
         anda  #$3F
         cmpa  #$31
         bge   L1961
         lda   #$28
         bsr   L1991
L1961    ldb   -$01,y
         cmpy  <u007A
         bcs   L18EF
L1968    lbra  L3C73
L196B    bsr   L1984
         tst   <u00BC
         beq   L197D
         bmi   L197D
         ldu   <u00FA
         lda   <u008D
         suba  #$81
         sta   ,u+
         stu   <u00FA
L197D    cmpy  <u007A
         bcc   L1968
         bra   L191B
L1984    stb   <u0078
         ldb   #$FF
         stb   <u0075
         ldu   ,y++
         stu   <u0070
         lbra  L179D
L1991    tst   <u008D
         bpl   L19A8
         pshs  x
         ldx   <u008C
         sta   ,x
         puls  x
         inc   <u008D
L199F    tst   <u0079
         beq   L19A8
         lbsr  L1081
         dec   <u0079
L19A8    rts
L19A9    sta   u0003,u
L19AB    lda   ,u+
         beq   L19A8
         bsr   L199F
         bra   L19AB
L19B3    clr   <u00B7
         ldb   #$02
         cmpb  ,y
         beq   L19CA
         lda   #$4C
         bsr   L19A9
         leay  $02,y
L19C1    lda   ,y+
         bsr   L1991
         cmpy  <u007A
         bcs   L19C1
L19CA    rts
L19CB    lda   <u005B
         inca
         sta   <u005B
         ldb   #$20
         stb   a,y
         clr   <u00F1
         rts
L19D7    ldy   <u00E9
         lda   <u008D
         suba  #$81
         sta   <u005B
L19E0    ldx   #$0200
         lbsr  L0C6D
         ldb   #$FF
         lbra  L0F24
L19EB    lda   <u007C
         clrb
         tst   <u00AD
         bne   L19F5
         ldb   <u005A
         incb
L19F5    stb   <u007C
         cmpa  <u000E
         bls   L1A68
         bsr   L19E0
         bra   L19EB
L19FF    stb   <u005B
         lda   #$20
         sta   b,y
         lbsr  L1C78
         bsr   L1A53
         bra   L1A1D
L1A0C    clr   <u007C
         bsr   L19D7
         ldx   #$0200
         bsr   L1A50
         bsr   L19CB
         bra   L1A1D
L1A19    bsr   L19CB
         sta   <u007C
L1A1D    lbsr  L10C1
         ldb   <u005B
         cmpa  <u0001
         beq   L1A68
         cmpa  <u0000
         beq   L19EB
         ldb   <u007C
         cmpa  <u0004
         beq   L19FF
         cmpa  <u0003
         beq   L1A56
         cmpa  <u0002
         beq   L1A5D
         cmpa  #$0D
         lbeq  L180E
         cmpa  <u0009
         lbeq  L1ADD
         cmpa  <u000F
         lbeq  L1B06
         cmpa  #$1F
         bgt   L1A8D
         bra   L1A1D
L1A50    lbsr  L0FF4
L1A53    lbra  L3C73
L1A56    incb
         cmpb  <u005B
         bhi   L1A1D
         bra   L1A60
L1A5D    decb
         bmi   L1A1D
L1A60    tst   <u00AD
         bne   L1A68
         cmpb  <u005A
         bls   L1A1D
L1A68    stb   <u007C
         cmpb  <u000E
         bhi   L1A74
         bne   L1A7A
         cmpa  <u0002
         bne   L1A7A
L1A74    subb  <u000E
         decb
         lbsr  L0F24
L1A7A    ldb   <u007C
         cmpb  <u000E
         bls   L1A82
         ldb   <u000E
L1A82    lda   #$02
         tfr   d,x
         bsr   L1A50
         tst   <u00BC
         beq   L1A1D
         rts
L1A8D    sta   <u0036
         tst   <u00F1
         beq   L1A97
         cmpb  <u005B
         bne   L1AB2
L1A97    ldb   <u005B
         cmpb  #$7F
         bcc   L1ACE
         incb
         stb   <u005B
         leax  $01,y
         abx
         clr   ,x
         decb
L1AA6    lda   b,y
         sta   ,-x
         decb
         cmpb  <u007C
         bge   L1AA6
         incb
         lda   <u0036
L1AB2    sta   b,y
         incb
         stb   <u007C
         cmpb  <u000E
         bcc   L1A74
         tst   <u00F1
         beq   L1AD1
         decb
         lda   #$02
         tfr   d,x
         lbsr  L0FF4
         inc   <u00BE
         lda   <u0036
         lbsr  L107C
L1ACE    lbra  L1A1D
L1AD1    subb  #$02
L1AD3    lda   <u007C
         suba  <u000E
         nega
         lbsr  L0F2B
         bra   L1A7A
L1ADD    tst   <u00F1
         bne   L1ACE
         ldb   <u007C
         beq   L1ACE
         decb
         stb   <u007C
         ldx   <u00E9
         abx
L1AEB    incb
         lda   b,y
         sta   ,x+
         cmpb  <u005B
         bne   L1AEB
         dec   <u005B
         lda   #$DA
         lbsr  L105D
         ldb   <u007C
         cmpb  <u000E
         lbcc  L1A74
         decb
         bra   L1AD3
L1B06    ldx   #$010B
         ldu   <u00BD
         lbsr  L0FF4
         tfr   u,x
         com   <u00F1
         beq   L1B1B
         leau  >L1B23,pcr
         lbsr  L1CA9
L1B1B    lbsr  L1C78
         lbsr  L1A50
         bra   L1ACE

L1B23    fcc  "Overlay"
         fcb  0

L1B2B    lda   #$3C
         sta   <u0061
         lbsr  L16BE
         lbsr  L1030
         clr   <u00EF
         clr   <u0075
         clr   <u00BB
         bra   L1B8B
         cmpa  #$0D
         beq   L1B49
         clr   <u0064
         cmpa  #$2E
         lbne  L1549
L1B49    ldu   <u0070
         ldb   <u0054
         bne   L1B70
         lbsr  L14D9
         dec   <u006B
         ldb   <u0054
         orb   <u0053
         bne   L1B6C
         ldu   <u006E
L1B5C    stu   <u0070
         stu   <u006A
         inc   <u006A
         lda   <u005B
         sta   <u005C
         lbsr  L179D
         lbsr  L0EF6
L1B6C    dec   <u006A
         ldu   <u006A
L1B70    stu   <u006A
         tst   <u00EF
         lbne  L0DF3
         lda   #$2E
         stu   <u00B1
         sta   <u00EF
         clr   <u0059
         clr   <u005A
         lbsr  L0DDC
         ldu   <u006A
         tst   <u0064
         bne   L1B5C
L1B8B    lbra  L11E9
         cmpa  <u0005
         bne   L1B98
         ldy   <u00A2
         lbra  L1CB2
L1B98    cmpa  #$21
         lbeq  L001E
         cmpa  #$0D
         bne   L1BA9
         clr   <u00E3
L1BA4    lds   <u0034
         jmp   [,s]
L1BA9    clr   <u0011
         lbra  L1CD3
         clr   <u0011
         lbra  L1C8B

L1BB3    fcb   3
         fcc   "SUM"
         fcb   3
         fcc   "MIN"
         fcb   3
         fcc   "MAX"
         fcb   5
         fcc   "COUNT"
         fcb   7
         fcc   "AVERAGE"
         fcb   6
         fcc   "CHOOSE"
         fcb   4
         fcc   "SQRT"
         fcb   3
         fcc   "EXP"
         fcb   2
         fcc   "LN"
         fcb   3
         fcc   "SIN"
         fcb   3
         fcc   "COS"
         fcb   4
         fcc   "ATAN"
         fcb   4
         fcc   "ASIN"
         fcb   4
         fcc   "ACOS"
         fcb   3
         fcc   "TAN"
         fcb   3
         fcc   "LOG"
         fcb   3
         fcc   "INT"
         fcb   3
         fcc   "ABS"
         fcb   5
         fcc   "INDEX"
         fcb   6
         fcc   "LOOKUP"
         fcb   3
         fcc   "NPV"
         fcb   5
         fcc   "ROUND"
         fcb   6
         fcc   "STDDEV"
         fcb   3
         fcc   "RND"
         fcb   2
         fcc   "LN"
         fcb   2
         fcc   "IF"
         fcb   3
         fcc   "AND"
         fcb   2
         fcc   "OR"
         fcb   3
         fcc  "EOR"
         fcb   3
         fcc   "NOT"
         fcb   4
         fcc   "ISNA"
         fcb   7
         fcc   "ISERROR"
         fcb   2
         fcc   "IF"
         fcb   4
         fcc   "TRUE"
         fcb   5
         fcc   "FALSE"
         fcb   2
L1C5A    fcc   "NA"
         fcb   5
L1C5D    fcc   "ERROR"
         fcb   $02
         fcc   "PI"
         fcb   $00,$00,$00,$00,$00,$00,$00,$00

L1C6D    lbra  L1C78
L1C70    lbra  L1C73

L1C73    lda   #$0B
         lbra  L1081

L1C78    lda   #$04
         lbra  L107C

         neg   <u0000
         neg   <u0000
         neg   <u0000
         neg   <u0000

* Offset for menus
L1C85    lbra  L1E19
L1C88    lbra  L2000
L1C8B    lbra  L1FD0
L1C8E    lbra  L1EF3
L1C91    lbra  L1D32
L1C94    lbra  L1F43
         lbra  L1FDB
L1C9A    lbra  L1E3F
         lbra  L261E
         lbra  L2212
L1CA3    lbra  L21E2
L1CA6    lbra  L278E
L1CA9    lbra  L2450  output string pointed to in U
L1CAC    lbra  L1F71
         lbra  L2570
L1CB2    lbra  L2A16
L1CB5    lbra  L2355
L1CB8    lbra  L1E03
L1CBB    lbra  L1DCC
L1CBE    lbra  L2333
L1CC1    lbra  L257A
L1CC4    lbra  L2020
L1CC7    lbra  L1F93
L1CCA    lbra  L1F53
L1CCD    lbra  L1FB9
L1CD0    lbra  L20AC
L1CD3    lbra  L1FFA
L1CD6    lbra  L1E80
         lbra  L1F4C
L1CDC    lbra  L233A
L1CDF    lbra  L221F
L1CE2    lbra  L2B04
L1CE5    lbra  L2517
L1CE8    lbra  L2470
L1CEB    lbra  L23AB
L1CEE    lbra  L1D39
L1CF1    lbra  L1D5D
L1CF4    lbra  L2017
         lbra  L23D6
L1CFA    lbra  L22B5
L1CFD    lbra  L1FE9
L1D00    lbra  L1D09
L1D03    lbra  L1D12
L1D06    lbra  L2352

L1D09    tst   <u00F0
         bne   L1D4D
         bsr   L1D1C
         lbra  L3C73

L1D12    tst   <u00F0
         beq   L1D4D
         pshs  u,a
         lda   #$8C
         bra   L1D20
L1D1C    pshs  u,a
         lda   #$88
L1D20    tst   <u00E0
         bne   L1D29
         lbsr  L0B1D
         com   <u00F0
L1D29    puls  pc,u,a
L1D2B    bsr   L1D2D
L1D2D    lda   #$20
L1D2F    lbra  L0B1A
L1D32    bsr   L1D2F
         tfr   b,a
L1D36    lbra  L0AFC
L1D39    tfr   u,d
L1D3B    bsr   L1D4E
         bcs   L1D4D
L1D3F    lslb
         rola
         bcs   L1D4D
         std   <u006C
         ldd   <u001E
         subd  <u006C
         bcc   L1D4D
         clra
         clrb
L1D4D    rts
L1D4E    std   <u006C
         mul
         addb  <u006C
         adca  #$00
         addb  <u006D
         adca  #$00
         addd  #$0001
         rts
L1D5D    lbsr  L50C1
         lbcs  L2333
         stu   <u00F8
         ldd   <u00F8
         subb  <u00C0
         bls   L1DA0
         stb   <u00F1
         ldd   <u00BF
         std   <u00FD
         ldb   <u00F9
         stb   <u00C0
         ldd   <u00BF
         bsr   L1D3B
         bsr   L1DC4
         lda   <u00FD
L1D7E    ldb   <u00F1
         ldx   <u00DA
L1D82    stx   ,y++
         decb
         bne   L1D82
         sta   <u00FD
         beq   L1DA0
         ldb   <u00FE
         bsr   L1D3B
         tfr   d,x
         lda   <u00FE
         inca
L1D94    ldu   ,x++
         stu   ,y++
         deca
         bne   L1D94
         lda   <u00FD
         deca
         bra   L1D7E
L1DA0    ldu   <u00F8
         ldd   <u00F8
         suba  <u00BF
         bls   L1DC3
         deca
         ldb   <u00C0
         bsr   L1D4E
         lslb
         rola
         pshs  b,a
         ldd   <u00C5
         subd  ,s++
         bsr   L1DC4
         clra
         clrb
L1DB9    std   ,--x
         cmpx  <u00C5
         bhi   L1DB9
         tfr   u,d
         sta   <u00BF
L1DC3    rts
L1DC4    tfr   d,y
         ldx   <u00C5
         sty   <u00C5
         rts
L1DCC    tfr   u,d
         ldx   <u00DA
         pshs  y
         cmpb  <u00C0
         bhi   L1DDA
         cmpa  <u00BF
         bls   L1DDD
L1DDA    clrb
         puls  pc,y
L1DDD    stb   <u006D
         clrb
         stb   <u006C
         tsta
         beq   L1DEC
         sta   <u0067
         ldb   <u00C0
         mul
         addd  <u0066
L1DEC    addd  <u006C
         addd  #$0001
         lbsr  L1D3F
         std   <u006C
         tfr   d,y
         ldx   ,y
         beq   L1DDA
         clrb
         decb
         lbsr  L50B8
         puls  pc,y
L1E03    ldy   <u006C
         beq   L1E10
L1E08    ldd   ,x++
         std   ,u++
         leay  -$01,y
         bne   L1E08
L1E10    tst   <u007D
         beq   L1E18
         lda   ,x
         sta   ,u+
L1E18    rts
L1E19    ldx   <MEMPTR
         leax  >$0400,x
         stx   <u0089
         lda   #$FF
         sta   <u0033
         ldu   <u006E
         lbsr  L0033
         tst   <u00AE
         beq   L1E32
         clr   <u0074
         ldx   <u0089
L1E32    ldu   <MEMPTR
         lbsr  L2CB5
         clr   <u00AE
         lda   <u001C
         anda  #$EF
         ldb   #$08
L1E3F    pshs  b,a
         ldb   <u00BC
         orb   <u0091
         bne   L1E78
         tst   <u0080
         beq   L1E78
         eora  <u001C
         bita  #$10
         bne   L1E69
         lda   ,s
         bita  #$10
         bne   L1E78
         ldu   <u007E
         lda   ,u
         cmpa  #$0A
         bne   L1E65
         tst   <u0074
         beq   L1E78
         bra   L1E69
L1E65    tst   <u0074
         bne   L1E78
L1E69    tst   <u0090
         beq   L1E78
         leau  >L2C24,pcr
         lbsr  L23DC
         lbne  L1EF3
L1E78    puls  b,a
         sta   <u001C
         addb  #$02
         addb  <u0074
L1E80    stb   <u00FF
         lbsr  L50C4
         lda   <u00FF
         ldb   <u001C
         andb  #$D7
         std   ,x++
         tst   <u00BC
         bmi   L1ECD
         bitb  #$10
         bne   L1E9C
         ldu   <MEMPTR
         lbsr  L2CBB
         leax  $08,x
L1E9C    ldu   <u0089
         lda   <u0074
         beq   L1EC5
         tst   <u00BC
         beq   L1EAC
         tst   <u008B
         lbeq  L1F0F
L1EAC    clr   <u007D
         lsra
         ror   <u007D
         sta   <u0025
         beq   L1EBD
L1EB5    ldd   ,u++
         std   ,x++
         dec   <u0025
         bne   L1EB5
L1EBD    tst   <u007D
         beq   L1EC5
         ldb   ,u+
         stb   ,x+
L1EC5    tst   <u0091
         bne   L1ECD
         tst   <u00BC
         beq   L1ECE
L1ECD    rts
L1ECE    clr   <u00C8
         lbsr  L3C73
         ldx   <u007E
         lbsr  L0021
         tst   <u00B6
         bne   L1EE2
         lbsr  L0027
         lbsr  L0AE1
L1EE2    bsr   L1F43
         sta   <u0080
         lda   <u0088
         cmpa  #$0D
         bne   L1EFB
         lda   <u00E3
         bne   L1EFD
         lbsr  L1F53
L1EF3    lds   <u0034
         lbsr  L257A
         jmp   [,s]
L1EFB    sta   <u00E3
L1EFD    lbra  L1FD0
L1F00    leas  $02,s
L1F02    tfr   x,d
         stu   <u006C
         subd  <u006C
         tfr   b,a
         ldx   <u00AF
         lbra  L1EAC
L1F0F    stx   <u00AF
         ldx   <MEMPTR
         leax  <$20,x
         pshs  x
         tfr   u,x
         tfr   a,b
         abx
         stx   <u0051
         ldx   <MEMPTR
         ldd   <$64,x
         subd  <u006E
         std   <u00F2
         leax  -u0001,u
L1F2A    lbsr  L41E7
         bcc   L1F00
         bsr   L1F02
         ldd   ,u++
         tst   [,s]
         bne   L1F39
         subd  <u00F2
L1F39    std   ,x++
         inc   $01,s
         stx   <u00AF
         tfr   u,x
         bra   L1F2A
L1F43    ldx   #$0104
         lbsr  L0AAE
L1F49    lbra  L50B5
L1F4C    bsr   L1F43
         ldu   <u0068
         lbra  L2004
L1F53    lda   <u000E
         inca
         sta   <u0079
         sta   <u0078
         lda   #$80
         sta   <u008D
         lbsr  L0AB7
         ldy   <u007E
         beq   L1F6D
         lbsr  L0AB1
         lda   <u0079
         beq   L1F70
L1F6D    lbsr  L20E5
L1F70    rts
L1F71    ldx   #$0100
         lbsr  L0AAE
         ldb   #$2F
         lda   #$43
         tst   <u00B5
         beq   L1F81
         lda   #$52
L1F81    lbsr  L1D32
         lda   #$41
         tst   <u00B6
         beq   L1F8C
         lda   #$4D
L1F8C    ldb   #$20
         lbsr  L1D32
         bra   L1F49
L1F93    lda   <u00ED
         beq   L1F9D
         ldx   <MEMPTR
         jmp   >$0608,x
L1F9D    inca
         sta   <u00EF
         lbsr  L3C6A
         tst   <u00BC
         bpl   L1FAA
         lbsr  L20D6
L1FAA    com   <u0054
         ldu   <u006E
         bsr   L2006
         bsr   L1F43
         leau  >L2C57,pcr
         lbra  L2337
L1FB9    stu   <u006E
         lbsr  L1DCC
         lbsr  L50CD
         stx   <u007E
         stb   <u0080
         beq   L1FCB
         ldb   $01,x
         andb  #$1F
L1FCB    clr   <u0077
         stb   <u001C
         rts
L1FD0    ldx   <u006E
         stx   <u0070
         clr   <u0061
         sta   <u0075
         lbra  L0AAB

L1FDB    leau  >L2C03,pcr
         lbsr  L22AD
         com   <u009A
         lbsr  L0030
         tfr   d,u
L1FE9    ldx   <u00A2
         cmpa  $0A,x
         bcs   L1FF3
         cmpb  $0B,x
         bcc   L2004
L1FF3    leau  >L218F,pcr
         lbra  L233A
L1FFA    ldu   <u00A2
         ldu   u000A,u
         bra   L2004
L2000    ldu   <u0070
         clr   <u00D5
L2004    clr   <u0054
L2006    bsr   L1FB9
         tst   <u0080
         bne   L2014
         lbsr  L0AB7
         lbsr  L20E5
         bra   L2017
L2014    lbsr  L1F53
L2017    ldy   <u00A2
         lda   #$FF
         sta   <u00D7
         ldu   <u006E
L2020    stu   $02,y
L2022    lbsr  L288F
         bne   L204F
         inc   <u0015
L2029    tst   <u00D6
         bne   L203F
         lbsr  L257A
         clr   <u0060
         ldx   <u00A2
         ldx   -$04,x
         lbsr  L0AAE
         ldb   #$FF
         tst   <u0054
         beq   L2040
L203F    rts
L2040    stb   <u00D5
         tst   <u00AB
         beq   L204C
         tst   <u0077
         lbeq  L2A51
L204C    lbra  L1EF3
L204F    stu   $0D,y
         ldd   -$06,y
         std   -$04,y
         clrb
         stb   <u00D7
L2058    clr   -$06,y
         lda   $0D,y
         comb
         suba  ,y
         bcs   L206F
         suba  -$02,y
         bcc   L207E
         lda   #$04
         anda  -$04,y
         sta   -$06,y
         lda   ,y
         sta   $0D,y
L206F    leay  $01,y
         tstb
         bmi   L2058
         leay  -$02,y
         ldu   $0D,y
         bsr   L20A8
         stu   ,y
         bra   L2029
L207E    tstb
         bmi   L208A
         lda   $0D,y
         suba  -$02,y
         inca
         sta   $0D,y
         bra   L206F
L208A    lda   $0F,y
         sta   <u00B3
         sta   <u0094
         inc   $0D,y
L2092    lda   $0D,y
         deca
         lbsr  L2517
         bcs   L20A0
         dec   $0D,y
         clr   <u00B3
         bra   L2092
L20A0    tst   <u00B3
         beq   L206F
         dec   $0D,y
         bra   L206F
L20A8    ldd   <u0097
         beq   L20D6
L20AC    pshs  u,x
         ldd   -$06,y
         pshs  y,b,a
         stb   <u0025
         ora   <u0025
         bne   L20C2
         tst   -$0B,y
         bne   L20C2
         ldb   #$F0
         stb   -$0B,y
         stb   -$0D,y
L20C2    ldb   #$FF
         stb   -$07,y
         clr   <u0015
         clra
         lbsr  L2587
         puls  y,b,a
         clr   -$0D,y
         clr   -$0C,y
         std   -$06,y
         puls  pc,u,x
L20D6    pshs  u,x
         ldx   #$0300
         lbsr  L0AAE
         clr   <u00AC
         lbsr  L1C70
         puls  pc,u,x

L20E5    pshs  u
         lbsr  L1C6D
         lda   #$04
         puls  pc,u

CMDSTR    fcc "CM"
L20F0    fcb $00

         fcb   'A
         fdb  L2206-L1C85    $0581
         fcb 'B,$06,$FC
         fcb 'C,$07,$45
         fcb 'D,$25,$60
         fcb 'E,$07,$8E
         fcb 'F,$0C,$4D
         fcb 'I,$25,$60
         fcb 'K,$06,$3D
         fcb 'L,$25,$65
         fcb 'M,$25,$60
         fcb 'P,$2C,$BB
         fcb 'Q,$05,$66
         fcb 'R,$25,$60
         fcb 'S,$05,$72
         fcb 'T
         fdb L21FD-L1C85   $0578
         fcb 'W,$05,$87
         fcb '?,$80

L2123    fcc  "Attr"
         fcb 0

         fcb $42,$06,$79,$44,$E3,$A8,$47,$0E,$DC
         fcb $48,$06,$1C,$4C,$06,$8F,$4D,$08,$EB
         fcb $4F,$06,$F4,$50,$2C,$B0,$52,$06,$F0
         fcb $53,$25,$60,$54,$06,$85,$57,$05,$6C,$3F,$82

L214E    fcc   "Formats"
         fcb   0

L2156    fcb $44,$0C,$9E,$47,$0C,$9E,$52,$0C,$9E
         fcb $4C,$0C,$9E,$50,$0C,$9E,$49,$0C,$9E,$24,$0C,$9E,$43,$0C,$9E,$3F,$88

L2170    fcc  "Windows"
         fcb 0

L2178    fcb $44,$06,$98,$46,$0C,$68,$48,$0C,$C2
         fcb $4E,$0D,$A7,$53,$0D,$CC,$55,$0D,$EC,$56,$0C,$DB,$3F,$8A

L218F    fcc   " In "
L2193    fcc   "Titles"
         fcb 0
         fcb 'B,$0D,$2F
         fcb $48,$0D,$31
         fcb $4E,$0D,$67
         fcb $56,$0D,$33
         fcb $3F,$8C

L21A8    fcc   "System"
         fcb   $00

         fcb   'C,$0F,$16,$4C,$1F,$D3,$53,$1F,$D0,$58,$1F,$DC,$23,$2C,$B0,$3F,$8E

L21C0    fcc   "Column width"
         fcb   $00

         fcb   $43,$0D,$F1,$57,$0E,$AE,$3F,$90

L21D5    fcc   "Quit"
         fcb   $00

         fcb   $4F,$07,$1E,$53,$07,$3C,$3F,$92

L21E2    ldx   #$010B
         lbsr  L2402
         sta   <u0092
         rts

L21EB    leau  >L21D5,pcr
         bra   L221F

L21F1    leau  >L21C0,pcr
         bra   L221F

L21F7    leau  >L21A8,pcr
         bra   L221F

L21FD    leau  >L2193,pcr    "Titles"
         ldy   <u00A2
         bra   L221F

L2206    leau  >L2123,pcr   Attributes
         bra   L221F

L220C    leau  >L2170,pcr   Windows
         bra   L221F

L2212    lbsr  L22BB
         lda   -$05,x
         ldb   -$01,x
         std   -$06,x
         leau  >CMDSTR,pcr
L221F    bsr   L21E2
         sta   <u009A
         clr   <u00E3
L2225    lbsr  L2450
         stu   <u008E
         lda   #$3A
         ldb   #$20
         lbsr  L1D32
L2231    lda   ,u
         cmpa  #$3F
         bne   L223B
         tst   <u001D
         bne   L223E
L223B    lbsr  L1D2F
L223E    leau  u0003,u
         cmpa  #$3F
         bne   L2231
         lbsr  L22B2
         lbsr  L3C73
L224A    lbsr  L0AE4
         clrb
         ldx   <u008E
L2250    cmpa  ,x+
         bne   L226C
         cmpa  #$3F
         beq   L227B
         tfr   x,u
         pshs  pc,b,a
         ldd   ,x
         leax  >L1C85,pcr
         pshs  x
         addd  ,s++
         tfr   u,x
         std   $02,s
         puls  pc,b,a
L226C    incb
         leax  $02,x
         tst   -$02,x
         bpl   L2250
         ldb   -$03,x
         cmpb  #$3F
         bne   L2250
         bra   L224A
L227B    tst   <u001D
         bne   L2287
         ldu   <u001E
         pshs  u
         jsr   [,s++]
         bra   L224A
L2287    leau  >L2296,pcr   String 'helps not available'
         lbsr  L2450  output string pointed to in U
         lbsr  L2355
         lbsr  L0B05
         bra   L224A

L2296    fcc   "HELPS OFF."
         fcb   0

L22A1    tst   <u001D  help texts discarded?
         lbne  L237E
         ldu   <u001E
         leau  u0003,u
         tfr   u,pc

L22AD    bsr   L22B5
         lbra  L3C5E
L22B2    lbsr  L20E5
L22B5    ldx   #$0200
         lbra  L0AAE
L22BB    ldx   <MEMPTR
         leax  >$0600,x
         rts
         bsr   L22BB
         com   -$05,x
         tst   -$04,x
         bne   L22EB
         ldb   -$06,x
         bmi   L22E8
         stb   -$05,x
         leau  >L2BF4,pcr
         lbsr  L3C5E
         lbsr  L2B13
         bsr   L22BB
         lda   -$01,x
         sta   -$03,x
         tst   -$05,x
         bmi   L22E8
         stb   -$04,x
         bne   L22F3
L22E8    lbra  L1EF3
L22EB    lda   -$03,x
         sta   -$01,x
         dec   -$04,x
         beq   L22E8
L22F3    lda   -$06,x
         deca
         bpl   L22FA
         lda   #$7F
L22FA    sta   -$01,x
         bra   L22E8
         ldx   #$0193
         leau  >L2BFB,pcr
         ldb   <u0006
         lbra  L0039
         ldx   #$0190
         leau  >L2C0B,pcr
L2311    lbra  L0036
         ldx   #$01E8
         leau  >L2C17,pcr
         bra   L2311
         ldb   <u00A3
         lda   #$05
         ldx   #$FFF2
         leax  d,x
         leau  >L2C32,pcr  String 'Formula dump'
         com   <u00E1
         bsr   L2311
         clr   <u00E1
         lbra  L2570
L2333    leau  >L2C40,pcr
L2337    lbsr  L21E2
L233A    lbsr  L2450
         lbsr  L2405
L2340    bsr   L2355
         tst   <u00E1
         beq   L2347
         rts
L2347    tst   <u00BC
         beq   L237E
         clr   <u0091
         lbsr  L0027
         bra   L237E
L2352    clra
         bra   L2357

L2355    lda   #$01
L2357    pshs  y,a
         lbsr  L3C73
         ldy   #$0800
L2360    ldx   #$0001
         os9   F$Sleep
         lbsr  L0AE7   Read character
         bne   L2373
         tst   ,s
         beq   L2360
         leay  -$01,y
         bne   L2360
L2373    puls  pc,y,a

         com   <u00B6
         bra   L237B

         com   <u00B5  Row or column mode
L237B    lbsr  L1F71
L237E    lbra  L1EF3

* Attributes B
         tst   <u0080
         beq   L237E
         leau  >L2C82,pcr  "Blank cell"
         bsr   L23DC
         bne   L237E
L238D    lda   #$0D
         sta   <u0088
         lda   <u001C
         ora   #$10
         clrb
         stb   <u0074
         sta   <u00AE
         lbra  L1E3F

L239D    fcc   "Clear"
         fcb   0

         fcb   $33
         fcb   $8D,$FE,$2E,$8D,$33,$26,$D3
L23AB    fcb   $0F
         std   $0F,x
         ldu   -$09,x
         stb   -u0010,u
         lbsr  L3C6D
         lda   #$A0
         lbsr  L0B1D
         clrb
         lbsr  L3C73
         os9   F$Exit

         lbsr  L0B02
         lbsr  L0AF9
         lbra  L0AA8

         leau  >L239D,pcr   "Clear worksheet"
         bsr   L23DC
         lbeq  L0AA5
         bra   L237E

L23D6    leau  >L23F5,pcr
         bra   L23E5

L23DC    lbsr  L22B5
         bsr   L2450  output string pointed to in U
         leau  >L23F2,pcr
L23E5    bsr   L2450  output string pointed to in U
         lbsr  L20E5
         sta   <u009A
         lbsr  L0AE4
         cmpa  #$59
         rts

L23F2    fcc   ": A"
L23F5    fcc   "re you sure?"
         fcb   $00

L2402    lbsr  L0AAE
L2405    lbra  L20E5

L2408    lda   #$20
         bra   L240F

L240C    lbsr  L1D2F  output char in a
L240F    decb
         bpl   L240C
         rts

* Attribute E
         tst   <u0080
         lbeq  L237E
         tst   <u00CD
         bne   L2420
         lbsr  L1F53
L2420    lbsr  L21E2
         leau  >L2BC3,pcr
         bsr   L2450  output string pointed to in U
         leau  >L2BCB,pcr
         ldx   <u007E
         ldb   ,x
         cmpb  #$02
         beq   L245A
         ldb   $01,x
         bitb  #$10
         beq   L2443
         stb   <u008B
         clr   <u009A
         leau  >L2BD1,pcr
L2443    bsr   L2450  output string pointed to in U
         lbsr  L22B2
         clr   <u00CD
         lbra  L0AC6

L244D    lbsr  L1D2F  output char in a
L2450    lda   ,u+
         bne   L244D
         lbra  L3C73

L2457    lbsr  L257A
L245A    lbra  L1EF3

L245D    bne   L2461
L245F    ldb   <u000E
L2461    subb  #$04
         stb   <u0094
L2465    rts

L2466    ldu   $04,y
         stu   ,y
         stu   $02,y
         clra
         clrb
         std   $06,y
L2470    lda   #$C4   Location of reverse on
L2472    bsr   L24E0
         lbsr  L255F
         ldb   <u0098
         bsr   L245D
         lda   #$03
         sta   <u0075
         clr   <u0078
L2481    sta   <u00BD
         clr   <u00BE
L2485    lda   -$06,y
         anda  <u00AC
         bne   L24BD
         lbsr  L0AC9
         ldb   #$04
         lbsr  L2408
         lda   $06,y
         beq   L24A1
         sta   <u0096
         lda   $04,y
         sta   <u0070
         bsr   L24E3
         bne   L2466
L24A1    lda   <u0094
         cmpa  #$03
         bcs   L2466
         sta   $0F,y
         tst   <u009B
         bne   L2465
         lda   ,y
         sta   <u0070
         clr   -$02,y
         clr   <u0096
         bsr   L24E3
         ldb   <u0021
         beq   L24BD
         bsr   L2514
L24BD    cmpy  <u004D
         bne   L24DE
         ldy   <u004F
         lda   <u0098
         bne   L24D3
         lda   <u0097
         beq   L24DE
         bsr   L245F
         adda  #$04
         bra   L2481

L24D3    sta   <u00BE
         ldb   <u000E
         subb  <u0098
         lbsr  L2461
         bra   L2485

L24DE    lda   #$CC   Location of reverse off
L24E0    lbra  L0B1D

L24E3    clr   -$02,y
L24E5    lda   <u0070
         bsr   L2517
         bcc   L24F3
         tst   -$02,y
         bne   L2510
         clr   <u0096
         clr   <u0094
L24F3    inc   -$02,y
         bsr   L2542
         lda   #$5B
         lbsr  L1D2F  output char in a
         bsr   L2511
         lbsr  L0ACC
         ldb   <u0099
         bsr   L2511
         lda   #$5D
         lbsr  L1D2F
         inc   <u0070
         dec   <u0096
         bne   L24E5
L2510    rts
L2511    decb
         beq   L2510
L2514    lbra  L2408

L2517    clr   <u00BA
         ldx   <MEMPTR
         leax  >$0580,x
         stx   <u0046
L2521    ldb   ,x+
         beq   L252D
         cmpa  ,x+
         bne   L2521
         com   <u00BA
         subb  $08,y
L252D    addb  $08,y
         stb   <u0021
         stb   <u0020
         ldb   <u0094
         subb  <u0021
         bcc   L253F
         lda   <u0094
         sta   <u0020
         sta   <u0021
L253F    stb   <u0094
         rts
L2542    ldb   <u0021
         lsrb
         decb
         stb   <u0025
         adcb  #$00
         stb   <u0099
         lda   <u0070
         suba  #$1A
         bcc   L255C
         inc   <u0099
         cmpb  <u0025
         beq   L255C
         stb   <u0025
         dec   <u0099
L255C    ldb   <u0025
         rts
L255F    ldy   <MEMPTR
         leay  >$0530,y
         sty   <u004F
         leay  <-$20,y
         sty   <u004D
         rts
L2570    clr   <u00AC
         lbsr  L1C70
         lbra  L2457
L2578    leas  $04,s
L257A    lbsr  L1D12
         lbsr  L50CD
         tst   <u009B
         bne   L2587
         lbsr  L2470
L2587    clra
         bsr   L255F
         ldb   #$01
         stb   <u0075
         sta   <u00BE
L2590    sta   <u0095
         ldb   <u0097
         bne   L259A
         ldb   <u000D
         subb  #$04
L259A    stb   <u009E
         ldb   #$03
         stb   <u00BD
L25A0    clr   <u00FE
         lda   <u00AC
         anda  -$05,y
         sta   -$05,y
         lda   $07,y
         beq   L25B6
         sta   <u00A1
         ldb   $05,y
         stb   <u00F9
         bsr   L25FF
         beq   L25F1
L25B6    lda   <u009E
         sta   -$01,y
         lda   $01,y
         sta   <u00F9
         clr   <u00A1
         com   <u00FE
         bsr   L25FF
         lda   #$04
         sta   -$06,y
         sta   -$05,y
         ldb   -$0B,y
         andb  -$07,y
         stb   -$0B,y
         lda   #$F0
         sta   -$0D,y
         clr   -$07,y
         cmpy  <u004F
         beq   L25F1
         ldy   <u004F
         lda   <u0097
         beq   L25ED
         suba  <u000D
         coma
         suba  #$04
         sta   <u009E
         inc   <u00BD
         bra   L25A0
L25ED    lda   <u0098
         bne   L2590
L25F1    lda   #$FF
         sta   <u00AC
         clr   <u00C7
         clr   <u0015
         lbsr  L50D0
         lbra  L3C73
L25FF    tst   <u00E0
         beq   L2606
         lbsr  L4937
L2606    clr   <u009D
         clr   <u007D
         lda   -$05,y
         adda  <u0095
         sta   <u00BE
         inc   <u00BD
         tst   <u009B
         bne   L2654
         tst   -$05,y
         bne   L2654
         ldb   <u00D5
         andb  -$07,y
L261E    beq   L2626
         adda  #$04
         sta   <u00BE
         bra   L2654
L2626    clr   <u0078
         lbsr  L0AC9
         sta   <u007D
         lda   #$C4
         lbsr  L0B1D
         lda   <u00F9
         sta   <u0071
         cmpa  #$62
         bhi   L2644
         ldb   #$01
         cmpa  #$08
         bhi   L2641
         incb
L2641    lbsr  L2408
L2644    ldb   #$04
         lbsr  L2750
         lbsr  L0AC3
         lda   #$2D
         lbsr  L1D2F
         lbsr  L24DE
L2654    lda   <u00FE
         coma
         ora   -$05,y
         sta   <u00A4
         clr   <u00FD
         lda   $06,y
         beq   L266F
         sta   <u00A8
         sta   <u0096
         lda   #$80
         sta   <u0094
         lda   $04,y
         sta   <u00F8
         bsr   L2696
L266F    clr   <u00A8
         lda   $0F,y
         sta   <u0094
         com   <u00FD
         lda   ,y
         sta   <u00F8
         lda   <u00A4
         anda  -$06,y
         sta   <u00A4
         lda   -$02,y
         sta   <u0096
         bsr   L2696
         inc   <u00F9
         dec   <u009E
         beq   L2695
         dec   <u00A1
         lbne  L25FF
         dec   <u00A1
L2695    rts
L2696    lda   <u00F8
         lbsr  L2517
         ldu   <u00F8
         cmpu  $02,y
         bne   L26B5
         cmpy  <u00A2
         bne   L26B5
         ldb   <u009D
         addb  <u00BE
         lda   <u00BD
         std   -$04,y
         std   -$0A,y
         ldb   <u0020
         stb   -$08,y
L26B5    tst   <u0015
         bne   L26D4
         lbsr  L1DCC
         beq   L26D4
         stb   <u00C7
         leax  $01,x
         lda   ,x
         tst   <u00A4
         beq   L26DC
         tst   <u00AC
         beq   L26DC
         tst   -$07,y
         bne   L26D4
         bita  #$20
         beq   L26DC
L26D4    ldb   <u009D
         addb  <u0020
         stb   <u009D
         bra   L26FA
L26DC    ldb   <u0097
         orb   <u0098
         beq   L26EC
         cmpy  <u004F
         beq   L26EC
         lbsr  L2897
         beq   L26F0
L26EC    ora   #$20
         sta   ,x
L26F0    anda  #$07
         bne   L26F6
         ora   $09,y
L26F6    sta   <u0022
         bsr   L2755
L26FA    inc   <u00F8
         beq   L2702
         dec   <u0096
         bne   L2696
L2702    tst   <u00A8
         bne   L274D
         lbsr  L0AE7
         beq   L274D
         incb
         lda   b,x
         cmpa  <u0000  Up-arrow
         beq   L271E
         cmpa  <u0001  Down-arrow
         beq   L271E
         cmpa  <u0002  Left-arrow
         beq   L271E
         cmpa  <u0003
         bne   L274D
L271E    ldb   -$07,y
         orb   <u00D5
         bne   L274D
         cmpy  <u00A2
         bne   L274D
         clr   <u00C7
         lda   <u0054
         com   <u00D6
         ldx   <u00BD
         pshs  u,x,a
         lbsr  L0AE4
         lbsr  L1FD0
         clr   <u00D6
         clr   <u0015
         puls  u,x,a
         sta   <u0054
         stx   <u00BD
         lda   <u00D7
         lbeq  L2578
         clr   <u004A
         clr   <u0078
L274D    rts
L274E    ldb   <u0020
L2750    addb  <u00BE
         stb   <u00BE
         rts
L2755    ldu   -$0D,y
         bne   L2760
         tst   -$07,y
         beq   L2760
         leas  $02,s
         rts
L2760    ldb   <u009D
         beq   L2779
         tst   <u00E0
         beq   L2770
L2768    lbsr  L1D2D
         decb
         bne   L2768
         bra   L2775
L2770    bsr   L2750
L2772    lbsr  L0AC9
L2775    sta   <u007D
         clr   <u009D
L2779    tst   <u007D
         beq   L2772
         bsr   L274E
         tst   -$07,y
         beq   L278A
         leau  -u0001,u
         stu   -$0D,y
         lbra  L27E9
L278A    leau  u0001,u
         stu   -$0D,y
L278E    lda   ,x
         bita  #$10
         bne   L27E3
         tst   -$0E,y
         beq   L27B5
         pshs  y
         lda   <u0020
         sta   <u00E1
         deca
         sta   <u0079
         clr   <u00C7
         leay  -$01,x
         lbsr  L1D2D
         lbsr  L0AB1
         clr   <u00CD
         clr   <u00E1
         ldb   <u0079
         bsr   L27EB
         puls  pc,y
L27B5    bita  #$08
         bne   L27CF
         ldu   <MEMPTR
         leax  $01,x
         lbsr  L2CB5
         clr   <u004B
         clr   <u004A
         pshs  y
         leay  >u0550,u
         lbsr  L2CB8
         puls  pc,y
L27CF    lda   $01,x
         bmi   L2847
         leau  >L2BD8,pcr
         cmpa  #$19
         beq   L27E1
         leau  u0007,u
         cmpa  #$1A
         bne   L281E
L27E1    tfr   u,x
L27E3    ldb   -$01,x
         subb  #$02
         bne   L27EE
L27E9    ldb   <u0020
L27EB    lbra  L2408
L27EE    lda   <u0022
         cmpa  #$07
         beq   L285D
         clr   <u0025
         subb  <u0020
         bcc   L280B
         negb
         stb   <u0025
         cmpa  #$02
         bne   L2805
         clr   <u0025
         bsr   L27EB
L2805    ldb   -$01,x
         subb  #$02
         stb   <u0020
L280B    ldb   <u0020
         leax  $01,x
L280F    lda   ,x+
         lbsr  L1D2F
         decb
         bne   L280F
         ldb   <u0025
         beq   L281D
         bsr   L27EB
L281D    rts
L281E    ldb   <u0020
         subb  #$04
         lsrb
         stb   <u0020
         adcb  #$00
         bsr   L27EB
         lda   #$3E
         lbsr  L1D2F
         lda   $01,x
         cmpa  #$0C
         bls   L2836
         lda   #$0C
L2836    lsla
         leau  >L2875,pcr
         ldd   a,u
         lbsr  L1D32
         lda   #$3C
         lbsr  L1D2F
         bra   L27E9
L2847    ldu   $02,x
         lbsr  L1DCC
         ldd   ,x+
L284E    bitb  #$08
         lbeq  L278E
         tst   $01,x
         bpl   L281E
         leax  <L284E,pcr
         bra   L281E
L285D    leax  $01,x
         stx   <u006C
L2861    ldb   -$02,x
         subb  #$02
L2865    lda   ,x+
         lbsr  L1D2F
         dec   <u0020
         beq   L281D
         decb
         bne   L2865
         ldx   <u006C
         bra   L2861

L2875    fcc   "NAD0SNRNOVNRLNEXREAELGHOER"

L288F    pshs  y,b,a
         lda   #$FF
         sta   <u007C
         bra   L28A2
L2897    pshs  y,b,a
         leay  <$20,y
         bra   L28A0
         pshs  y,b,a
L28A0    clr   <u007C
L28A2    stu   $0D,y
         ldb   #$FE
L28A6    lda   $06,y
         beq   L28BA
         tst   <u007C
         bne   L28BA
         adda  $04,y
         cmpa  $0D,y
         bls   L28BA
         lda   $04,y
         cmpa  $0D,y
         bls   L28C7
L28BA    lda   ,y
         cmpa  $0D,y
         bhi   L28CE
         adda  -$02,y
         deca
         cmpa  $0D,y
         bcs   L28CE
L28C7    leay  $01,y
         incb
         stb   <u0025
         bne   L28A6
L28CE    stb   <u0025
         puls  pc,y,b,a
         ldu   <MEMPTR
         leay  >u0113,u
         bsr   L28F8
         tst   <u0080
         lbeq  L238D
         ldx   <u007E
         lda   $01,x
         anda  #$D8
         ora   <u0025
         sta   $01,x
L28EA    lbra  L1EF3
         ldy   <u00A2
         inc   <u00E1
         bsr   L28FC
         com   <u00AC
         bra   L28EA
L28F8    tst   <u0080
         beq   L2919
L28FC    lbsr  L22B5
         leau  >L2C98,pcr
         lbsr  L2450
         ldb   $09,y
         leax  >L2156,pcr
         andb  #$07
         lda   #$03
         mul
         lda   b,x
         lbsr  L1D36
         lbsr  L1D2B
L2919    lbsr  L21E2
         leau  >L214E,pcr
         lbra  L2225
         lda   $09,y
         anda  #$F8
         stb   <u0025
         ora   <u0025
         sta   $09,y
         rts
L292E    ldd   <u0097
         bne   L29AD
         ldu   <MEMPTR
         leay  >u0510,u
         leau  <$10,y
         lda   #$20
L293D    clr   ,u+
         deca
         bne   L293D
         ldd   $08,y
         std   -u0008,u
         rts
         bsr   L292E
         ldb   -$04,y
         incb
         cmpb  <u000D
         bcc   L29AD
         subb  #$05
         bls   L29AD
         stb   <u0083
         lda   ,y
         ldb   $03,y
         cmpb  $01,y
         bls   L29AD
         bra   L2980
         bsr   L292E
         ldb   -$03,y
         beq   L29AD
         stb   <u0083
         subb  <u000E
         negb
         subb  #$03
         stb   <u0094
         lda   $02,y
         lbsr  L2517
         bcs   L29AD
         lda   $02,y
         cmpa  ,y
         beq   L29AD
         ldb   $01,y
         leay  $01,y
L2980    ldu   <MEMPTR
         leau  >u0530,u
         std   ,u
         lda   $06,y
         sta   <$26,y
         lda   $04,y
         sta   <$24,y
         lda   $0A,y
         sta   <$2A,y
         ldb   <u0083
         stb   >-$0379,y
         leax  <-u0020,u
         stu   <u00A2
         ldd   $02,x
         std   u0002,u
         ldd   ,x
         std   $02,x
         lbra  L2570
L29AD    leau  >L2BE8,pcr
         lbra  L233A
         bsr   L29CA
         leay  $01,y
         bsr   L29CA
L29BA    ldy   <u00A2
         clr   -$06,y
         lbsr  L2470
         ldy   <u00A2
         com   -$06,y
L29C7    lbra  L1EF3
L29CA    tst   $06,y
         bne   L29AD
         lda   $02,y
         suba  ,y
         beq   L29AD
         sta   $06,y
         suba  -$02,y
         nega
         sta   -$02,y
         lda   ,y
         sta   $04,y
         lda   $02,y
         sta   ,y
         ldu   <u00A2
         ldd   u0004,u
         addd  u0006,u
         std   u000A,u
         rts
         ldu   <u00DA
         ldd   $06,y
         stu   $06,y
         ldx   $0A,y
         stu   $0A,y
         cmpx  ,y
         bne   L2A04
         ldu   $04,y
         stu   ,y
         addd  -$02,y
         std   -$02,y
         bra   L29BA
L2A04    stu   -$06,y
         lbra  L2570
L2A09    ldd   <u00A2
         cmpb  #$30
         bne   L2A11
         ldb   #$F0
L2A11    addb  #$20
         tfr   d,y
         rts
L2A16    ldu   <u0097
         beq   L29C7
         bsr   L2A09
         stb   <u00A3
         ldu   $02,y
         lbsr  L288F
         beq   L2A29
         ldu   ,y
         stu   $02,y
L2A29    lbra  L2004
         ldb   <u00A3
         cmpb  #$10
         beq   L2A48
         ldu   <MEMPTR
         leau  >u0520,u
         leax  <-u0020,u
         ldb   #$20
L2A3D    lda   b,u
         sta   b,x
         decb
         bne   L2A3D
         ldb   #$10
         stb   <u00A3
L2A48    clr   <u0098
         clr   <u0097
         clr   <u00AB
         lbra  L2570
L2A51    ldu   <u00A2
         bsr   L2A09
         tfr   d,x
         sta   <u0077
         ldd   <u0097
         beq   L2A73
         tstb
         beq   L2A64
         leau  u0001,u
         leax  $01,x
L2A64    lda   u0002,u
         sta   $02,x
         ldu   $02,y
         lda   #$FF
         sta   <u00AB
         lbra  L2022
         clr   <u00AB
L2A73    lbra  L1EF3
         ldb   #$43
         bsr   L2AE2
         lda   <u006E
         lbsr  L2517
         lda   -$02,x
         stx   <u00B8
         ldx   <u0046
         leau  <$40,x
         stu   <u0046
L2A8A    tst   ,x++
         bne   L2A8A
         stx   <u00B1
         tst   <u00BA
         beq   L2A98
         bsr   L2AFB
         bra   L2AA3
L2A98    lda   #$44
         lbsr  L0ACF
         clr   ,x
         stx   <u00B8
         bsr   L2AF7
L2AA3    beq   L2AC3
         ldx   <u00B8
         cmpx  <u0046
         bcs   L2AB4
         leau  >L2C74,pcr
         bsr   L2AF4
         lbsr  L2340
L2AB4    lda   <u006E
         sta   -$01,x
         stb   -$02,x
L2ABA    ldx   <u00A2
         lda   <u006E
         sta   ,x
         lbra  L2570
L2AC3    tst   <u00BA
         beq   L2A73
         ldx   <u00B8
         leax  -$02,x
         leay  $02,x
L2ACD    ldu   ,y++
         stu   ,x++
         cmpx  <u00B1
         bcs   L2ACD
         clr   ,x
         bra   L2ABA
L2AD9    leau  >L2BE6,pcr
         bsr   L2AF4
         lbra  L2340
L2AE2    ldx   #$0119
         lbsr  L0AAE
         tfr   b,a
         lbsr  L1D2F
         lbsr  L22B2
         leau  >L2C68,pcr
L2AF4    lbra  L3C5E
L2AF7    bsr   L2B13
         bra   L2AFD
L2AFB    bsr   L2B04
L2AFD    beq   L2B03
         cmpb  #$03
         bls   L2AD9
L2B03    rts
L2B04    deca
         sta   <u0071
         clr   <u0075
         lda   <u005B
         sta   <u005C
         lbsr  L0AC3
         lbsr  L0ACF
L2B13    lda   #$20
         lbsr  L0ACF
         lbsr  L0AD2
         lbsr  L3C5B
         lda   <u005A
         inca
         lda   a,y
         cmpa  #$44
         beq   L2B03
         cmpa  #$0D
         beq   L2B87
         lbsr  L0AD5
         blt   L2AD9
         andcc #$FB
         rts

* Width of window
         ldb   #$57
         bsr   L2AE2
         ldx   <u00A2
         lda   $08,x
         bsr   L2AFB
         bne   L2B41
         ldb   #$09
L2B41    ldy   <u00A2
         pshs  b
         clr   -$06,y
         clr   -$05,y
         lbsr  L20A8
         puls  b
         stb   $08,y
         ldu   ,y
         stu   $02,y
         lbsr  L1FB9
         lbsr  L1F53
         bra   L2B87
L2B5D    sta   <u002D
         sta   <u0091
         lbsr  L1D12
         leau  >L2BBA,pcr
         lbsr  L2450
         lda   <u002D
         bpl   L2B76
         lbsr  L1D2D
         lda   <u002D
         anda  #$7F
L2B76    ldb   #$22
         lbsr  L1D32
         lbsr  L1D2D
         clr   <u009A
L2B80    lbsr  L0AE4
         cmpa  #$0D
         bne   L2B8A
L2B87    lbra  L1EF3
L2B8A    cmpa  #$20
         bcs   L2B80
         bne   L2B5D
L2B90    lbsr  L0AE4
         cmpa  #$20
         bls   L2B90
         ora   #$80
         bra   L2B5D

* Change directory
         leau  >L2C88,pcr
         lbsr  L3C5E
         clr   <u009A
         lbsr  L3C5B
         decb
         lda   b,y
         ora   #$80
         sta   b,y
         leax  $0F,y
         lda   #$03
         os9   I$ChgDir
         bcc   L2B87
         lbra  L3C85

L2BBA    fcb   $0D
         fcc   'Graph="'
         fcb   $00

L2BC3    fcc   "Edit : "
         fcb   $00

L2BCB    fcc "Value"
         fcb   $00
L2BD1    fcc "Label"
         fcb  0
         fcb  $07
L2BD8    fcb  0
         fcc  " True"
         fcb  $08,0
         fcc  " False"
L2BE6    fcc  "  "

L2BE8    fcc   "NOT VALID !"
         fcb   0
L2BF4    fcc  "Times?"
         fcb   0

L2BFB    fcc   "Signal "
         fcb   0
L2C03    fcc   "Goto : "
         fcb   0
L2C0B    fcc   "Protection "
         fcb   0
L2C17    fcc   "Label entry "
         fcb   0

L2C24    fcc   "Type mismatch"
         fcb   0
L2C32    fcc   "Formula dump "
         fcb   0
L2C40    fcc   "CELL TABLE OVERFLOW !"
         fcb   $07
         fcb   $00

L2C57    fcc   "OUT OF MEMORY !"
         fcb   $07
         fcb   $00
L2C68    fcc   "Width is : "
         fcb   $00
L2C74    fcc   " NO MORE ROOM"
         fcb   $00
L2C82    fcc   "Blank"
         fcb   $00
L2C88    fcc   "New directory? "
         fcb   $00

L2C98    fcc   " Current Format: "
         fcb   $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00

L2CB5    lbra  L3509
L2CB8    lbra  L31FD
L2CBB    lbra  L312D
L2CBE    jmp   <u00E0
         nop
L2CC1    fcb   $01
         cmpa  >$0175
         fcb   $02
L2CC6    stx   $02,x
         stb   <u0009
         sbcb  $0B,x
         abx
         dec   <u0049
         fcb   $0B
L2CD0    ldd   $0B,x
         stu   $0C,x
         fcb $37
         fcb   $00,$00,$00,$00,$00,$00,$00,$00,$00,$00

L2CDF    lbra  L31E0
L2CE2    lbra  L2D62
L2CE5    lbra  L2D03
L2CE8    lbra  L2D3A
L2CEB    lbra  L31AF
L2CEE    jmp   <u0028
         nop
L2CF1    jmp   <u001D
         nop
L2CF4    tst   <u005A
         nop
         neg   <u0000
         nop
L2CFA    inc   <u00EC
         nop
L2CFD    lbra  L2DE2
L2D00    lbra  L2DF7
L2D03    ldb   #$B8
         stb   u000F,u
         lbsr  L3143
         lda   <u0039
         bpl   L2D0F
         nega
L2D0F    cmpa  #$0A
         bls   L2D1F
         bsr   L2D3A
         pshs  a
         addb  #$09
         tfr   b,a
         bsr   L2D1F
         puls  a
L2D1F    cmpa  #$0D
         lbcc  L31F8
         lsla
         beq   L2D52
         lsla
         lsla
         tfr   a,b
         leax  >L39E6,pcr
         abx
         tst   <u0039
         lbpl  L319C
         lbra  L31A5
L2D3A    clrb
L2D3B    cmpa  #$0A
         bcs   L2D52
         suba  #$0A
         incb
         bra   L2D3B
L2D44    bsr   L2D56
         cmpa  #$30
         bcs   L2D52
         cmpa  #$3A
         bcc   L2D53
         anda  #$0F
         andcc #$FE
L2D52    rts
L2D53    orcc  #$01
         rts
L2D56    leax  -$01,x
L2D58    leax  $01,x
         lda   ,x
         cmpa  #$20
         beq   L2D58
         rts
L2D61    rts
L2D62    clra
         lbsr  L31B2
         bsr   L2D44
         bcs   L2D61
         leax  $01,x
         sta   u000E,u
         inc   -$04,y
L2D70    bsr   L2D44
         bcs   L2D61
         leax  $01,x
         pshs  a
         inc   -$04,y
         ldd   u000D,u
         lslb
         rola
         std   u000D,u
         std   u0005,u
         ldd   u000B,u
         rolb
         rola
         std   u000B,u
         std   u0003,u
         ldd   u0009,u
         rolb
         rola
         std   u0009,u
         std   u0001,u
         lda   u0008,u
         rola
         sta   u0008,u
         sta   ,u
         lsl   u000E,u
         rol   u000D,u
         rol   u000C,u
         rol   u000B,u
         rol   u000A,u
         rol   u0009,u
         rol   u0008,u
         bcs   L2DDF
         lsl   u000E,u
         rol   u000D,u
         rol   u000C,u
         rol   u000B,u
         rol   u000A,u
         rol   u0009,u
         rol   u0008,u
         bcs   L2DDF
         lbsr  L31C1
         bcs   L2DDF
         puls  b
         clra
         addd  u000D,u
         std   u000D,u
         ldd   <u00DA
         adcb  u000C,u
         adca  u000B,u
         std   u000B,u
         ldd   <u00DA
         adcb  u000A,u
         adca  u0009,u
         std   u0009,u
         lda   #$00
         adca  u0008,u
         sta   u0008,u
         bcs   L2DDF
         bra   L2D70
L2DDF    lbra  L31F8
L2DE2    ldx   u0008,u
         stx   <u0018,u
         ldx   u000A,u
         stx   <MEMPTR,u
         ldx   u000C,u
         stx   <u001C,u
         ldx   u000E,u
         stx   <u001E,u
         rts
L2DF7    ldx   <u0018,u
         stx   u0008,u
         ldx   <MEMPTR,u
         stx   u000A,u
         ldx   <u001C,u
         stx   u000C,u
         ldx   <u001E,u
         stx   u000E,u
         rts
L2E0C    ldx   u0008,u
         stx   <u0020,u
         ldx   u000A,u
         stx   <u0022,u
         ldx   u000C,u
         stx   <u0024,u
         ldx   u000E,u
         stx   <u0026,u
         rts
L2E21    ldx   u0008,u
         stx   <u0010,u
         ldx   u000A,u
         stx   <u0012,u
         ldx   u000C,u
         stx   <u0014,u
         ldx   u000E,u
         stx   <u0016,u
         rts
L2E36    lbsr  L30E0
         lda   -u0001,u
         beq   L2E52
         ldb   $0E,y
         eorb  #$80
         stb   $0E,y
         eorb  $0D,y
         stb   $0C,y
         ldb   u0007,u
         bne   L2E7B
         bsr   L2E61
         lda   ,u
         lbra  L2F4E
L2E52    lda   ,u
         ldb   $0D,y
         lbra  L2F50
L2E59    ldd   ,x
         anda  #$7F
         ora   $0E,y
         bra   L2E63
L2E61    ldd   ,x
L2E63    std   ,u
         ldd   $02,x
         std   u0002,u
         ldd   $04,x
         std   u0004,u
         ldd   $06,x
         std   u0006,u
         rts
L2E72    lbsr  L30E0
         beq   L2E59
         lda   -u0001,u
         beq   L2E52
L2E7B    suba  u0007,u
         beq   L2E9D
         sta   $01,y
         bcc   L2EA3
         ldd   -u0008,u
L2E85    lsra
         rorb
         ror   -u0006,u
         ror   -u0005,u
         ror   -u0004,u
         ror   -u0003,u
         ror   -u0002,u
         inc   $01,y
         bne   L2E85
         std   -u0008,u
         lda   $0C,y
         bpl   L2EBF
         bra   L2EDD
L2E9D    inc   $01,y
         orcc  #$01
         bra   L2EBB
L2EA3    ldb   -u0001,u
         stb   u0007,u
         ldd   ,u
L2EA9    lsra
         rorb
         ror   u0002,u
         ror   u0003,u
         ror   u0004,u
         ror   u0005,u
         ror   u0006,u
         dec   $01,y
         bne   L2EA9
         std   ,u
L2EBB    lda   $0C,y
         bmi   L2EDA
L2EBF    lbsr  L2FD6
         bcc   L2ED4
         inc   u0007,u
         ror   ,u
         ror   u0001,u
         ror   u0002,u
         ror   u0003,u
         ror   u0004,u
         ror   u0005,u
         ror   u0006,u
L2ED4    lda   $0E,y
         sta   $0C,y
         bra   L2F18
L2EDA    rola
         coma
         asra
L2EDD    ldd   u0005,u
         sbcb  -u0002,u
         sbca  -u0003,u
         std   u0005,u
         ldd   u0003,u
         sbcb  -u0004,u
         sbca  -u0005,u
         std   u0003,u
         ldd   u0001,u
         sbcb  -u0006,u
         sbca  -u0007,u
         std   u0001,u
         lda   ,u
         sbca  -u0008,u
         sta   ,u
         lda   $0D,y
         bcc   L2F16
         com   ,u
         com   u0001,u
         com   u0002,u
         com   u0003,u
         com   u0004,u
         com   u0005,u
         com   u0006,u
         lda   $01,y
         beq   L2F14
         lbsr  L30FF
L2F14    lda   $0E,y
L2F16    sta   $0C,y
L2F18    clr   $01,y
L2F1A    lda   ,u
         bmi   L2F4E
         ora   u0001,u
         ora   u0002,u
         ora   u0003,u
         ora   u0004,u
         ora   u0005,u
         ora   u0006,u
         beq   L2F5F
         ldd   ,u
L2F2E    tst   u0007,u
         beq   L2F62
         dec   u0007,u
         bne   L2F38
         dec   ,y
L2F38    lsl   $01,y
         rol   u0006,u
         rol   u0005,u
         rol   u0004,u
         rol   u0003,u
         rol   u0002,u
         rolb
         rola
         bpl   L2F2E
         stb   u0001,u
         ldb   u0007,u
         beq   L2F62
L2F4E    ldb   $0C,y
L2F50    anda  #$7F
         andb  #$80
         pshs  b
         adda  ,s+
         sta   ,u
         tst   ,y
         bne   L2F62
L2F5E    rts
L2F5F    sta   u0007,u
         rts
L2F62    lda   ,y
         ldb   u0007,u
         cmpd  <u00DA
         beq   L2F92
         bmi   L2F92
         lbra  L31F8
L2F70    lbsr  L30E0
         beq   L2F92
         lda   -u0001,u
         beq   L2F92
         bsr   L2FF5
         clra
         ldb   u0007,u
         addb  -u0001,u
         adca  #$00
         subd  #$0080
         stb   u0007,u
         sta   ,y
         bsr   L2F1A
         lda   $01,y
         bpl   L2F5E
         lbra  L30FF
L2F92    clra
         sta   u0007,u
         lbra  L304D
L2F98    lbsr  L30E0
         ldb   -u0001,u
         bne   L2FA4
         lda   #$01
         lbra  L31FA
L2FA4    tsta
         beq   L2F92
         lbsr  L3058
         clra
         ldb   u0007,u
         subb  -u0001,u
         sbca  #$00
         addd  #$0081
         sta   ,y
         stb   u0007,u
         lda   $07,y
         coma
         asra
         ror   ,u
         ror   u0001,u
         ror   u0002,u
         ror   u0003,u
         ror   u0004,u
         ror   u0005,u
         ror   u0006,u
         ror   $01,y
         lbsr  L2F1A
         lda   $01,y
         bpl   L2FF4
         lbra  L30FF
L2FD6    ldd   u0005,u
         adcb  -u0002,u
         adca  -u0003,u
         std   u0005,u
         ldd   u0003,u
         adcb  -u0004,u
         adca  -u0005,u
         std   u0003,u
         ldb   u0002,u
         adcb  -u0006,u
         stb   u0002,u
         ldd   ,u
         adcb  -u0007,u
         adca  -u0008,u
         std   ,u
L2FF4    rts
L2FF5    bsr   L303D
         ldb   #$38
         stb   $08,y
L2FFB    lda   $07,y
         lsra
         bcc   L301C
         ldd   u0005,u
         addd  -u0003,u
         std   u0005,u
         ldd   u0003,u
         adcb  -u0004,u
         adca  -u0005,u
         std   u0003,u
         ldd   u0001,u
         adcb  -u0006,u
         adca  -u0007,u
         std   u0001,u
         lda   ,u
         adca  -u0008,u
         sta   ,u
L301C    ror   ,u
         ror   u0001,u
         ror   u0002,u
         ror   u0003,u
         ror   u0004,u
         ror   u0005,u
         ror   u0006,u
         ror   $01,y
         ror   $02,y
         ror   $03,y
         ror   $04,y
         ror   $05,y
         ror   $06,y
         ror   $07,y
         dec   $08,y
         bne   L2FFB
         rts
L303D    ldd   ,u
         std   $01,y
         ldd   u0002,u
         std   $03,y
         ldd   u0004,u
         std   $05,y
         ldb   u0006,u
         stb   $07,y
L304D    clra
         clrb
         std   ,u
         std   u0002,u
         std   u0004,u
         sta   u0006,u
         rts
L3058    bsr   L303D
         ldb   #$39
         stb   $08,y
L305E    ldb   $01,y
         cmpb  -u0008,u
         bcs   L308E
         ldd   $06,y
         subd  -u0003,u
         std   -$02,y
         ldd   $04,y
         sbcb  -u0004,u
         sbca  -u0005,u
         std   $0A,y
         ldb   $03,y
         sbcb  -u0006,u
         stb   $09,y
         ldd   $01,y
         sbcb  -u0007,u
         sbca  -u0008,u
         bcs   L308E
         std   $01,y
         lda   $09,y
         sta   $03,y
         ldd   $0A,y
         std   $04,y
         ldd   -$02,y
         std   $06,y
L308E    rol   u0006,u
         rol   u0005,u
         rol   u0004,u
         rol   u0003,u
         rol   u0002,u
         rol   u0001,u
         rol   ,u
         rol   $07,y
         rol   $06,y
         rol   $05,y
         rol   $04,y
         rol   $03,y
         rol   $02,y
         rol   $01,y
         dec   $08,y
         bhi   L305E
         beq   L30CF
         ldd   $06,y
         subd  -u0003,u
         std   $06,y
         ldd   $04,y
         sbcb  -u0004,u
         sbca  -u0005,u
         std   $04,y
         ldd   $02,y
         sbcb  -u0006,u
         sbca  -u0007,u
         std   $02,y
         lda   $01,y
         sbca  -u0008,u
         sta   $01,y
         clra
         bra   L308E
L30CF    ror   $01,y
         com   ,u
         com   u0001,u
         com   u0002,u
         com   u0003,u
         com   u0004,u
         com   u0005,u
         com   u0006,u
         rts
L30E0    leax  ,u
         leau  u0008,u
         clr   ,y
         lda   -u0008,u
         sta   $0E,y
         ora   #$80
         ldb   -u0008,u
         sta   -u0008,u
         eorb  ,u
         stb   $0C,y
         lda   ,u
         sta   $0D,y
         ora   #$80
         sta   ,u
         lda   u0007,u
         rts
L30FF    inc   u0006,u
         bne   L312C
         inc   u0005,u
         bne   L312C
         inc   u0004,u
         bne   L312C
         inc   u0003,u
         bne   L312C
         inc   u0002,u
         bne   L312C
         inc   u0001,u
         bne   L312C
         ldb   ,u
         tfr   b,a
         anda  #$7F
         inca
         bpl   L3124
         inc   u0007,u
         anda  #$7F
L3124    andb  #$80
         pshs  b
         adda  ,s+
         sta   ,u
L312C    rts
L312D    pshs  u,x,b,a
         leau  u0008,u
         ldd   ,u++
         std   ,x++
         ldd   ,u++
         std   ,x++
         ldd   ,u++
         std   ,x++
         ldd   ,u++
         std   ,x++
         puls  pc,u,x,b,a
L3143    clr   -$03,y
         lda   u0008,u
         bmi   L3175
         ora   u0009,u
         ora   u000A,u
         ora   u000B,u
         ora   u000C,u
         ora   u000D,u
         ora   u000E,u
         beq   L3186
         ldd   u0008,u
L3159    dec   u000F,u
         bne   L315F
         dec   <u003A
L315F    lsl   -$03,y
         rol   u000E,u
         rol   u000D,u
         rol   u000C,u
         rol   u000B,u
         rol   u000A,u
         rolb
         rola
         bpl   L3159
         stb   u0009,u
         ldb   u000F,u
         beq   L3189
L3175    ldb   <u003C
         anda  #$7F
         andb  #$80
         pshs  b
         adda  ,s+
         sta   u0008,u
         tst   <u003A
         bne   L3189
         rts
L3186    sta   u000F,u
         rts
L3189    lda   <u003A
         ldb   u000F,u
         cmpd  <u00DA
         beq   L3196
         bmi   L3196
         bra   L31F8
L3196    lda   -$0C,y
         beq   L31F8
         bra   L31AF
L319C    pshs  u,x
         bsr   L31E0
         lbsr  L2F70
         puls  pc,u,x
L31A5    pshs  u,x
         lbsr  L31E0
         lbsr  L2F98
         puls  pc,u,x
L31AF    clra
         sta   u000F,u
L31B2    sta   u0008,u
         sta   u0009,u
         sta   u000A,u
         sta   u000B,u
         sta   u000C,u
         sta   u000D,u
         sta   u000E,u
         rts
L31C1    ldd   u000D,u
         adcb  u0006,u
         adca  u0005,u
         std   u000D,u
         ldd   u000B,u
         adcb  u0004,u
         adca  u0003,u
         std   u000B,u
         ldb   u000A,u
         adcb  u0002,u
         stb   u000A,u
         ldd   u0008,u
         adcb  u0001,u
         adca  ,u
         std   u0008,u
         rts
L31E0    ldd   $06,x
         std   u0006,u
         ldd   $04,x
         std   u0004,u
         ldd   $02,x
         std   u0002,u
         ldd   ,x
         std   ,u
         rts
L31F1    ldx   <u0046
         leax  $08,x
         stx   <u0046
         rts
L31F8    lda   #$04
L31FA    sta   <u0033
         rts
L31FD    lbsr  L35E0
         leax  >-$046F,y
         stx   -$10,y
         clra
         sta   -$04,y
         sta   <u002F
         sta   <u0026
         sta   <u002B
         inca
         sta   -$0E,y
         ldb   u000F,u
         beq   L324A
         stb   <u0039
         subb  #$80
         bpl   L321D
         negb
L321D    lda   #$4E
         mul
         tfr   a,b
         tst   <u0039
         bmi   L3227
         negb
L3227    incb
         stb   <u002F
         lbsr  L2D0F
         leax  >L39EE,pcr
L3231    lda   u000F,u
         cmpa  #$81
         bcc   L323E
         lbsr  L319C
         dec   <u002F
         bra   L3231
L323E    lbsr  L351F
         bcs   L324A
         lbsr  L31A5
         inc   <u002F
         bra   L323E
L324A    ldb   u0008,u
         bpl   L3254
         stb   <u0026
         andb  #$7F
         stb   u0008,u
L3254    ldb   #$10
         stb   <u0025
         leax  >L3A4E,pcr
         stx   <u0046
L325E    clr   -$0B,y
         pshs  x
         leax  >L3ADE,pcr
         cmpx  ,s
         puls  x
         bne   L3273
         clrb
         bsr   L3292
         ldx   <u0046
         bra   L3286
L3273    lbsr  L351F
         bcs   L327F
         inc   -$0B,y
         lbsr  L3595
         bra   L3273
L327F    ldb   -$0B,y
         bsr   L3292
         lbsr  L31F1
L3286    dec   <u0025
         bmi   L329F
         bgt   L325E
         lda   <u002B
         sta   <u0036
         bra   L325E
L3292    ldx   -$10,y
         inc   <u002B
         stb   ,x+
         beq   L329C
         clr   <u002B
L329C    stx   -$10,y
         rts
L329F    ldb   <u004A
         orb   <u0091
         bne   L32AA
         lda   #$20
         lbsr  L0AFC
L32AA    ldb   #$10
         subb  <u0036
L32AE    stb   <u002B
         ldb   <u0020
         decb
         tst   <u0026
         beq   L32B8
         decb
L32B8    stb   <u0021
         clrb
         stb   <u0028
         stb   <u0029
         stb   <u002C
         stb   <u0027
         stb   <u002A
         lda   <u0022
         tst   <u004B
L32C9    lbne  L34B7
         ldb   <u002F
         bgt   L333A
         negb
         cmpa  #$04
         blt   L330B
         suba  #$05
         ble   L32DE
         inca
         sta   <u0028
         inca
L32DE    inca
         suba  <u0021
         bgt   L332C
         nega
         sta   <u002A
L32E6    inc   <u002B
         lda   >-$046D,y
         sta   >-$046C,y
         lda   >-$046E,y
         sta   >-$046D,y
         lda   >-$046F,y
         sta   >-$046E,y
         clr   >-$046F,y
         decb
         bpl   L32E6
         inc   <u0029
         bra   L3372
L330B    dec   <u0021
         stb   <u002C
         addb  <u002B
         bne   L331E
         ldb   #$01
         stb   <u0029
         ldb   <u0021
         stb   <u002A
         lbra  L33DC
L331E    subb  <u0021
         ble   L332F
         lda   <u002C
         cmpa  #$03
         bgt   L32C9
         cmpa  <u0021
         blt   L3333
L332C    lbra  L34EC
L332F    negb
         stb   <u002A
         clrb
L3333    subb  <u002B
         negb
         stb   <u0028
         bra   L3372
L333A    stb   <u0029
         subb  <u0021
         lbgt  L34B3
         negb
         cmpa  #$04
         blt   L3353
         cmpa  #$06
         bne   L3366
         lda   #$02
         cmpb  #$03
         blt   L332C
         bra   L335C
L3353    tstb
         beq   L3372
         lda   <u002B
         suba  <u002F
         ble   L3364
L335C    sta   <u0028
         decb
         bne   L3364
         stb   <u0028
         incb
L3364    subb  <u0028
L3366    stb   <u002A
         bpl   L3372
         addb  <u002B
         subb  <u002F
         stb   <u0028
         clr   <u002A
L3372    ldb   <u0029
         addb  <u0028
         clr   >-$0470,y
         leax  >-$046F,y
         lda   #$D0
         cmpb  <u002B
         ble   L3386
         ldb   #$10
L3386    abx
         ldb   ,x
         sta   ,x
         addb  #$05
         cmpb  #$09
         ble   L33B5
         clrb
L3392    incb
         sta   ,x
         lda   ,-x
         adda  #$01
         daa
         sta   ,x
         suba  #$10
         bpl   L3392
         pshs  x
         puls  a
         puls  a
         cmpa  #$E0
         bne   L33BB
         inc   <u002F
         ldb   #$01
         stb   >-$046F,y
         lbra  L32AE
L33B5    clrb
L33B6    incb
         lda   ,-x
         beq   L33B6
L33BB    lda   <u0022
         cmpa  #$06
         beq   L33DC
         tst   <u0028
         beq   L33DC
         decb
         stb   <u0025
         lda   <u002A
         adda  <u0025
         sta   <u002A
         subb  <u0028
         negb
         stb   <u0028
         bgt   L33DC
         addb  <u002A
         incb
         stb   <u002A
         clr   <u0028
L33DC    leax  >-$046F,y
         lda   <u0022
         cmpa  #$04
         bne   L3440
         tst   <u0026
         beq   L33F0
         ldb   <u0020
         decb
         lbra  L349E
L33F0    clrb
         lda   <u0029
         deca
         tst   <u0027
         bne   L340C
         ldb   ,x+
         deca
         bmi   L3408
         bne   L340C
         lda   #$0A
         mul
         addb  ,x
         bpl   L3408
         ldb   #$0A
L3408    cmpb  <u0020
         bcs   L3412
L340C    ldb   <u0020
         subb  #$02
         stb   <u0026
L3412    lda   <u0020
         stb   <u0025
         suba  <u0025
         deca
         sta   <u002A
         lda   <u002D
         bpl   L3432
         tst   <u0026
         bne   L3426
         decb
         bmi   L3432
L3426    lbsr  L349E
         lda   <u002D
         anda  #$7F
         tst   <u0026
         bne   L3432
         negb
L3432    bsr   L34A0
         tst   <u0026
         beq   L343E
         dec   <u002A
         lda   #$3E
         bsr   L34A2
L343E    bra   L349A
L3440    cmpa  #$03
         beq   L344C
         ldb   <u002A
         lda   #$20
         bsr   L34A0
         clr   <u002A
L344C    tst   <u0026
         beq   L3454
         lda   #$2D
         bsr   L34A2
L3454    ldb   <u0029
         beq   L345B
         lbsr  L34F3
L345B    lda   #$2E
         ldb   <u002C
         beq   L3468
         bsr   L34A2
         lda   #$30
         bsr   L34A0
         clra
L3468    ldb   <u0028
         beq   L3474
         tsta
         beq   L3471
         bsr   L34A2
L3471    lbsr  L34F3
L3474    ldb   <u0027
         bne   L347A
         bra   L349A
L347A    lda   #$65
         bsr   L34A2
         tstb
         bpl   L3486
         lda   #$2D
         bsr   L34A2
         negb
L3486    tfr   b,a
         lbsr  L2D3A
         tstb
         beq   L3496
         exg   a,b
         adda  #$30
         bsr   L34A2
         exg   a,b
L3496    adda  #$30
         bsr   L34A2
L349A    ldb   <u002A
         andb  <u00C7
L349E    lda   #$20
L34A0    bra   L3505
L34A2    tst   <u004A
         lbeq  L0B1A
         lbmi  L0AF3
         ldu   <u00F8
         sta   ,u+
         stu   <u00F8
         rts
L34B3    cmpa  #$05
         bge   L34EC
L34B7    lda   <u002F
         deca
         sta   <u0027
         bpl   L34C1
         nega
         clr   <u002C
L34C1    ldb   #$01
         stb   <u0029
         ldb   <u0021
         cmpa  #$09
         ble   L34CC
         decb
L34CC    subb  #$03
         blt   L34EC
         beq   L34E9
         subb  <u002B
         blt   L34D9
         stb   <u002A
         clrb
L34D9    addb  <u002B
         decb
         bne   L34E0
         inc   <u002A
L34E0    stb   <u0028
         ldb   <u004B
         beq   L34E9
         decb
         stb   <u0028
L34E9    lbra  L3372
L34EC    lda   #$3E
         ldb   <u0020
         decb
         bra   L3505
L34F3    lda   ,x+
         adda  #$30
         bne   L34FD
         leax  -$01,x
         lda   #$30
L34FD    bsr   L34A2
         decb
         bne   L34F3
         rts
L3503    bsr   L34A2
L3505    decb
         bpl   L3503
         rts
L3509    pshs  u,x,b,a
         leau  u0008,u
         ldd   ,x++
         std   ,u++
         ldd   ,x++
         std   ,u++
         ldd   ,x++
         std   ,u++
         ldd   ,x++
         std   ,u++
         puls  pc,u,x,b,a
L351F    lda   u0008,u
         eora  ,x
         bmi   L3588
         lda   u0008,u
         bmi   L355F
         lda   u000F,u
         beq   L3559
         ldb   $07,x
         beq   L358C
         pshs  b
         cmpa  ,s+
         bne   L3590
         ldd   u0008,u
         cmpd  ,x
         bne   L3590
         ldd   u000A,u
         cmpd  $02,x
         bne   L3590
         ldd   u000C,u
         cmpd  $04,x
         bne   L3590
         lda   u000E,u
         anda  #$FE
         ldb   $06,x
         andb  #$FE
         pshs  b
         cmpa  ,s+
         rts
L3559    lda   $07,x
         bne   L3591
         clra
         rts
L355F    lda   $07,x
         cmpa  u000F,u
         beq   L3566
         rts
L3566    ldd   ,x
         cmpd  u0008,u
         bne   L3590
         ldd   $02,x
         cmpd  u000A,u
         bne   L3590
         ldd   $04,x
         cmpd  u000C,u
         bne   L3590
         lda   $06,x
         anda  #$FE
         ldb   u000E,u
         andb  #$FE
         pshs  b
         cmpa  ,s+
         rts
L3588    lda   ,x
         bpl   L3591
L358C    lda   #$01
         andcc #$FE
L3590    rts
L3591    clra
         cmpa  #$01
         rts
L3595    pshs  u,x
         lbsr  L31E0
         lbsr  L2E36
         puls  pc,u,x
L359F    pshs  u,x
         lbsr  L31E0
         lbsr  L2E72
         puls  pc,u,x
L35A9    leax  u0008,u
L35AB    lda   #$90
         sta   $07,x
         clr   $02,x
         clr   $03,x
         clr   $04,x
         clr   $05,x
         clr   $06,x
         lda   ,x
         tfr   a,b
         orb   $01,x
         beq   L360E
         ldb   $01,x
         tsta
         bpl   L35CD
         coma
         comb
         addd  #$0001
         bvs   L35D3
L35CD    dec   $07,x
         lslb
         rola
         bpl   L35CD
L35D3    anda  #$7F
         tst   ,x
         bpl   L35DB
         ora   #$80
L35DB    sta   ,x
         stb   $01,x
         rts
L35E0    inc   u000E,u
         bne   L360D
         inc   u000D,u
         bne   L360D
         inc   u000C,u
         bne   L360D
         inc   u000B,u
         bne   L360D
         inc   u000A,u
         bne   L360D
         inc   u0009,u
         bne   L360D
         ldb   u0008,u
         tfr   b,a
         anda  #$7F
         inca
         bpl   L3605
         inc   u000F,u
         anda  #$7F
L3605    andb  #$80
         pshs  b
         adda  ,s+
         sta   u0008,u
L360D    rts
L360E    clr   $07,x
L3610    clr   ,x
         clr   $01,x
         rts
L3615    clr   <u002F
L3617    lsra
         rorb
         ror   $02,x
         ror   $03,x
         ror   $04,x
         ror   $05,x
         ror   $06,x
         bcc   L3627
         ror   <u002F
L3627    dec   <u0039
         bne   L3617
         rts
L362C    leax  >L3A4E,pcr
L3630    pshs  a
         ldd   ,x
         std   u0008,u
         ldd   $02,x
         std   u000A,u
         ldd   $04,x
         std   u000C,u
         ldd   $06,x
         std   u000E,u
         puls  pc,a
L3644    leax  u0008,u
L3646    ldb   $07,x
         beq   L3680
         subb  #$81
         bcs   L367A
         negb
         addb  #$0F
         beq   L3684
         bmi   L3677
         stb   <u0039
         ldd   ,x
         bpl   L3692
         bsr   L3615
         tst   <u002F
         bne   L3665
L3661    tst   $02,x
         beq   L3670
L3665    cmpd  #$8000
         beq   L3677
         addd  #$0001
         bcs   L3677
L3670    coma
         comb
         addd  #$0001
         bra   L369A
L3677    lbra  L31F8
L367A    lda   ,x
         bpl   L3610
         ldb   #$FF
L3680    tfr   b,a
         bra   L369A
L3684    lda   ,x
         bpl   L3677
         bita  #$7F
         bne   L3677
         ldb   $01,x
         bne   L3677
         bra   L3661
L3692    ora   #$80
L3694    lsra
         rorb
         dec   <u0039
         bne   L3694
L369A    std   ,x
         rts
L369D    rts
L369E    lda   #$05
         lbra  L31FA
         lda   u0008,u
         bmi   L369E
         lda   u000F,u
         beq   L369D
         sta   -$0D,y
         anda  #$01
         tfr   a,b
         adda  #$80
         sta   u000F,u
         lbsr  L2DE2
         leax  >$0070,y
         tstb
         beq   L36C3
         leax  >$0088,y
L36C3    stx   <u0046
         bsr   L3723
         lbsr  L2E21
         lbsr  L31F1
         lbsr  L3630
         leax  <u0010,u
         lbsr  L31A5
         lbsr  L31F1
         bsr   L3723
         lbsr  L2E21
         lbsr  L2DF7
         leax  <u0010,u
         lbsr  L31A5
         bsr   L3723
         dec   u000F,u
         lbsr  L2E21
         lbsr  L2DF7
         leax  <u0010,u
         lbsr  L31A5
         bsr   L3723
         dec   u000F,u
         lda   -$0D,y
         suba  #$80
         asra
         adda  u000F,u
         sta   u000F,u
         rts
L3705    lda   #$06
         lbra  L31FA
         inc   -$0C,y
         lda   u0008,u
         bmi   L3705
         lda   u000F,u
         beq   L3705
         cmpa  #$81
         bcs   L3726
         deca
         sta   -$0B,y
         lda   #$81
         sta   u000F,u
         clr   -$0D,y
         bra   L3730
L3723    lbra  L359F
L3726    sta   -$0B,y
         lda   #$80
         sta   u000F,u
         lda   #$01
         sta   -$0D,y
L3730    lbsr  L2DE2
         lbsr  L2E21
         lda   <u0017,u
         adda  #$03
         sta   <u0017,u
         leax  <u0010,u
         lbsr  L3646
         addb  -$0D,y
         andb  #$0E
         stb   -$0D,y
         stb   <u0011,u
         lbsr  L35AB
         lda   <u0017,u
         suba  #$03
         sta   <u0017,u
         bsr   L3723
         lbsr  L2E0C
         lbsr  L2DF7
         leax  <u0010,u
         lda   u000E,u
         anda  #$F0
         sta   u000E,u
         lda   $06,x
         anda  #$F0
         sta   $06,x
         lbsr  L3595
         leax  <u0020,u
         lbsr  L31A5
         lbsr  L2DE2
         leax  <u0018,u
         lbsr  L38A8
         leax  >L3BE6,pcr
         ldb   #$02
         bsr   L37CA
         leax  <u0010,u
         bsr   L37C7
         leax  <u0018,u
         bsr   L37C7
         lda   $07,x
         beq   L379B
         inc   $07,x
         bsr   L3723
L379B    ldb   -$0D,y
         subb  #$04
         lslb
         lslb
         leax  >L3C06,pcr
         abx
         lbsr  L3595
         lbsr  L2DE2
         clra
         ldb   -$0B,y
         subb  #$80
         bpl   L37B4
         coma
L37B4    std   u0008,u
         lbsr  L35A9
         leax  >L3C06,pcr
         bsr   L37C7
         leax  <u0018,u
         bsr   L37F8
         clr   -$0C,y
         rts
L37C7    lbra  L319C
L37CA    pshs  b
         stx   <u0046
         lbsr  L3630
L37D1    leax  <u0010,u
         bsr   L37F8
         lbsr  L2E0C
         ldx   <u0046
         leax  $08,x
         stx   <u0046
         lbsr  L3630
         leax  <u0020,u
         lbsr  L31A5
         dec   ,s
         beq   L37F6
         ldx   <u0046
         leax  $08,x
         stx   <u0046
         bsr   L37F8
         bra   L37D1
L37F6    puls  pc,b
L37F8    lbra  L359F
         leax  >L3B06,pcr
         bsr   L37C7
         lbsr  L2DE2
         bsr   L385B
         lda   u0008,u
         eora  #$80
         sta   u0008,u
         leax  <u0018,u
         bsr   L37F8
         lbsr  L2DE2
         leax  <u0018,u
         lbsr  L38A8
         leax  >L3ADE,pcr
         ldb   #$02
         bsr   L37CA
         leax  <u0010,u
         bsr   L37C7
         leax  >L3AFE,pcr
         bsr   L37F8
         leax  <u0018,u
         lbsr  L3595
         tst   $07,x
         beq   L3839
         inc   $07,x
L3839    lbsr  L2E21
         lbsr  L2DF7
         leax  <u0010,u
         lbsr  L31A5
         leax  >L3A4E,pcr
         bsr   L37F8
         ldb   u000F,u
         clra
         addd  -$0B,y
         tsta
         bne   L3856
         stb   u000F,u
         rts
L3856    lda   #$07
         lbra  L31FA
L385B    lda   u0008,u
         sta   -$0B,y
         anda  #$7F
         sta   u0008,u
         leax  >L39E6,pcr
         bsr   L37F8
         lbsr  L3644
         ldd   u0008,u
         tst   -$0B,y
         bpl   L3877
         coma
         comb
         addd  #$0001
L3877    std   -$0B,y
         lbsr  L35A9
         lda   -$0B,y
         anda  #$80
         ora   u0008,u
         sta   u0008,u
         rts
L3885    lbsr  L2E0C
         leax  >L3B0E,pcr
         lbsr  L31A5
         bsr   L385B
         lda   u0008,u
         eora  #$80
         sta   u0008,u
         leax  >L3B0E,pcr
         bsr   L38F5
         leax  <u0020,u
         bsr   L38DB
         lbsr  L2DE2
         leax  <u0018,u
L38A8    bsr   L38F5
         lbra  L2E21
         clra
         bra   L38B2
         lda   #$01
L38B2    sta   -$0E,y
         bsr   L3885
         ldb   -$0E,y
         addb  -$0A,y
         stb   -$0A,y
         bitb  #$01
         bne   L38DE
         leax  >L3B1E,pcr
         bsr   L38CD
         leax  <u0018,u
         bsr   L38F5
         bra   L38E4
L38CD    ldb   #$03
         lbsr  L37CA
         leax  <u0010,u
         bsr   L38F5
         leax  >L3A4E,pcr
L38DB    lbra  L359F
L38DE    leax  >L3B4E,pcr
         bsr   L38CD
L38E4    lda   -$0A,y
         bita  #$02
         beq   L38F4
         lda   u000F,u
         beq   L38F4
         lda   u0008,u
         eora  #$80
         sta   u0008,u
L38F4    rts
L38F5    lbra  L319C
         lda   u000F,u
         beq   L38F4
         clr   -$0D,y
         ldb   u0008,u
         stb   -$0E,y
         andb  #$7F
         stb   u0008,u
         lbsr  L2DE2
         cmpa  #$81
         bcs   L3959
         lbsr  L362C
         ldb   #$84
         stb   u000F,u
         leax  <u0018,u
         lbsr  L31A5
         lbsr  L385B
         ldb   u000F,u
         beq   L3925
         subb  #$03
         stb   u000F,u
L3925    lbsr  L2E21
         leax  <u0018,u
         bsr   L38DB
         lbsr  L2E0C
         lbsr  L2DF7
         leax  <u0010,u
         bsr   L38F5
         lda   u0008,u
         eora  #$80
         sta   u0008,u
         leax  >L3A4E,pcr
         bsr   L38DB
         leax  <u0020,u
         lda   u000F,u
         cmpa  #$60
         bhi   L394F
         clr   u000F,u
L394F    lbsr  L31A5
         com   -$0D,y
         bra   L3990
L3956    lbra  L359F
L3959    adda  #$03
         sta   u000F,u
         lbsr  L385B
         lda   u000F,u
         beq   L3968
         suba  #$03
         sta   u000F,u
L3968    lbsr  L2E21
         leax  <u0018,u
         bsr   L38F5
         leax  >L3A4E,pcr
         bsr   L3956
         lbsr  L2E0C
         lbsr  L2DF7
         leax  <u0010,u
         lbsr  L3595
         leax  <u0020,u
         lda   u000F,u
         cmpa  #$60
         bhi   L398D
         clr   u000F,u
L398D    lbsr  L31A5
L3990    lbsr  L2DE2
         leax  <u0018,u
         lbsr  L38A8
         leax  >L3B7E,pcr
         ldb   #$01
         lbsr  L37CA
         lbsr  L31F1
         bsr   L3956
         leax  <u0010,u
         lbsr  L319C
         lbsr  L31F1
         bsr   L3956
         leax  <u0010,u
         lbsr  L319C
         leax  <u0018,u
         lbsr  L319C
         bsr   L3956
         ldb   -$0A,y
         lslb
         lslb
         lslb
         leax  >L3B9E,pcr
         abx
         bsr   L3956
         tst   -$0D,y
         beq   L39DD
         lda   u0008,u
         eora  #$80
         sta   u0008,u
         leax  >L3B0E,pcr
         lbsr  L359F
L39DD    lda   -$0E,y
         anda  #$80
         eora  u0008,u
         sta   u0008,u
         rts

* Floating point constants.
* The format is the same as the 'double' in Microware C

L39E6    fcb   $00,$00,$00,$00,$00,$00,$00,$80  Value=0.5
L39EE    fcb   $20,$00,$00,$00,$00,$00,$00,$84  Value 10
         fcb   $48,$00,$00,$00,$00,$00,$00,$87  Value 100
         fcb   $7A,$00,$00,$00,$00,$00,$00,$8A  Value 1000
         fcb   $1C,$40,$00,$00,$00,$00,$00,$8E  Value 10000
         fcb   $43,$50,$00,$00,$00,$00,$00,$91  Value 100000
         fcb   $74,$24,$00,$00,$00,$00,$00,$94  Value 1000000
         fcb   $18,$96,$80,$00,$00,$00,$00,$98  Value 10000000
         fcb   $3E,$BC,$20,$00,$00,$00,$00,$9B  Value=1.000000e+08
         fcb   $6E,$6B,$28,$00,$00,$00,$00,$9E  Value=1.000000e+09
         fcb   $15,$02,$F9,$00,$00,$00,$00,$A2  Value=1.000000e+10
         fcb   $2D,$78,$EB,$C5,$AC,$62,$00,$C3  Value=1.000000e+20
         fcb   $49,$F2,$C9,$CD,$04,$67,$4F,$E4  Value=1.000000e+30
L3A4E    fcb   $00,$00,$00,$00,$00,$00,$00,$81  Value 1 in floating point
         fcb   $4C,$CC,$CC,$CC,$CC,$CC,$CD,$7D  Value 0.1
         fcb   $23,$D7,$0A,$3D,$70,$A3,$D7,$7A  Value 0.01
         fcb   $03,$12,$6E,$97,$8D,$4F,$DF,$77  Value=0.001
         fcb   $51,$B7,$17,$58,$E2,$19,$65,$73  Value=0.0001
         fcb   $27,$C5,$AC,$47,$1B,$47,$84,$70  Value=0.00001
         fcb   $06,$37,$BD,$05,$AF,$6C,$6A,$6D  Value=0.000001
         fcb   $56,$BF,$94,$D5,$E5,$7A,$43,$69
         fcb   $2B,$CC,$77,$11,$84,$61,$CF,$66
         fcb   $09,$70,$5F,$41,$36,$B4,$A5,$63
         fcb   $5B,$E6,$FE,$CE,$BD,$ED,$D6,$5F
         fcb   $2F,$EB,$FF,$0B,$CB,$24,$AC,$5C
         fcb   $0C,$BC,$CC,$09,$6F,$50,$89,$59
         fcb   $61,$2E,$13,$42,$4B,$B4,$0E,$55
         fcb   $34,$24,$DC,$35,$09,$5C,$D8,$52
         fcb   $10,$1D,$7C,$F7,$3A,$B0,$AD,$4F
         fcb   $66,$95,$94,$BE,$C4,$4D,$E1,$4B
         fcb   $38,$77,$AA,$32,$36,$A4,$B4,$48
L3ADE    fcb   $3B,$5F,$D5,$41,$8C,$88,$DF,$88  Value=187.374348
         fcb   $F7,$0C,$BC,$CF,$C3,$85,$80,$90  Value=-63244.737545
         fcb   $2B,$D7,$E1,$DF,$DA,$A8,$31,$8A  Value=687.373161
         fcb   $21,$A9,$43,$DB,$7A,$8F,$EE,$86  Value=40.415298
L3AFE    fcb   $38,$AA,$3B,$29,$5C,$17,$F0,$82  Value=2.88539
L3B06    fcb   $38,$AA,$3B,$29,$5C,$17,$F0,$81  Value=1.442695

L3B0E    fcb   $49,$0F,$DA,$A2,$21,$68,$C2,$81  Value=1.570796 (PI/2)
L3B16    fcb   $49,$0F,$DA,$A2,$21,$68,$C2,$82  Value=3.141593 (PI)

L3B1E    fcb   $B5,$4D,$F0,$11,$62,$9E,$06,$84  Value=-11.331528
         fcb   $33,$23,$67,$F6,$25,$F3,$3A,$8C  Value=2866.212881
         fcb   $B1,$02,$A9,$F3,$29,$C1,$EE,$87  Value=-88.505203
         fcb   $15,$18,$89,$17,$50,$B5,$90,$90
         fcb   $07,$B2,$83,$51,$03,$D5,$EC,$89
         fcb   $D4,$D0,$2A,$23,$DA,$7E,$59,$85

L3B4E    fcb   $43,$FA,$82,$84,$2C,$97,$BB,$81  Value=1.531082
         fcb   $35,$24,$37,$05,$1F,$D4,$5B,$8B  Value=1449.131716
         fcb   $93,$05,$A0,$B6,$D2,$D5,$3E,$87
         fcb   $2C,$89,$82,$22,$D7,$2F,$16,$8F
         fcb   $49,$54,$97,$B7,$42,$D9,$54,$88
         fcb   $E2,$A1,$07,$39,$21,$A1,$B1,$87

L3B7E    fcb   $24,$A2,$79,$05,$8D,$0D,$3C,$81  Value=1.286208
         fcb   $72,$01,$3E,$98,$C4,$58,$45,$7E  Value=0.236333
         fcb   $05,$2B,$98,$E4,$05,$AD,$89,$7B  Value=0.016256
         fcb   $AA,$AA,$AA,$AA,$AA,$81,$EE,$7F  Value=-0.333333
L3B9E    fcb   $00,$00,$00,$00,$00,$00,$00,$00 Value 0
         fcb   $7E,$AD,$D4,$D5,$61,$7B,$6D,$7D  Value=0.124355
         fcb   $7A,$DB,$AF,$C9,$64,$86,$EB,$7E  Value=0.244979
         fcb   $37,$B0,$CA,$0F,$26,$F7,$84,$7F
         fcb   $6D,$63,$38,$2B,$0D,$DA,$7D,$7F
         fcb   $0F,$00,$5D,$5E,$F7,$F5,$A0,$80
         fcb   $24,$BC,$7D,$19,$34,$F7,$09,$80
         fcb   $38,$05,$3E,$2B,$C2,$31,$9E,$80
         fcb   $49,$0F,$DA,$A2,$21,$68,$C2,$80

L3BE6    fcb   $F9,$7F,$B4,$FC,$E3,$9F,$24,$81  Value=-1.94921
         fcb   $8B,$62,$81,$A3,$99,$03,$C8,$81
         fcb   $AC,$FE,$0B,$40,$5D,$17,$CD,$82
         fcb   $B6,$FB,$F7,$37,$54,$55,$6B,$81
L3C06    fcb   $31,$72,$17,$F7,$D1,$CF,$7C,$80  Value=0.693147 (ln(2))
         fcb   $13,$4B,$10,$89,$A6,$DC,$A3,$7F  Value=0.287682
         fcb   $00,$00,$00,$00,$00,$00,$00,$00
         fcb   $E4,$7F,$BE,$3C,$D4,$D1,$0D,$7E  Value=-0.223144
         fcb   $CF,$99,$1F,$65,$FC,$C2,$60,$7F  Value=-0.405465
         fcb   $8F,$42,$FA,$F3,$82,$06,$82,$80  Value=-0.559616
         fcb   $9E,$48,$9C,$8E,$AC,$BC,$BE,$AA
         fcb   $68,$08,$50,$26,$66,$8E,$28,$48
         fcb   $5E,$4C,$44,$42,$44,$6A,$56,$04
         fcb   $00,$00,$00,$00,$00,$00,$00

L3C55    lbra  L3DFB
L3C58    lbra  L3F72
L3C5B    lbra  L3C9F
L3C5E    lbra  L3CB3
         lbra  L4112
L3C64    lbra  L3C91
L3C67    lbra  L4027
L3C6A    lbra  L3E56
L3C6D    lbra  L414A
L3C70    lbra  L3D17
L3C73    lbra  L3FD4
         lbra  L41C3
L3C79    lbra  L3D8C
L3C7C    lbra  L402B
L3C7F    lbra  L41AD
L3C82    lbra  L3D1B
L3C85    lbra  L3DA6
L3C88    lbra  L3F68
L3C8B    lbra  L3D75
L3C8E    lbra  L40E5

L3C91    cmpa  #$0D
         bne   L3CAA
         ldb   <u005B
         incb
         bpl   L3C9B
         decb
L3C9B    sta   b,y
         puls  pc,x
L3C9F    com   <u008B
         pshs  x
         lbsr  L0AD2
         inc   <u0060
         clr   <u00AD
L3CAA    lbra  L0AB4
L3CAD    ldy   <u00E9
         lbsr  L0ACF
L3CB3    lda   ,u+
         bne   L3CAD
         clr   <u005A
         clr   <u0059
         clr   <u00CD
         com   <u00A5
         lbsr  L0AD8
         rts

         lda   #$14
         sta   <u0061
         lbsr  L0AD2
         lbsr  L3CAA
         dec   <u006A
         ldu   <u006A
         rts

L3CD2    fcb   $3D,$C6,$C5,$A0,$BB,$A3,$0C,$0E,$0F,$0D,$09,$F8,$6D

L3CDF    fcb   $CE
         suba  #$81

L3CE2    stu   <u00C1
         leau  >L3CD2,pcr
         ldx   <u00DA
L3CEA    clra
         leax  $01,x
         ldb   ,u+
         addd  #$00F0
         addd  <MEMPTR
         tfr   d,y
         tst   <u00EF
         bne   L3D01
         lda   ,y
         lbsr  L402B
         bra   L3D06
L3D01    lbsr  L402B
         sta   ,y
L3D06    cmpx  #$000A
         bcs   L3CEA
         tst   <u00C2
         bpl   L3D14
         cmpx  #$000D
         bcs   L3CEA
L3D14    rts
L3D15    dec   <u00E1
L3D17    leau  >L4171,pcr
L3D1B    bsr   L3D79
L3D1D    bcc   L3D25
         cmpb  #$CB
         bne   L3D3E
         bra   L3D3C
L3D25    tst   <u0019
         bne   L3D6B
         ldx   <u0030
         pshs  a
         clrb
         os9   I$GetStt
         puls  a
         os9   I$Close
         ldx   <u0030
         lda   ,x
         bne   L3D50
L3D3C    inc   <u00E1
L3D3E    lda   #$0D
         sta   <u00D0
         lda   #$02
         ldb   #$1B
         leax  <$12,y
         os9   I$Create
         bcs   L3DA6
         bra   L3DA1

L3D50    deca
         lbne  L3DA6
         leau  >L4190,pcr
         lbsr  L4147
         inc   <u009A
         lbsr  L0AE4
         cmpa  #$59
         bne   L3D87
         lbsr  L0B05
         lbsr  L3FD4
L3D6B    leax  <$12,y
         os9   I$Delete
         bcs   L3DA6
         bra   L3D3E

L3D75    bsr   L3D7C
         bra   L3D1D
L3D79    lbsr  L3ED0
L3D7C    clr   <u00EF
         leax  <$12,y
         lda   #$01
         os9   I$Open
         rts

L3D87    lbra  L1C8E
L3D8A    inc   <u00E1
L3D8C    leau  >L416A,pcr
         bsr   L3D79
         bcs   L3DA6
         ldb   #$0C
         stb   <u00D0
         ldx   #$0900
         stx   <u0044
         inc   <u00EF
         bra   L3DA3
L3DA1    bcs   L3DA6
L3DA3    sta   <u00EE
         rts
L3DA6    tst   <u0019
         bne   L3DF8
         pshs  b,a
         inc   <u00EF
         ldd   <u00ED
         std   <u00C1
         clr   <u00ED
         clra
         tstb
         beq   L3DC2
         tfr   b,a
         os9   I$Close
         clr   <u00EE
         lbsr  L3E56
L3DC2    lbsr  L1CFA
         lbsr  L1C6D
         puls  b,a
         stb   <u0025
         leau  >L41A4,pcr
         lbsr  L4147
         stb   <u0075
         decb
         stb   <u0071
         lbsr  L0AC3
         tst   <u001D
         bne   L3DE5
         ldx   <u001E
         leax  $0A,x
         jsr   ,x
L3DE5    lbsr  L1D06
         lda   <u00C1
         ora   <u00C2
         beq   L3D87
         lbra  L0AA8
L3DF1    bsr   L3DF5
         tfr   b,a
L3DF5    lbra  L402B
L3DF8    lbra  L1CEB
L3DFB    lbsr  L3D15
         ldx   <MEMPTR
         lda   #$21
         sta   <u0040
         ldd   #$FFFF
         bsr   L3DF1
         ldd   #$8081
         leau  >$0580,x
L3E10    bsr   L3DF1
         ldd   ,u++
         tsta
         bne   L3E10
         leau  >$0500,x
L3E1B    bsr   L3DF1
         ldd   ,u++
         dec   <u0040
         bne   L3E1B
         ldd   <u006E
         bsr   L3DF1
         ldd   <u00A2
         bsr   L3DF1
         ldd   <u0097
         bsr   L3DF1
         lbsr  L3CDF
         ldu   <u001E
         clra
         clrb
L3E36    leau  -u0002,u
         lbsr  L3E8D
         incb
         beq   L3E43
         cmpb  <u00C0
         bls   L3E36
         clrb
L3E43    inca
         beq   L3E4A
         cmpa  <u00BF
         bls   L3E36
L3E4A    lda   #$FF
         bsr   L3E8A
         bsr   L3E8A
         clra
         bsr   L3E8A
         lbsr  L50D0
L3E56    pshs  b,a
         ldd   <u00ED
         beq   L3E71
         lda   <u00D0
         cmpa  #$0D
         bne   L3E65
         lbsr  L3FD8
L3E65    clra
         clr   <u00EE
         tfr   b,a
         os9   I$Close
         lbcs  L3DA6
L3E71    ldx   #$0700
         stx   <u0044
         clr   <u00A7
         tst   <u0019
         lbne  L3DF8
         tst   <u00ED
         lbne  L0AA8
         tst   <u00EF
         beq   L3EB7
         puls  pc,b,a
L3E8A    lbra  L402B
L3E8D    pshs  x,b,a
         ldx   ,u
         beq   L3EB1
         lbsr  L50B8
         bsr   L3E8A
         tfr   b,a
         bsr   L3E8A
         lda   ,x
         ldb   ,x+
         bsr   L3E8A
         lda   ,x+
         bsr   L3E8A
         subb  #$02
         beq   L3EB1
L3EAA    lda   ,x+
         bsr   L3E8A
         decb
         bne   L3EAA
L3EB1    puls  pc,x,b,a
L3EB3    tst   <u00E1
         bne   L3EBA
L3EB7    lbra  L1C8E
L3EBA    cmpa  #$2F
         beq   L3EB7
         leax  >$0440,y
         tst   ,x
         beq   L3EB7
         leau  <$12,y
         lbsr  L40E5
         addb  #$11
         bra   L3F3D
L3ED0    ldb   <u00ED
         bne   L3ED8
         ldb   <u0019
         beq   L3EDF
L3ED8    stb   <u005B
         ldy   <u00E9
         bra   L3EF7
L3EDF    lbsr  L3CB3
         leau  >L415D,pcr
         lbsr  L3CB3
         clr   <u009A
         lbsr  L3C9F
         cmpb  #$12
         beq   L3EB3
         tst   <u00E1
         beq   L3F3D
L3EF6    decb
L3EF7    cmpb  #$11
         beq   L3F01
         lda   b,y
         cmpa  #$2F
         bne   L3EF6
L3F01    stb   <u00E1
         ldb   <u005B
         subb  <u00E1
         cmpb  #$19
         bcc   L3F0D
         clr   <u00E1
L3F0D    lda   <u005B
         cmpb  #$1D
         bls   L3F17
         lda   <u00E1
         adda  #$1D
L3F17    tfr   a,b
         deca
         ldx   #$2E63
         ldu   #$616C
         cmpu  a,y
         bne   L3F2B
         suba  #$02
         cmpx  a,y
         beq   L3F3C
L3F2B    ldb   <u00E1
         bne   L3F33
         ldb   <u005B
         subb  #$19
L3F33    addb  #$1A
         stx   b,y
         addb  #$02
         stu   b,y
         incb
L3F3C    incb
L3F3D    clr   b,y
         stb   <u0036
         clr   <u00E1
         tst   <u0019
         bne   L3F67
         lda   <u000E
         suba  #$30
         leau  <$12,y
         tst   <u00ED
         bne   L3F67
         lbsr  L0B05
         lbsr  L1CA3
         lda   <u000E
         suba  #$0B
         leau  <$12,y
         bsr   L3F68
         ldb   <u0036
         lda   #$20
         sta   b,y
L3F67    rts
L3F68    sta   <u0079
         lda   u0003,u
         lbsr  L0AC0
         lbra  L3FD8
L3F72    lbsr  L3D8A
         ldu   <u006E
         stu   <u0068
         bsr   L3F97
         cmpu  #$FFFF
         bne   L3FCD
         bsr   L3F97
         pshs  u
         ldx   <MEMPTR
         leau  >$0580,x
L3F8B    bsr   L3FA2
         sta   ,u+
         beq   L3FA5
         bsr   L3FA2
         sta   ,u+
         bra   L3F8B
L3F97    bsr   L3FA2
         tfr   a,b
         bsr   L3FA2
         exg   a,b
         tfr   d,u
L3FA1    rts
L3FA2    lbra  L402B
L3FA5    leau  >$04FF,x
         ldb   #$41
L3FAB    bsr   L3FA2
         sta   ,u+
         decb
         bne   L3FAB
         bsr   L3F97
         stu   <u0068
         bsr   L3F97
         tfr   u,d
         stb   <u00A3
         bsr   L3F97
         stu   <u0097
         puls  u
         cmpu  #$0010
         bcs   L3FCB
         lbsr  L3CE2
L3FCB    bsr   L3F97
L3FCD    com   <u00BC
         stu   <u00F4
         lbra  L406A
L3FD4    tst   <u00A7
         bne   L3FA1
L3FD8    pshs  u,y,x,b,a
         ldu   <MEMPTR
         leau  >u0700,u
         stu   <u00D1
         ldx   <u0044
         leax  >-$0700,x
         beq   L4025
         ldd   <u00ED
         clra
         tstb
         bne   L3FF6
         ldb   #$0D
         stb   <u00D0
         ldb   #$01
L3FF6    tfr   x,y
         tfr   b,a
         ldx   <u00D1
         ldb   <u00D0
         cmpb  #$0C
         bne   L4007
         os9   I$Read
         bra   L400A
L4007    os9   I$Write
L400A    lbcs  L3DA6
         tfr   y,d
         cmpd  #$0200
         beq   L4020
         ldx   <MEMPTR
         leax  >$0700,x
         clr   d,x
         com   d,x
L4020    ldx   #$0700
         stx   <u0044
L4025    puls  pc,u,y,x,b,a

L4027    tst   <u00A7  number of characters in input buffer
         bne   L4058
L402B    pshs  x,b
         ldx   <u0044
         cmpx  #$0900
         bne   L4038
         bsr   L3FD8
         ldx   <u0044
L4038    pshs  a
         ldd   <MEMPTR
         leax  d,x
         puls  a
         tst   <u00EE
         beq   L404A
         ldb   <u00D0
         cmpb  #$0D
         bne   L404E
L404A    sta   ,x
         bra   L4050
L404E    lda   ,x
L4050    ldx   <u0044
         leax  $01,x
         stx   <u0044
         puls  pc,x,b
L4058    pshs  y,x,a
         lda   #$01
         leax  ,s
         ldy   #$0001
         os9   I$Write
         puls  pc,y,x,a
L4067    lbsr  L3F97
L406A    cmpu  <u00F4
         lbcs  L40D6
         stu   <u00F4
         lbsr  L1CCD
         bsr   L402B
         tsta
         beq   L40AC
         tfr   a,b
         bsr   L402B
         cmpb  #$02
         bne   L4097
         tst   <u0080
         beq   L4067
         anda  #$07
         sta   <u0036
         ldx   <u007E
         lda   $01,x
         anda  #$D8
         ora   <u0036
         sta   $01,x
         bra   L4067
L4097    sta   <u001C
         lbsr  L1CD6
         ldb   <u00FF
         subb  #$02
         tfr   x,u
L40A2    lbsr  L402B
         sta   ,u+
         decb
         bne   L40A2
         bra   L4067
L40AC    ldu   <u006E
         cmpu  #$FFFF
         lbne  L40D6
         ldu   <MEMPTR
         leax  >u0292,u
         leau  >u06C0,u
         bsr   L40E5
         ldu   <u0068
         lbsr  L1CCD
         clr   <u00ED
         lbsr  L3E56
         lbsr  L0027
         clr   <u00D6
         clr   <u00BC
         lbra  L0AA8
L40D6    lbsr  L3E56
         leau  >L417F,pcr
         bsr   L4147
         lbsr  L1CB5
         lbra  L0AA5
L40E5    clrb
L40E6    lda   b,x
         sta   b,u
         incb
         cmpa  #$20
         beq   L40F5
         cmpb  #$3F
         bne   L40E6
         clr   ,u
L40F5    clr   b,u
         rts

L40F8    lbsr  L0B14    Read the option section from path #0
         clr   $04,x   Turn off echo
         clr   <$10,x
         clr   <$11,x
         clr   $0C,x
         lbsr  L0B17
         lbra  L0AA8

L410B    lda   #$02
         os9   F$PErr
         bra   L4117

L4112    lbsr  L0B02
         bsr   L414A
L4117    leau  >L4178,pcr   String "OS9>"
         bsr   L4147
         clra
         ldx   <MEMPTR
         leax  >$0200,x
         tfr   x,u
         ldy   #$01FF
         os9   I$ReadLn
         cmpy  #$0001
         beq   L40F8
         leax  >L4158,pcr
         ldd   #$1100
         os9   F$Fork
         bcs   L410B
         os9   F$Wait
         tstb
         bne   L410B
         bra   L4117

L4147    lbra  L1CA9  output string pointed to in U

L414A    lbsr  L1D00
         ldx   <u0030
         leax  <$2F,x
         clra
         clrb
         os9   I$SetStt
         rts

L4158    fcs  "SHELL"
L415D    fcc  " Path name? "
         fcb  0
L416A    fcc  "Load :"
         fcb  0
L4171    fcc  "Save :"
         fcb  0
L4178    fcb  $0D
         fcc  "OS9> "
         fcb  0
L417F    fcb  $0D,$0A
         fcc  "Wrong Format !"
         fcb  0
L4190    fcb  $0D,$0A
         fcc  "Delete original? "
         fcb  0
L41A4    fcc "Error! #"
         fcb  0

L41AD    ldy   <u006C
         beq   L41BA
L41B2    ldd   ,--u
         std   ,--x
         leay  -$01,y
         bne   L41B2
L41BA    tst   <u007D
         beq   L41C2
         lda   ,-u
         sta   ,-x
L41C2    rts
L41C3    bsr   L41AD
         lbsr  L1C94
         lbra  L1C8E
L41CB    neg   <u0000
         neg   <u0000
         neg   <u0000
         neg   <u0000
         neg   <u0000
         neg   <u0000
         neg   <u0000
         neg   <u0000
         neg   <u0000
         neg   <u0000
         neg   <u0000
         neg   <u0000
         neg   <u0000
         bra   L41F3
L41E7    lbra  L4427
         lbra  L4781
L41ED    lbra  L4736
L41F0    lbra  L4705
L41F3    cmpa  #$53
         bne   L4261
         lbsr  L1CA3
         leau  >L4211,pcr
         lbsr  L4245
         ldu   <MEMPTR
         leay  >u01BF,u
         clrb
         lbsr  L4418
         lbsr  L1CB5
L420E    lbra  L1C8E
L4211    fcc "Max Col/Row - "
         fcb 0

L4220    ldy   <u0068
         bra   L4228
L4225    ldy   <u00CE
L4228    stx   ,y
         stu   $02,y
         ldu   #$0100
         lda   ,y
         cmpa  $02,y
         bne   L4238
         ldu   #$0001
L4238    stu   $06,y
L423A    ldd   ,y
         subd  $06,y
         std   $04,y
         lda   #$FF
         sta   $08,y
         rts
L4245    lbra  L1CA9
L4248    lbsr  L0AE1
L424B    lbra  L1CFA
L424E    ldx   <MEMPTR
         leau  <$20,x
         stu   <u00F4
         leau  <$60,x
         stu   <u00CE
         leau  >u02A0,u
         stu   <u0068
         rts
L4261    cmpa  #$52
         lbne  L442C
         bsr   L4248
         leau  >L48BA,pcr
         lbsr  L43F7
         bsr   L4225
         stu   <u006C
         clra
         clrb
         subd  <u006C
         std   <u00CA
         leau  >L48A2,pcr
         lbsr  L43F7
         bsr   L4220
         ldu   $02,y
         lbsr  L50C1
         bcc   L428D
         lbra  L1CBE
L428D    lbsr  L1CA3
         ldy   <u00CE
         lbsr  L440D
         leau  >L48C1,pcr
         bsr   L4245
         ldy   <u0068
         lbsr  L440D
         lbsr  L0B05
         lbsr  L3C73
         ldu   <u006E
         pshs  u
         inc   <u00BC
L42AE    lbsr  L43AC
         ldd   $06,y
         addd  <u00CA
         std   <u00CA
         tst   <u00C9
         lbne  L4393
         lbsr  L1CBB
         stb   <u008B
         stb   <u00AE
         beq   L42AE
         ldb   ,x
         lda   $01,x
         sta   <u001C
         leax  $02,x
         bita  #$10
         bne   L4333
         clr   <u008B
         cmpb  #$0A
         beq   L4333
         pshs  x,b,a
         ldb   -$02,x
         clra
         stu   <u006E
         leay  -$02,x
         leau  d,y
         stu   <u0051
         lda   -$01,x
         leax  $08,x
         lbsr  L441D
         bcc   L432B
         clr   <u00CC
         ldu   <u00F4
         stu   <u00FA
         clr   <u0079
         lbsr  L0AB1
         ldx   <u00DA
         lbsr  L0AAE
         clr   <u0078
         lbsr  L0AB7
         leau  >L48D1,pcr
         lbsr  L4245
         lbsr  L1C6D
         lbsr  L0AEA
         ldu   <u00F4
L4312    ldb   ,u
         coma
         lbsr  L0AED
L4318    lbsr  L0AE4
         cmpa  #$53
         beq   L4324
         cmpa  #$52
         bne   L4318
         clra
L4324    sta   ,u+
         cmpu  <u00FA
         bne   L4312
L432B    puls  x,b,a
         clr   <u00AE
         subb  #$08
         leax  $08,x
L4333    subb  #$02
         stb   <u0074
         clra
         sta   <u007D
         lsrb
         ror   <u007D
         std   <u006C
         ldu   <MEMPTR
         leau  >u0400,u
         stu   <u0089
         lda   <u001C
         sta   -u0001,u
         lbsr  L1CB8
L434E    bsr   L43A7
         tst   <u00C9
         lbne  L42AE
         ldd   $04,y
         addd  <u00CA
         tfr   d,u
         lbsr  L1CBB
         stx   <u007E
         stu   <u006E
         tst   <u008B
         bne   L4374
         lda   <u00AE
         pshs  a
         lbsr  L1C85
         puls  a
         sta   <u00AE
         bra   L434E
L4374    lda   <u001C
         clrb
         tst   <u0074
         beq   L4380
         lbsr  L1C9A
         bra   L434E
L4380    cmpx  #$0000
         beq   L434E
         anda  #$07
         sta   <u0036
         lda   $01,x
         anda  #$D8
         ora   <u0036
         sta   $01,x
         bra   L434E
L4393    puls  u
         clr   <u00BC
         lbsr  L1CCD
         lbsr  L1C94
         tst   <u00B6
         bne   L43A4
         lbra  L001E
L43A4    lbra  L420E
L43A7    ldy   <u0068
         bra   L43AF
L43AC    ldy   <u00CE
L43AF    clr   <u00C9
         ldd   $04,y
         addd  $06,y
         bcc   L43BB
         tst   $08,y
         beq   L43C2
L43BB    clr   $08,y
         cmpd  $02,y
         bls   L43CA
L43C2    com   <u00C9
         ldd   ,y
         subd  $06,y
         inc   $08,y
L43CA    std   $04,y
         tfr   d,u
         rts
L43CF    leau  >L4402,pcr
         ldx   <u00C1
L43D5    stx   <u00C1
         lbsr  L3C5E
         lbsr  L424E
         ldu   <u00C1
         lbsr  L3C5E
         lbsr  L0ADB
         ldu   <u006A
         ldx   <u00B1
         ldd   <u006A
         cmpa  <u00B1
         beq   L43F3
         cmpb  <u00B2
         bne   L43CF
L43F3    cmpu  <u00B1
         rts
L43F7    leax  >L48B0,pcr
L43FB    bsr   L43D5
         bhi   L4401
         exg   u,x
L4401    rts

L4402    fcc  " <INVALID."
         fcb 0

L440D    clrb
         bsr   L4418
         leau  >L48F3,pcr
         lbsr  L4245
         clrb
L4418    lbra  L0ADE
L441B    lda   ,x+
L441D    cmpa  #$40
         bcs   L4427
         cmpa  #$80
         bcs   L442B
         leax  $08,x
L4427    cmpx  <u0051
         bcs   L441B
L442B    rts
L442C    cmpa  #$44
         lbeq  L44BC
         cmpa  #$4D
         bne   L443F
         clr   <u00DE
         leau  >L4892,pcr
         lbra  L45ED
L443F    lbsr  L45DF
         clr   $0E,y
         lbsr  L4615
         inc   -$0D,y
         tfr   y,u
         lda   -$0D,y
         sta   $0E,y
         lbsr  L4615
         tsta
         bne   L446B
         dec   u000E,u
         dec   -u000D,u
L4459    ldu   <u008E
         lbsr  L1CBB
         beq   L4467
         leau  >L48F7,pcr
         lbra  L1CDC
L4467    inc   $0E,y
         bne   L4459
L446B    ldu   <u0073
         bsr   L4480
L446F    clra
L4470    sta   -$10,y
         bsr   L4487
         lda   -$10,y
         inca
         beq   L447D
         cmpa  -$0D,y
         bls   L4470
L447D    lbra  L44ED
L4480    pshs  y
         lbsr  L1CF1
         puls  pc,y
L4487    pshs  y
         lbsr  L4615
         lda   <$31,y
         sta   -$10,y
         lbsr  L453C
         ldu   <u006C
         stu   <u00DC
         ldx   ,u
         bra   L44A9
L449C    ldu   <u008E
         pshs  y
         ldy   <u006C
         ldx   ,y
         stu   ,y
         puls  y
L44A9    stx   <u008E
         lbsr  L452C
         bcs   L449C
         tst   <u00A1
         bne   L44B6
         ldx   <u00DA
L44B6    ldu   <u00DC
         stx   ,u
         puls  pc,y
L44BC    lbsr  L45D9
L44BF    clr   <$31,y
         ldu   <u0081
         stu   <u0084
L44C6    ldu   <u00B1
         tst   <u00A1
         bne   L44D8
         lbsr  L1CBB
         beq   L44D8
         pshs  y
         lbsr  L50BE
         puls  y
L44D8    bsr   L4501
         lda   <$31,y
         inca
         beq   L44E7
         sta   <$31,y
         cmpa  -$0D,y
         bls   L44C6
L44E7    ldx   <u0084
         stx   <u0081
         com   <u00E1
L44ED    lbsr  L4543
L44F0    clr   <u00E1
         tst   <u00DF
         bne   L4542
         ldu   <u006E
         lbsr  L1CCD
         lbsr  L0027
         lbra  L0AA8
L4501    pshs  y
         lbsr  L4615
         ldu   <u00B1
         stu   <u0070
         bsr   L453C
         tst   <u00A1
         beq   L4516
         ldu   <u006C
         ldx   ,u
         stx   <u00DC
L4516    bsr   L452C
         bcc   L4524
         ldu   <u006C
         ldx   ,u
         ldu   <u00AF
         stx   ,u
         bra   L4516
L4524    ldx   <u00DC
         ldu   <u00AF
         stx   ,u
         puls  pc,y
L452C    ldd   <u006C
         std   <u00AF
         clra
         lda   -$10,y
         inca
         beq   L4542
         cmpa  -$0D,y
         bhi   L4542
         sta   -$10,y
L453C    ldu   <u0070
         lbsr  L1CBB
         coma
L4542    rts
L4543    lbsr  L4615
         ldx   <u0017
         stx   <u0051
L454A    lbsr  L50D6
         bcs   L4565
         tst   <u00B3
         bne   L4542
         ldx   <MEMPTR
         leax  >$0580,x
L4559    ldb   ,x+
         beq   L4542
         lda   ,x+
         bsr   L45A6
         sta   -$01,x
         bra   L4559
L4565    lda   $01,x
         bita  #$10
         bne   L454A
         cmpb  #$0A
         bls   L454A
         leax  $09,x
         ldb   ,x
         sta   ,x
         pshs  x,b
L4577    lbsr  L4427
         bcc   L459C
         ldu   ,x++
         stu   <u008E
         lda   $0E,y
         clrb
         bsr   L45A6
         bcs   L458F
         sta   $0E,y
         ldu   <u008E
         stu   -$02,x
         bra   L4577
L458F    lda   -$03,x
         anda  #$3F
         sta   -$03,x
         ldd   #$343F
         std   -$02,x
         bra   L4577
L459C    puls  x,b
         lda   ,x
         stb   ,x
         sta   -$08,x
         bra   L454A
L45A6    cmpa  <u0089
         bcs   L45D7
         bne   L45BE
         comb
         tst   <u00A1
         beq   L45B9
         tst   <u00E1
         beq   L45D0
         lda   <u008A
         bra   L45D7
L45B9    tst   <u00E1
         beq   L45D0
         rts
L45BE    cmpa  <u008A
         bhi   L45D7
         bne   L45D0
         tst   <u00A1
         beq   L45D0
         tst   <u00E1
         bne   L45D0
         lda   <u0089
         bra   L45D7
L45D0    inca
         tst   <u00E1
         beq   L45D7
         suba  #$02
L45D7    clrb
         rts
L45D9    leau  >L4874,pcr
         bra   L45E3
L45DF    leau  >L4883,pcr
L45E3    stu   <u00AF
         ldx   <MEMPTR
         leay  >$0180,x
         clr   <u00B3
L45ED    lbra  L1CDF
         leay  $01,y
         com   <u00B3
         lda   <-$12,y
         cmpa  <$3F,y
         bhi   L4630
         lda   <-$12,y
         sta   <u0089
         ldu   <u00BF
         stu   <u0073
         ldu   <u00DA
         stu   <u00DC
         clr   <u00A1
         lda   #$FF
         sta   <u008A
         bsr   L4622
         ldu   <u006E
         stu   <u00B1
L4615    leay  $01,y
         exg   d,y
         cmpb  #$81
         exg   d,y
         beq   L4621
         leay  -$02,y
L4621    rts
L4622    lbsr  L1CA3
         ldu   <u00AF
         bsr   L462D
         leau  >L48EB,pcr
L462D    lbra  L4245
L4630    lbra  L420E
         lbsr  L4248
         leax  >L48C5,pcr
         leau  >L4892,pcr
         lbsr  L43D5
         beq   L4630
         bcs   L4647
         inc   <u00E1
L4647    clr   <u00B3
         ldu   <MEMPTR
         leay  >u0180,u
         cmpa  <u00B1
         bne   L4659
         leay  $01,y
         lda   <u00B2
         com   <u00B3
L4659    lda   <$31,y
         ldb   <-$16,y
         tst   <u00E1
         bne   L4665
         exg   a,b
L4665    std   <u0089
         stb   <u00A1
         ldu   <u00BF
         stu   <u0073
         lda   <$31,y
         cmpa  <-$16,y
         bhi   L4678
         lda   <-$16,y
L4678    sta   -$0D,y
         ldu   <u0073
         lbsr  L4480
         lbsr  L4615
         tst   <u00E1
         lbne  L44BF
         ldu   <u006A
         stu   <u00B1
         lbra  L446F
         inc   <u00DE
         leau  >L48B3,pcr
         stu   <u00AF
         leax  >L48AA,pcr
         lbsr  L43FB
         lbeq  L420E
         pshs  u,x
         lbsr  L4622
         puls  u,x
         pshs  u,x
         lbsr  L4225
         puls  u,x
         lbsr  L4220
         lbsr  L43AC
L46B6    ldy   <u0068
         lbsr  L423A
         stu   $02,y
         lbsr  L43AC
         clr   <u00DF
         tst   <u00C9
         lbne  L44F0
         stu   <u00C1
         inc   <u00DF
         bsr   L4705
         beq   L46FF
         std   <u00F6
         lbsr  L50D9
L46D6    lbsr  L43A7
         tst   <u00C9
         bne   L46FF
         lda   <u00F6
         sta   <u00FC
         ldb   <u00F7
         bsr   L4736
         beq   L46D6
         tfr   cc,a
         eora  <u00DE
         tfr   a,cc
         bcc   L46D6
         ldx   <MEMPTR
         ldx   <$64,x
         ldu   $04,y
         stx   <u00B1
         stu   <u006A
         lda   <u006A
         lbsr  L4647
L46FF    ldu   <u00C1
         bra   L46B6
L4703    ldu   $01,x
L4705    lbsr  L1CBB
         beq   L4729
         ldd   ,x++
         andb  #$10
         suba  #$02
         beq   L4729
         sta   <u0099
         tstb
         beq   L472A
         lda   #$20
L4719    cmpa  ,x
         bne   L4727
         leax  $01,x
         dec   <u0099
         bne   L4719
         leax  -$01,x
         inc   <u0099
L4727    lda   <u0099
L4729    rts
L472A    lda   -$01,x
         bita  #$08
         beq   L4727
         tst   ,x
         bmi   L4703
         clrb
         rts
L4736    pshs  b
         bsr   L4705
         beq   L476A
         cmpb  ,s
         bne   L476A
         ldu   <u00FA
         tstb
         bne   L474E
         lda   #$06
         sta   <u0025
         lbsr  L002A
         bra   L476A
L474E    lda   ,x+
         bsr   L476C
         pshs  a
         lda   ,u+
         bsr   L476C
         cmpa  ,s+
         bne   L476A
         dec   <u0099
         bne   L4764
         dec   <u00FC
         bra   L476A
L4764    coma
         dec   <u00FC
         bne   L474E
         incb
L476A    puls  pc,b
L476C    cmpa  #$20
         beq   L4780
         cmpa  #$40
         bcs   L477E
         sta   <u0036
         anda  #$DF
         cmpa  #$5A
         bls   L4780
         lda   <u0036
L477E    ora   #$80
L4780    rts
L4781    leau  >L4867,pcr
         lbsr  L3C5E
         clr   <u009A
         lbsr  L3C5B
         subb  #$0C
         beq   L47A5
         ldd   <u006E
         std   <u00F1
         cmpa  <u00BF
         bcs   L47B0
         bne   L479F
         cmpb  <u00C0
         bls   L47B0
L479F    inc   <u00E1
         clra
         clrb
         bra   L47C6
L47A5    lbra  L420E
L47A8    ldd   <u00F1
         bra   L47C6
L47AC    cmpa  #$1B
         beq   L47A8
L47B0    ldd   <u006E
         tfr   d,x
         cmpb  <u00C0
         bcs   L47C5
         ldb   #$FF
         cmpa  <u00BF
         bne   L47C4
         lda   #$FF
         tst   <u00E1
         bne   L47A8
L47C4    inca
L47C5    incb
L47C6    std   <u006E
         cmpd  <u00F1
         bcs   L47D3
         beq   L47A5
         cmpx  <u00F1
         bcs   L47A8
L47D3    ldu   <u006E
         lbsr  L1CCD
         lbsr  L1CBB
         beq   L47B0
         ldd   ,x++
         bitb  #$10
         beq   L47B0
         suba  #$02
         bls   L47B0
         tfr   a,b
L47E9    ldu   <u00E9
         leau  >u000C,u
         lda   ,u
         suba  #$40
         bne   L47F7
         leau  u0001,u
L47F7    sta   <u00B3
         bsr   L4849
         bne   L4808
         pshs  u,x,b
L47FF    bsr   L4849
         bne   L4806
         decb
         bne   L47FF
L4806    puls  u,x,b
L4808    decb
         bne   L47E9
         bra   L47B0
L480D    leas  $07,s
         clr   <u00CC
         lda   <MEMPTR
         adda  #$04
         sta   <u008C
         lbsr  L1CCA
         lda   <MEMPTR
         adda  #$02
         sta   <u008C
         lbsr  L1CA3
         leau  >L4892,pcr
         lbsr  L4245
         ldd   #$3F20
         lbsr  L1C91
         lbsr  L1D00
         lbsr  L0AF9
         anda  #$5F
         cmpa  #$59
         lbne  L47AC
         ldu   <u006E
         ldd   <u006E
         ldx   <u00F1
         stx   <u006E
         lbra  L1CFD
L4849    lda   ,u+
         cmpa  #$0D
         beq   L480D
         cmpa  #$3F
         bne   L4855
         lda   ,x
L4855    bsr   L4860
         pshs  a
         lda   ,x+
         bsr   L4860
         cmpa  ,s+
L485F    rts
L4860    tst   <u00B3
         beq   L485F
         lbra  L0B20
L4867    fcc "Search for? "
         fcb 0
L4874    fcc  "Delete"
         fcb 0
L487B    fcc  "C)oR)k?"
         fcb  $96
        
L4883    fcc "Insert"
         fcb 0
L488A    fcc  "C)oR)k?"
         fcb   $98
L4892    fcc  "Move"
         fcb 0
         fcb  $41,$2A,$0C,$44,$2A,$0A,$4D,$29,$AE,$3F,$A0

L48A2    fcc  "  Dest."
         fcb  0
L48AA    fcc  " Range"
L48B0    fcc  "? "
         fcb 0
L48B3    fcc  "Sort :"
         fcb 0
L48BA    fcc  "Source"
         fcb 0
L48C1    fcc " > "
         fcb 0

L48C5    fcc  " From...To "
         fcb 0
L48D1    fcc  "  < R(elative) or S(ame)?"
         fcb 0
L48EB    fcc  " Working"
L48F3   fcc  "..."
         fcb 0
L48F7    fcb  $0D,$0A
         fcc  "NO ROOM !"
         fcb  $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
L4910    fcb  $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
         fcb  $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
         fcb  $00,$00,$00,$00,$00,$20,$15

L4937    lbra  L4BF3
L493A    lbra  L504E
L493D    lbra  L5006
         lbra  L49B9
L4943    lbra  L5047
L4946    lbra  L495D
         lbra  L5008
         cmpa  #$50
         bne   L4957
         leau  >L4EBE,pcr
L4954    lbra  L1CDF
L4957    leau  >L4E9B,pcr
         bra   L4954
L495D    tst   <u00E0
         beq   L496E
         cmpa  #$1B
         bne   L496E
L4965    lbsr  L0AF9
         cmpa  #$1B
         bne   L496F
         leas  $02,s
L496E    rts
L496F    cmpa  #$03
         beq   L4977
         cmpa  #$0D
         bne   L4965
L4977    lbra  L4B5B
L497A    lbsr  L0B08
         bsr   L49F0
         leau  >L4E4D,pcr
         bsr   L49F0
         lbsr  L1D00
         lbsr  L0AF6
         cmpa  #$0D
         beq   L49A6
         lbsr  L0ADB
L4992    ldb   <u005B
         incb
         clr   b,y
         lbsr  L1CA3
         lda   #$2D
         sta   $0C,y
         leau  $07,y
         lbsr  L4B99
         lbra  L0B05
L49A6    lbsr  L0AE4
         clra
         clrb
         std   <u00B1
         ldd   <u00BF
         std   <u006A
         leau  >L4E57,pcr
         bsr   L49F0
         bra   L4992
L49B9    leau  >-$0187,y
         lda   ,u
         sta   <u0069
         leau  u0003,u
         ldd   ,u++
         sta   <u003B
         stb   <u003F
         ldd   ,u
         std   <u0062
         lbsr  L0AE1
         lbsr  L4F1E
         tst   <u0012
         bne   L4A25
         leax  >$0400,y
         tst   ,x
         beq   L4A07
         leau  <$12,y
         lbsr  L3C8E
         lbsr  L3C8B
         sta   <u0012
         clr   <u00EE
         bsr   L49F9
         bra   L4A12
L49F0    lbra  L3C5E
L49F3    ldx   #$0200
         lbra  L0AAE
L49F9    lbsr  L4F19
         lda   <u000E
         suba  #$34
         leau  >$0400,y
         lbra  L3C88
L4A07    bsr   L49F3
         leau  >L4E66,pcr
         lbsr  L3C82
         sta   <u0012
L4A12    clr   <u00EE
         ldb   <u00E1
         decb
         stb   <u0013
         leax  <$12,y
         leau  >$0400,y
         lbsr  L3C8E
         bra   L4A25
L4A25    lda   #$0D
         sta   <u00D0
         sta   <u009A
         bsr   L49F3
         leau  >L4E41,pcr
         lbsr  L497A
         lda   <u0013
         sta   <u00E2
         tst   <u0062
         bne   L4A8A
         lbsr  L0B08
         leau  >L4E5E,pcr
         bsr   L49F0
         clr   <u009A
         lbsr  L3C5B
         clr   <u00F1
         lda   #$23
         tst   <u003B
         bne   L4A54
         adda  #$0A
L4A54    nega
         adda  <u003F
         bcs   L4A5B
         lda   <u003F
L4A5B    pshs  a
         clr   b,y
         subb  #$07
         stb   <u0025
         leax  >$0180,y
         leay  $07,y
         clr   a,y
         clrb
L4A6C    ldu   b,y
         stu   b,x
         addb  #$02
         cmpb  <u0025
         bls   L4A6C
         cmpa  <u0025
         bhi   L4A7C
         sta   <u0025
L4A7C    puls  a
         cmpa  <u003F
         beq   L4A88
         adda  #$02
         suba  <u0025
         sta   <u00F1
L4A88    clr   <u00F5
L4A8A    lbsr  L4B96
         ldb   <u0012
         stb   <u00EE
         lda   #$A8
         lbsr  L4B48
         inc   <u00E0
         lbsr  L4BDC
         ldd   <u00B1
         ldx   <u006A
         lbsr  L001B
         std   <u006A
         ldx   <u000D
         ldu   <u0097
         clra
         clrb
         std   <u0097
         pshs  u,x
         ldx   <MEMPTR
         leax  >$0500,x
         leay  <$10,x
         ldd   #$FB28
         lbsr  L4B4F
         clrb
         std   $06,y
         ldu   <u00A2
         sts   <u00CE
         ldd   u0008,u
         std   $08,y
L4AC9    ldd   <u006A
         std   ,y
         ldd   <u00F2
         subd  <u006A
         addb  #$05
         stb   <u000D
         sta   <u0036
         lda   <u006A
         ldb   <u003F
         tst   <u003B
         bne   L4AE1
         subb  #$04
L4AE1    stb   <u0094
         clr   -$02,y
L4AE5    lbsr  L1CE5
         bcs   L4AF9
         inc   -$02,y
         inca
         ldb   <u0036
         subb  #$01
         stb   <u0036
         bcc   L4AE5
         ldb   <u0094
         bra   L4AFA
L4AF9    clrb
L4AFA    subb  <u003F
         negb
         stb   <u000E
         stb   $0F,y
         ldb   -$02,y
         bne   L4B08
         incb
         stb   -$02,y
L4B08    clra
         addb  <u006A
         cmpb  <u00F2
         bhi   L4B11
         tfr   b,a
L4B11    ldx   <u00F2
         ldb   <u006B
         pshs  y,x,b,a
         clr   <u00AC
         tst   <u0062
         bne   L4B24
         lbsr  L4C1D
         inc   <u00F4
         bsr   L4B9C
L4B24    lda   <u003B
         sta   <u009B
         lbsr  L1CC1
         puls  y,x,b,a
         tsta
         beq   L4B5B
         std   <u006A
         stx   <u00F2
         lda   <u0062
         beq   L4AC9
         lbsr  L4BDA
         ldb   <u003F
         lda   #$2D
         lbsr  L4B90
         lbsr  L4BDC
         lbra  L4AC9
L4B48    tst   <u00E2
         bne   L4B5A
         lbra  L0B1D
L4B4F    leau  d,x
         lda   #$20
L4B53    ldb   ,x+
         stb   ,u+
         deca
         bne   L4B53
L4B5A    rts
L4B5B    lds   <u00CE
         ldx   <MEMPTR
         leax  <$28,x
         ldd   #$04D8
         bsr   L4B4F
         puls  u,x
         stx   <u000D
         stu   <u0097
         dec   <u00AC
         bsr   L4BDC
         clr   <u00E0
         lda   #$AC
         bsr   L4B48
         clr   <u00EE
         ldy   <u00E9
         tst   >-$01D4,y
         lbpl  L0AA8
         tst   <u0013
         lbne  L4F61
         lbra  L4D33
L4B8E    lda   #$20
L4B90    lbsr  L3C67
         decb
         bne   L4B90
L4B96    lbra  L3C73
L4B99    lbra  L1CA9
L4B9C    clr   <u00E0
         leau  >L4FFF,pcr
         bsr   L4B99
         inc   <u00E0
         ldu   <MEMPTR
         leau  >u0400,u
         bsr   L4B99
         ldb   <u00F1
         beq   L4BDA
         bsr   L4B8E
L4BB4    ldu   <MEMPTR
         leau  >u0562,u
         bsr   L4B99
         tst   <u0091
         bne   L4BED
         leau  >L4FEE,pcr
         tst   <u003B
         beq   L4BD0
         ldb   #$04
         bsr   L4B8E
         leau  >L4FF8,pcr
L4BD0    bsr   L4B99
         inc   <u00F5
         ldb   <u00F5
         clra
         lbsr  L5006
L4BDA    bsr   L4BDC
L4BDC    clr   <u00E0
         bsr   L4BEE
         tst   <u00E2
         bne   L4BE8
         lda   #$0A
         bsr   L4BF0
L4BE8    inc   <u00E0
         lbsr  L0AD8
L4BED    rts
L4BEE    lda   #$0D
L4BF0    lbra  L4CC8
L4BF3    tst   <u0062
         bne   L4C12
         ldb   <u00F4
         subb  #$01
         bcs   L4C03
         subb  <u0069
         stb   <u00F4
         bcc   L4C12
L4C03    bsr   L4B9C
         bsr   L4C1D
         tst   <u003B
         bne   L4C28
         pshs  y
         lbsr  L1CE8
         puls  y
L4C12    ldb   <u0069
         stb   <u009D
L4C16    bsr   L4BDC
         dec   <u009D
         bpl   L4C16
         rts
L4C1D    lda   <u0063
         suba  #$06
         tst   <u003B
         bne   L4C26
         deca
L4C26    sta   <u00F4
L4C28    rts
L4C29    clr   <u00B3
         inc   <u00A7
         lbsr  L4B96
         leay  >-$0090,y
         leau  >L4E80,pcr
         stu   <u00DC
         leau  >L4EAD,pcr
         lbra  L4954
         tst   <u00EF
         beq   L4C5A
         lbsr  L4E3A
         cmpa  #$2F
         bne   L4C5A
         lbsr  L4E0F
         lbsr  L4E2E
         anda  #$5F
         cmpa  #$52
         beq   L4C6A
         bra   L4C62
L4C5A    sta   <u00D7
         lda   <u00EC
         cmpa  #$F0
         beq   L4C6A
L4C62    leay  $01,y
         leau  >L4E7B,pcr
         stu   <u00DC
L4C6A    sty   <u00EB
         rts
         leau  >L4E6D,pcr
         lbsr  L3C70
         bsr   L4C29
         leau  >L4E47,pcr
         lbsr  L497A
         clr   <u00EF
         ldx   <u00B1
         ldd   <u006A
         inc   <u00E0
         lbsr  L001B
         std   <u00F6
         std   <u00F4
         ldy   #$53E8
         lda   #$03
         sta   <u0022
         clr   <u00E0
         clr   <u00C7
         inc   <u0091
         clr   <u00A7
         leau  >L4E85,pcr
         lbsr  L4B99
         lbsr  L4BB4
         bsr   L4CC5
         ldu   <u00DC
         lbsr  L4B99
         bsr   L4CC5
L4CB0    ldu   <u00F4
L4CB2    lbsr  L1CBB
         beq   L4CBD
         lda   ,x
         suba  #$02
         bne   L4CCB
L4CBD    lda   #$3E
         bsr   L4CC8
         bsr   L4CC5
         bra   L4CF9
L4CC5    lbra  L4BEE
L4CC8    lbra  L0AFC
L4CCB    sta   <u0036
         leax  $01,x
         lda   ,x
         bita  #$08
         beq   L4CDD
         ldu   $02,x
         tst   $01,x
         bmi   L4CB2
         bra   L4CBD
L4CDD    ldb   #$14
         bita  #$10
         beq   L4CEF
         lda   $01,x
         bsr   L4D40
         bne   L4CED
         lda   #$27
         bsr   L4CC8
L4CED    ldb   <u0036
L4CEF    stb   <u0020
         ldy   <u00A2
         lbsr  L1CA6
         bsr   L4CC5
L4CF9    ldu   <u00EB
         clr   <u00B3
L4CFD    inc   u0004,u
         lda   u0004,u
         beq   L4D07
         cmpa  u0002,u
         bls   L4CB0
L4D07    lda   u0006,u
         sta   u0004,u
         tst   <u00B3
         bne   L4D28
         inc   <u00B3
         bsr   L4D1B
         lda   #$40
         bsr   L4CC8
         bsr   L4CC5
         bra   L4CFD
L4D1B    leau  u0001,u
         exg   d,u
         cmpb  #$F1
         exg   d,u
         beq   L4D27
         leau  -u0002,u
L4D27    rts
L4D28    clr   <u00E0
         clr   <u0091
L4D2C    lbra  L3C6A
         clr   >$0400,y
L4D33    clra
         sta   <u00D0
         sta   <u00EF
         ldb   <u0012
         std   <u00ED
         sta   <u0012
         bra   L4D2C
L4D40    cmpa  #$27
         beq   L4D66
         cmpa  #$2A
         beq   L4D66
         cmpa  #$3E
         beq   L4D66
         cmpa  #$40
         beq   L4D66
L4D50    cmpa  #$39
         bhi   L4D66
         cmpa  #$30
         bcc   L4D64
         cmpa  #$2E
         beq   L4D64
         cmpa  #$2D
         beq   L4D64
         cmpa  #$2B
         bne   L4D66
L4D64    orcc  #$04
L4D66    rts
         leau  >L4E74,pcr
         lbsr  L3C79
         clr   <u00D7
         com   <u00E2
         dec   <u0091
         lbsr  L4C29
         ldu   <u006E
         stu   <u00F4
         stu   <u00F6
         lbsr  L4E3A
         sta   <u00D7
         clr   <u00CD
         cmpa  #$2F
         bne   L4D8D
         clr   <u00D7
         lbsr  L4E2E
L4D8D    lbsr  L4E3A
         cmpa  #$40
         beq   L4DE3
         cmpa  #$0D
         beq   L4DDD
         cmpa  #$3E
         bne   L4DA3
         andcc #$FB
         pshs  cc
         clrb
         bra   L4DBE
L4DA3    bsr   L4D50
         pshs  cc
         cmpa  #$27
         bne   L4DB5
         bsr   L4E0F
         cmpa  #$0D
         bne   L4DB5
         sta   <u00D7
         lda   #$20
L4DB5    ldy   <u00E9
         clrb
L4DB9    sta   b,y
         incb
         bpl   L4DC2
L4DBE    bsr   L4E2E
         bra   L4DC8
L4DC2    bsr   L4E0F
         cmpa  #$0D
         bne   L4DB9
L4DC8    decb
         stb   <u005B
         ldu   <u00F4
         lbsr  L1CCD
         puls  cc
         beq   L4DDA
         clra
         lbsr  L0B0B
         bra   L4DDD
L4DDA    lbsr  L0B0E
L4DDD    ldu   <u00EB
         inc   u0004,u
         bra   L4D8D
L4DE3    clrb
L4DE4    bsr   L4E0F
         lbsr  L4D50
         bne   L4DF8
         suba  #$30
         bcs   L4DF8
         pshs  a
         lda   #$0A
         mul
         addb  ,s+
         bra   L4DE4
L4DF8    cmpa  #$0D
         beq   L4DFE
         bsr   L4E2E
L4DFE    incb
         ldu   <u00EB
         lda   u0006,u
         sta   u0004,u
         lbsr  L4D1B
         addb  u0004,u
         stb   u0004,u
         lbra  L4D8D
L4E0F    lda   <u00D7
         bne   L4E19
         lbsr  L3C7C
         tsta
         bmi   L4E1C
L4E19    clr   <u00D7
         rts
L4E1C    ldu   <u00F6
         clr   <u004B
         stu   <u006E
         tst   <u00B6
         bne   L4E29
         lbsr  L0027
L4E29    inc   <u00ED
         lbra  L4D2C
L4E2E    pshs  a
L4E30    bsr   L4E0F
         cmpa  #$0D
         bne   L4E30
         puls  pc,a
L4E38    bsr   L4E2E
L4E3A    bsr   L4E0F
         cmpa  #$2A
         beq   L4E38
         rts

L4E41    fcc  "Print"
         fcb 0
L4E47    fcc  "Block"
         fcb 0
L4E4D    fcc ": Range? "
         fcb 0
L4E57    fcc "Entire"
         fcb 0
L4E5E    fcc  "Title? "
         fcb 0
L4E66    fcc  "Output"
         fcb 0
L4E6D    fcc  "Save :"
         fcb 0
L4E74    fcc  "Load :"
         fcb 0
L4E7B    fcc  "/Col"
         fcb 0
L4E80    fcc  "/Row"
         fcb 0
L4E85    fcc  "*DYNACALC Data File"
         fcb  $0D,'*,0

L4E9B    fcc  "Data file"
         fcb  0
         fcb  'L,$30,$E2,'S,$2F,$E9,'?,$86
L4EAD    fcc   "Order"
         fcb 0
         fcb  'C,$2F,$DD,$44,$2F,$BC,$52,$2F,$E5,'?,$A2

L4EBE    fcc   "Printer"
         fcb 0
         fcb   $42,$32,$5E
         fcb   $43,$30,$AA
         fcb   $4C,$32,$CB,$50,$32,$55,$53,$33,$01,$57,$32,$C2,$3F,$94

         ldx   #$00FE
         leau  >L4FA4,pcr
         bra   L4EEA
         ldx   #$00FC
         leau  >L4F97,pcr
L4EEA    pshs  u,x
         lbsr  L1CA3
         ldx   <MEMPTR
         puls  u,b,a
         leax  d,x
         lbsr  L4B99
         clrb
         leau  >L4FB4,pcr
         lda   ,x
         bne   L4F04
         comb
         leau  u0003,u
L4F04    stb   ,x
         lbra  L1CDC
L4F09    ldb   #$3D
         lbsr  L1C91
         lda   #$59
         tst   ,x+
         beq   L4F16
         lda   #$4E
L4F16    lbsr  L4CC8
L4F19    lda   #$20
         lbra  L4CC8
L4F1E    lda   #$42
         leax  >-$0184,y
         bsr   L4F09
         lda   #$57
         bsr   L4F37
         lda   #$50
         bsr   L4F09
         lda   #$4C
         bsr   L4F37
         leax  -$07,x
         ldd   #$533D
L4F37    sta   <u0075
         lbsr  L1C91
         lda   ,x+
         sta   <u0071
         lbsr  L0AC3
         clr   <u0075
         bra   L4F19
         ldx   #$FE7D
         leau  >L4FBB,pcr
         bra   L4F57
         ldx   #$FE7F
         leau  >L4FCE,pcr
L4F57    bsr   L4F64
         cmpb  #$0A
         bcs   L4F61
L4F5D    ldx   <u008E
         stb   ,x
L4F61    lbra  L1C8E
L4F64    pshs  u,x
         lbsr  L0AE1
         lbsr  L49F3
         ldy   <u00E9
         puls  u,b,a
         leax  d,y
         stx   <u008E
         lbsr  L49F0
         ldx   <u008E
         lda   ,x
         inca
         lbsr  L1CE2
         subb  #$01
         bcc   L4F85
         incb
L4F85    rts
         ldx   #$FE79
         leau  >L4FDF,pcr
         bsr   L4F64
         cmpb  #$08
         bcs   L4F5D
         ldb   #$07
         bra   L4F5D
L4F97    fcc   "Borders now "
         fcb   0
L4FA4    fcc   "Pagination now "
         fcb   0
L4FB4    fcc "On"
         fcb   0
L4FB7    fcc  "Off"
         fcb   0
L4FBB    fcc  "Printer width is: "
         fcb   0
L4FCE    fcc  "Lines per page: "
         fcb   0
L4FDF    fcc  "Line spacing: "
         fcb   0
L4FEE    fcc  "  DYNACALC"
L4FF8    fcc  "  PAGE"
         fcb 0

L4FFF    fcb $0D,$0C,$0A,$0A,$0A,$0A,0

L5006    clr   <u0025
L5008    clr   <u006D
L500A    leax  >L503E,pcr
L500E    bsr   L5021
L5010    tst   ,x
         bpl   L500E
         tfr   b,a
         pshs  cc
L5018    inc   <u006D
L501A    adda  #$30
         lbsr  L3C67
L501F    puls  pc,a
L5021    clr   <u006C
L5023    inc   <u006C
         subd  ,x
         bcc   L5023
         addd  ,x++
         pshs  a
         lda   <u006C
         deca
         bne   L5018
         tst   <u006D
         bne   L5018
         tst   <u0025
         bne   L501F
         lda   #$F0
         bra   L501A

L503E    fdb   10000
         fdb   1000
         fdb   100
         fdb   10
         fcb   $FF

L5047    lda #$1B
L5049    sta   <u0019
         lbra  L4F61

* Create temporary file name
L504E    leay  <$11,y
         leax  >L5081,pcr    String "dyna."
L5055    sta   <u006D
         sta   ,y+
         lda   ,x+
         bne   L5055
         ldu   #$0700
         stu   <u0044
         pshs  y
         os9   F$ID
         tfr   y,d
         puls  y
         bsr   L500A
         stu   <u0044
         ldd   <MEMPTR
         leau  d,u
         ldb   #$05
L5075    lda   ,u+
         sta   ,y+
L5079    decb
         bne   L5075
         clr   <u00E1
         lbra  L3C55
L5081    fcc "dyna."
L5086    fcb $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
         fcb $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
         fcb $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
         
L50B5    lbra  L50DC
L50B8    rts

         fcb $ff,$ff
L50BB    fcb   $16,$01,$37
L50BE    fcb   $16,$00,$70
L50C1    lbra  L516B
L50C4    lbra  L50EE
         lbra  L0AA5
         rts

         fdb   $FFFF
L50CD    rts
         fdb   $FFFF
L50D0    rts
         fdb   $FFFF
L50D3    rts
         fdb   $FFFF
L50D6    fcb  $16,$01,$21
L50D9    fcb  $9F,$FA
L50DB    rts

L50DC    fcb $DC
         fcb   $41

         subd  <u00C5
         addd  #$0001
         pshs  b,a
         ldd   <u0081
         subd  <u0017
         addd  ,s++
         lbra  L493D
L50EE    clra
         ldx   <u007E
         beq   L50FB
         stx   <u0084
         subb  ,x
         beq   L5120
         sbca  #$00
L50FB    ldu   <u006E
         bsr   L516B
         bcc   L5108
         lda   <u00BC
         bne   L5117
         lbra  L1CBE
L5108    ldx   <u0081
         stx   <u0084
         leay  d,x
         sty   <u0081
         bsr   L516B
         bcc   L511A
         stx   <u0081
L5117    lbra  L1CC7
L511A    ldx   <u007E
         beq   L5120
         bsr   L5131
L5120    ldu   <u006E
         lbsr  L1CF1
         lbsr  L1CBB
         ldu   <u006C
         ldx   <u0084
         stx   <u007E
         stx   ,u
         rts
L5131    ldb   ,x
         tfr   x,u
         abx
         stx   <u006C
         ldd   <u0084
         subd  <u006C
         clr   <u007D
         lsra
         rorb
         ror   <u007D
         ldx   <u006C
         std   <u006C
         bsr   L514E
         lbsr  L1CB8
         stu   <u0084
         rts
L514E    pshs  u,x
         stx   <u00F8
         tfr   u,d
         subd  <u00F8
         std   <u00F2
         ldx   <u00C5
L515A    ldd   ,x++
         cmpd  <u00F8
         bcs   L5165
         addd  <u00F2
         std   -$02,x
L5165    cmpx  <u001E
         bcs   L515A
         puls  pc,u,x
L516B    pshs  u,x,b,a
         ldx   <u0023
         cmpx  <u0081
         bcc   L5175
         ldx   <u0081
L5175    tfr   u,d
         cmpa  <u00BF
         bcc   L517D
         lda   <u00BF
L517D    cmpb  <u00C0
         bcc   L5183
         ldb   <u00C0
L5183    tfr   d,u
L5185    lbsr  L1CEE
         bcs   L5195
         stx   <u006C
         cmpd  <u006C
         bcc   L5195
         bsr   L5197
         bcc   L5185
L5195    puls  pc,u,x,b,a

* Request more memory
L5197    pshs  u,y,x,b,a
         ldd   #$0F00
         std   <u0046
L519E    ldd   <PARAMS
         subd  <MEMPTR
         tst   <u0043
         beq   L51A9
         addd  #$5200
L51A9    addd  #$0001
         std   <u006C
         addd  <u0046
         os9   F$Mem
         bcc   L51C0
         lda   <u0046
         suba  #$02
         sta   <u0046
         bcc   L519E
         coma
         puls  pc,u,y,x,b,a

L51C0    subd  <u006C
         std   <u0046
         lsra
         rorb
         addd  <u0023
         std   <u0023
         ldd   <u0046
         addd  <u001E
         std   <u001E
         ldd   <PARAMS
         subd  <u00C5
         addd  #$0002
         clr   <u007D
         lsra
         rorb
         lsr   <u007D
         std   <u006C
         ldd   <u0046
         addd  <u00C5
         std   <u00C5
         ldu   <PARAMS
         leax  -$01,y
         stx   <PARAMS
         tfr   y,x
         leau  u0001,u
         lbsr  L3C7F
         clra
         puls  pc,u,y,x,b,a

         ldd   <u0017
         std   <u0081
         rts

         ldx   <u0051
         ldb   ,x
         clra
         leau  d,x
         stu   <u0051
         cmpx  <u0081
         rts

         fcb   $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
         emod
eom      equ   *
